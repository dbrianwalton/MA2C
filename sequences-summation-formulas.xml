<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2015  D. Brian Walton          -->
<!-- See the file COPYING for copying conditions. -->
   
<section xml:id="summation-formulas">
    <title>Summation Formulas</title>

    <subsection>
        <title>Overview</title>
        
        <p>
        When an increment sequence is given explicitly, we often seek to find
        an explicit formula for the accumulation sequence. This section introduces
        basic properties of summation as well as
        some basic formulas for a few elementary increment sequences. 
        Combining the basic formulas with the properties of summation, 
        we can compute explicit formulas for accumulations when the increment 
        sequence is a linear combination of these elementary sequences. 
        To prove that these formulas are correct,
        we also introduce a theorem that shows that a sequence is uniquely defined
        by its initial value and increments.
        </p>
        
    </subsection>
   
    <subsection>
        <title>Properties of Summation</title>
        
        <p>
        Because a summation involves only addition, the basic properties of addition
        translate to corresponding properties for summation.
        </p>
        
        <p>
        Suppose we have a sequence <m>x</m> and a constant <m>\alpha</m>.
        We can create a new sequence <m>\alpha x</m>, 
        called a <term>constant multiple</term>, by multiplying
        every term of <m>x</m> by the same constant <m>\alpha</m>. 
        Using the constant multiple as an increment sequence, every term
        will have a common factor of <m>\alpha</m>.
        This leads to a property of summation called the constant multiple rule.
        </p>
        
        <theorem xml:id="thm-summation-constant-multiple-rule">
            <title>Constant Multiple Rule of Summation</title>
            <statement>
                <p>
                Let <m>x</m> be a sequence and <m>\alpha</m> a constant. Then for
                any lower and upper limits,
                <me> \sum_{k=m}^{n} \alpha x_k = \alpha \sum_{k=m}^{n} x_k. </me>
                </p>
            </statement>
        </theorem>
        
        <p>
        The next property considers a sequence that is itself formed by adding
        two sequences together. Suppose we have two sequences <m>u</m> and <m>w</m>
        and we form a new sequence <m>u+w</m> with values that are the sum
        of the corresponding values of <m>u</m> and <m>w</m>.
        Because addition is both commutative and associative, any sum of a finite
        number of terms can be regrouped in any convenient way.
        A summation of terms <m>u+w</m> can therefore be grouped in a way that we
        add only the terms from <m>u</m> and then add only the terms from <m>v</m>
        and then add the results. This leads to a property of summation
        called the sum rule.
        </p>
        
        <theorem xml:id="thm-summation-sum-rule">
            <title>Sum Rule of Summation</title>
            <statement>
                <p>
                Let <m>u</m> and <m>w</m> be any two sequences with common domain.
                Then for any lower and upper limits,
                <me> \sum_{k=m}^{n} [u_k+w_k] = \sum_{k=m}^{n} u_k + \sum_{k=m}^{n} w_k. </me>
                </p>
            </statement>
        </theorem>
        
        <p>
        Using the rules together creates a new rule called linearity involving
        two sequences <m>x</m> and <m>y</m>.
        The idea for this rule is that an individual term in the increment sequence
        is the sum of a constant multiple of each, <m>\alpha x + \beta y</m>.
        Such a sum is called a <term>linear combination</term> of <m>x</m> and <m>y</m>
        with coefficients <m>\alpha</m> and <m>\beta</m>. This name results from
        the general equation of a line being of the form <m>ax + by = c</m>.
        </p>
        
        <theorem xml:id="thm-summation-linearity">
            <title>Linearity of Summation</title>
            <statement>
                <p>
                Let <m>x</m> and <m>y</m> be any two sequences with common domain
                and let <m>\alpha</m> and <m>\beta</m> be any two constants.
                Then for any lower and upper limits,
                <me> \sum_{k=m}^{n} [\alpha x_k + \beta y_k] = \alpha \sum_{k=m}^{n} x_k + \beta \sum_{k=m}^{n} y_k. </me>
                </p>
            </statement>
        </theorem>
        
        <p>
        Using <m>\alpha = 1</m> and <m>\beta = -1</m>, the linear combination
        becomes a difference, <m>\alpha x + \beta y = x - y</m>. 
        So the difference rule is a special case of linearity.
        </p>
        
        <theorem xml:id="thm-summation-difference-rule">
            <title>Difference Rule of Summation</title>
            <statement>
                <p>
                Let <m>x</m> and <m>y</m> be any two sequences with common domain.
                Then for any lower and upper limits,
                <me> \sum_{k=m}^{n} [x_k-y_k] = \sum_{k=m}^{n} x_k - \sum_{k=m}^{n} y_k. </me>
                </p>
            </statement>
        </theorem>
        
        <p>
        There are no corresponding rules for multiplication or division.
        This is really no different than emphasizing the importance of multiplying all terms
        using the distributive property, such as occurs with the FOIL method for multiplying binomials.
        For example, <m>\displaystyle \sum_{k=1}^{3} [k] = 1+2+3 = 6</m>.
        The product of the sum gives one result:
        <me> \sum_{k=1}^{3}[k] \cdot \sum_{k=1}^{3}[k] = (1+2+3) \cdot (1+2+3) = 6 \cdot 6 = 36. </me>
        But the sum of the products gives a different result:
        <me> \sum_{k=1}^{3}[k \cdot k] = (1^2+2^2+3^2) = 1+4+9 = 14. </me>
        In general,
        <me> \sum_{k=m}^{n} [x_k \cdot y_k] \ne \sum_{k=m}^{n} x_k \cdot \sum_{k=m}^{n} y_k. </me>
        </p>
        
        <p>
        The other important properties of summation focus on how to split a summation
        into two pieces. Suppose a summation has lower index limit <m>m</m> and upper
        index limit <m>n</m>. The total summation can be split into two parts,
        where the first part is a summation involving the terms having index values
        from <m>m</m> to <m>k</m> and the second part is a summation involving the
        remaining terms with index values <m>k+1</m> through <m>n</m>. (Of course, since we
        chose to use <m>k</m> as that intermediate integer, our dummy variable 
        for the summation needs to be different.)
        </p>
        
        <theorem xml:id="thm-summation-splitting">
            <title>Splitting Rule for Summation</title>
            <statement>
                <p>
                Given any sequence <m>x</m> and summation limits <m>m</m> and <m>n</m>
                and an intermediate integer <m>k</m> with <m>m \lt k \lt n</m>,
                <me> \sum_{i=m}^{n} [x_i] = \sum_{i=m}^{k} [x_i] + \sum_{i=k+1}^{n} [x_i]. </me>
                </p>
            </statement>
        </theorem>
        
        <p>
        A consequence of the splitting property of summation is that a summation
        over a particular range of index values can be written as a difference of
        a summation over a larger range of index values minus summations representing
        the terms that were not in the original range of summation.
        </p>
        
        <corollary xml:id="cor-summation-reduce">
            <title>Reducing a Summation over a Restricted Range</title>
            <statement>
                <p>
                Given any sequence <m>x</m> and summation limits <m>m</m> and <m>n</m>.
                Suppose there are index values <m>k \lt m</m> and <m>p \gt n</m>.
                Then each of the following computations give the same value.
                </p>
                <md>
                    <mrow> \sum_{j=m}^{n} x_j &amp;= \sum_{j=k}^{n} x_j - \sum_{j=k}^{m-1} x_j, </mrow>
                    <mrow> &amp;= \sum_{j=m}^{p} x_j - \sum_{j=n+1}^{p} x_j, </mrow>
                    <mrow> &amp;= \sum_{j=k}^{p} x_j - \sum_{j=k}^{m-1} x_j - \sum_{j=n+1}^{p} x_j. </mrow>
                </md>
            </statement>
        </corollary>

        <p>
        In order to establish formulas for summations, we will need a way
        to demonstrate that two sequences are really the same.
        We conclude this subsection by introducing a theorem that is not
        so much a property of summation, but a method to infer that sequences from
        two different representations are actually the same.
        </p>
        
        <theorem xml:id="thm-sequence-uniqueness">
            <title>Uniqueness of Sequences</title>
            <statement>
                <p>
                Suppose that two sequences <m>u</m> and <m>w</m>
                have the same initial value, <m>u_0=w_0</m>, and
                the same increments, <m>\nabla u = \nabla w</m>.
                Then <m>u=w</m>.
                </p>
            </statement>
            <proof>
                <p>
                The proof of this theorem requires showing that
                <m>u_n = w_n</m> for every <m>n=0, 1, 2, \ldots</m>.
                Such a proof involves a mathematical principle called induction.
                This principle requires first showing that an initial statement is true,
                in this case that <m>u_0 = w_0</m>, which is one of the assumptions.
                The second step of the principle is to show that if we assume that
                any given statement is true, in this case that <m>u_n = w_n</m>
                for a particular value of <m>n</m>, then the next statement
                must also be true, or that <m>u_{n+1} = w_{n+1}</m>.
                </p>
                <p>
                Because both <m>u</m> and <m>w</m> are accumulations with the same increments,
                we know that <m>u_{n+1} = u_n + (\nabla u)_{n+1}</m>.
                By our assumption, <m>u_n = w_n</m>; and by our hypothesis, <m>(\nabla u)_{n+1} = (\nabla w)_{n+1}</m>.
                This means 
                <me>u_{n+1} = w_n + (\nabla w)_{n+1} = w_{n+1}. </me>
                By the principle of mathematical induction, the equations <m>u_n = w_n</m> 
                must therefore be true for every <m>n=0, 1, 2, 3, \ldots</m>, meaning that
                the two sequences are, in fact, the same.
                </p>
            </proof>
        </theorem>
        
        <p>
        Theorem <xref ref="thm-accumulation-backward-difference" /> stated that every sequence
        is an accumulation of its backward differences. This is an immediate corollary
        of Theorem <xref ref="thm-sequence-uniqueness" />. But we will be able to use this
        theorem in many other circumstances when we wish to show that two representations
        of a sequence give the same sequence. 
        </p>
    </subsection>
        
    <subsection>
        <title>Elementary Summation Formulas</title>
        
        <p>
        There are some elementary increment sequences for which we can find
        an explicit formula for the accumulation sequence.
        We will state the results and prove them using the uniqueness criteria for sequences.
        </p>
        
        <theorem xml:id="thm-sum-of-constants">
            <title>Sum of Constant Sequence</title>
            <statement>
                <me> \sum_{k=1}^{n} c = cn </me>
            </statement>
            <proof>
                <p>
                The accumulation sequence of interest is <m>\displaystyle u_n = \sum_{k=1}^{n} c</m>.
                The increment sequence <m>x</m> is a sequence of constants, <m>c_k=c</m>.
                The proposed explicit sequence is <m>w_n = cn</m>.
                The initial value of <m>u</m> is <m>u_0 = 0</m> which matches the initial value of the explicit sequence <m>w_0 = c(0) = 0</m>.
                To show that <m>w=u</m>, we need to show that <m>w</m> has the same increments.
                <me> (\nabla w)_n = w_{n}-w_{n-1} = cn - c(n-1) = cn - cn + c = c</me>
                Since <m>(\nabla w)_n = c</m> is the same increment as <m>x_k</m>, <m>u</m> and <m>w</m> are the same sequence.
                </p>
            </proof>
        </theorem>
        
        <theorem xml:id="thm-sum-of-integers">
            <title>Sum of Natural Numbers</title>
            <statement>
                <me> \sum_{k=1}^{n} k = \frac{n(n+1)}{2} </me>
            </statement>
            <proof>
                <p>
                The accumulation sequence of interest is <m>\displaystyle u_n = \sum_{k=1}^{n} k</m>.
                The increment sequence <m>x</m> is defined by <m>x_k=k</m>.
                The proposed explicit sequence is <m>w_n = \frac{n(n+1)}{2}</m>.
                The initial value of <m>u</m> is <m>u_0 = 0</m> which matches the initial value of the explicit sequence <m>w_0 = \frac{0(1)}{2} = 0</m>.
                The increment for <m>w</m> is given by:
                <md>
                    <mrow> (\nabla w)_n &amp;= w_{n}-w_{n-1} = \frac{n(n+1)}{2} - \frac{(n-1)n}{2} </mrow>
                    <mrow> &amp;= \frac{n}{2}\big( (n+1) - (n-1) \big) = \frac{n}{2} \cdot 2 = n</mrow>
                </md>
                Since <m>(\nabla w)_n = n = x_n</m>, <m>u</m> and <m>w</m> have the same increments and same initial value.
                By Theorem <xref ref="thm-sequence-uniqueness" />, <m>u</m> and <m>w</m> are equivalent.
                </p>
            </proof>
        </theorem>
        
        <theorem xml:id="thm-sum-of-squares">
            <title>Sum of Squares</title>
            <statement>
                <me> \sum_{k=1}^{n} k^2 = \frac{n(n+1)(2n+1)}{6} </me>
            </statement>
            <proof>
                <p>
                The accumulation sequence of interest is <m>\displaystyle u_n = \sum_{k=1}^{n} k^2</m>
                so that increment sequence <m>x</m> is defined by <m>x_k=k^2</m>.
                The proposed explicit sequence is <m>w_n = \frac{n(n+1)(2n+1)}{6}</m>.
                The initial value of <m>u</m> is <m>u_0 = 0</m> which matches the initial value of the explicit sequence <m>w_0 = \frac{0(1)(1)}{6} = 0</m>.
                The increment for <m>w</m> is given by:
                <md>
                    <mrow> (\nabla w)_n &amp;= w_{n}-w_{n-1} </mrow>
                    <mrow> &amp;= \frac{n(n+1)(2n+1)}{6} - \frac{(n-1)n\big(2(n-1)+1\big)}{6} </mrow>
                    <mrow> &amp;= \frac{n}{6}\big( (n+1)(2n+1) - (n-1)(2n-1) \big) </mrow>
                    <mrow> &amp;= \frac{n}{6} \big((2n^2+3n+1) - (2n^2-3n+1)\big) </mrow>
                    <mrow> &amp;= \frac{n}{6}(6n) = n^2 </mrow>
                </md>
                Since <m>(\nabla w)_n = n^2 = x_n</m>, <m>u</m> and <m>w</m> have the same increments and same initial value.
                By Theorem <xref ref="thm-sequence-uniqueness" />, <m>u</m> and <m>w</m> are equivalent.
                </p>
            </proof>
        </theorem>
        
        <theorem xml:id="thm-sum-of-cubes">
            <title>Sum of Cubes</title>
            <statement>
                <me> \sum_{k=1}^{n} k^3 = \frac{n^2(n+1)^2}{4} </me>
            </statement>
            <proof>
                <p>
                The accumulation sequence of interest is <m>\displaystyle u_n = \sum_{k=1}^{n} k^3</m>
                so that increment sequence <m>x</m> is defined by <m>x_k=k^3</m>.
                The proposed explicit sequence is <m>w_n = \frac{n^2(n+1)^2}{4}</m>.
                The initial value of <m>u</m> is <m>u_0 = 0</m> which matches the initial value of the explicit sequence <m>w_0 = \frac{0(1)(1)}{6} = 0</m>.
                The increment for <m>w</m> is given by:
                <md>
                    <mrow> (\nabla w)_n &amp;= w_{n}-w_{n-1} </mrow>
                    <mrow> &amp;= \frac{n^2(n+1)^2}{4} - \frac{(n-1)^2n^2}{4} </mrow>
                    <mrow> &amp;= \frac{n^2}{4}\big( (n+1)^2 - (n-1)^2 \big) </mrow>
                    <mrow> &amp;= \frac{n^2}{4} \big((n^2+2n+1) - (n^2-2n+1)\big) </mrow>
                    <mrow> &amp;= \frac{n^2}{4}(4n) = n^3 </mrow>
                </md>
                Since <m>(\nabla w)_n = n^3 = x_n</m>, <m>u</m> and <m>w</m> have the same increments and same initial value.
                By Theorem <xref ref="thm-sequence-uniqueness" />, <m>u</m> and <m>w</m> are equivalent.
                </p>
            </proof>
        </theorem>
        
        <theorem xml:id="thm-sum-of-geometric">
            <title>Sum of a Geometric Sequence</title>
            <statement>
                <me> \sum_{k=0}^{n} b^k = \frac{b^{n+1}-1}{b-1} </me>
            </statement>
            <proof>
                <p>
                The accumulation sequence of interest is <m>\displaystyle u_n = \sum_{k=0}^{n} b^k</m>
                so that increment sequence <m>x</m> is defined by <m>x_k=b^k</m>.
                The proposed explicit sequence is <m>w_n = \frac{b^{n+1}-1}{b-1}</m>.
                Because the summation lower index is 0, the sequence <m>u</m> has a non-zero initial value
                <m>u_0 = b^0 = 1</m>. The initial value of <m>w</m> is given by
                <me> w_0 = \frac{b^{1}-1}{b-1} = 1,</me>
                which matches the initial value of <m>u</m>.
                The increment for <m>w</m> is given by:
                <md>
                    <mrow> (\nabla w)_n &amp;= w_{n}-w_{n-1} = \frac{b^{n+1}-1}{b-1} - \frac{b^{n}-1}{b-1} </mrow>
                    <mrow> &amp;= \frac{1}{b-1}\big( (b^{n+1}-1) - (b^n-1) \big) </mrow>
                    <mrow> &amp;= \frac{b^{n+1}-b^n}{b-1} = \frac{b^n(b-1)}{b-1} = b^n </mrow>
                </md>
                Since <m>(\nabla w)_n = b^n = x_n</m>, <m>u</m> and <m>w</m> have the same increments and same initial value.
                By Theorem <xref ref="thm-sequence-uniqueness" />, <m>u</m> and <m>w</m> are equivalent.
                </p>
            </proof>
        </theorem>
        
        <example>
            <statement>
                <p>
                Find the sum of the integers <m>1, 2, \ldots, 100</m>.
                </p>
            </statement>
            <solution>
                <p>
                Start by recognizing this as the accumulation of the sequence
                <m>x=(k : k=1, 2, 3, \ldots)</m> over a range <m>1 \le k \le 100</m>.
                This allows us to rewrite our problem as a summation:
                <me> \sum_{k=1}^{100} k. </me>
                Theorem <xref ref="thm-sum-of-integers"/> applies directly with <m>n=100</m>,
                so we know
                <me> \sum_{k=1}^{100} k = \frac{100(101)}{2} = 5050. </me>
                </p>
            </solution>
        </example>
        
        <example>
            <statement>
                <p>
                Find the sum of the integers <m>100, 101, \ldots, 200</m>.
                </p>
            </statement>
            <solution>
                <p>
                This example is a little more complex than the previous one because
                we do not start at <m>k=1</m>. Instead, we are summing the sequence
                <m>x = (k : k=1,2,3,\ldots)</m> over a range <m>100 \le k \le 200</m>,
                corresponding to a summation
                <me> \sum_{k=100}^{200} k. </me>
                Using Corollary <xref ref="cor-summation-reduce"/>, we can write the
                summation in question as a difference
                <me> \sum_{k=100}^{200} k = \sum_{k=1}^{200} k - \sum_{k=1}^{99}, </me>
                since we don't want to include the range <m>1 \le k \le 99</m>.
                Each of the summations can be computed using Theorem <xref ref="thm-sum-of-integers"/>:
                <md>
                    <mrow> \sum_{k=1}^{200} k = \frac{200(201)}{2} = 20100, </mrow>
                    <mrow> \sum_{k=1}^{99} k = \frac{99(100)}{2} = 4950, </mrow>
                </md>
                so that the desired sum is 
                <me> \sum_{k=100}^{200} k = 20100 - 4950 = 15150. </me>
                </p>
            </solution>
        </example>
    </subsection>
    
    <subsection>
        <title>Summations of Combinations</title>
        
        <p>
        With the accumulation of elementary sequences established and theorems regarding
        combinations of sequences proved, we are ready to apply our summation formulas
        for more complex summations that involve linear combinations of elementary sequences.
        Recall that a linear combination of sequences is the sum of constant multiples of
        those other sequences. Only sums behave well with summation. If a summation involves
        a product or quotient (or other complex function) of elementary sequences, then
        the strategy described here does not apply.
        </p>
        
        <p>
        The basic idea introduced here is to apply the linearity property of summations
        stated in Theorem <xref ref="thm-summation-linearity"/>. The sums will split into
        separate summations and the constant multiples factor out of the individual sums.
        We will then apply our known summation formulas for the remaining summations
        to find our desired explicit formula.
        </p>
        
        <example>
            <statement>
                <p>
                Find <m>\displaystyle \sum_{k=1}^{20} (500+60k-2k^2)</m>.
                </p>
            </statement>
            <solution>
                <p>
                Linearity consists of the sum rule (use the summation each term in the sum)
                and the constant multiple rule (constant multiples factor out of a sum).
                Although linearity allows the two steps to be done at once, the following
                illustrates the steps in order:
                <md>
                    <mrow> \sum_{k=1}^{20} [500+60k-2k^2] &amp;= \sum_{k=1}^{20} [500] + \sum_{k=1}^{20} [60k] + \sum_{k=1}^{20} [-2k^2] </mrow>
                    <mrow> &amp;= \sum_{k=1}^{20} [500] + 60 \sum_{k=1}^{20} [k] -2 \sum_{k=1}^{20} [k^2]. </mrow>
                </md>
                The brackets emphasize that the increments of a summation are given by a particular value or formula.
                Each of these summations involve elementary increment sequences for which we have explicit formulas.
                <md>
                    <mrow> \sum_{k=1}^{20} [500] = 500(20) = 10000, </mrow>
                    <mrow> \sum_{k=1}^{20} [k] = \frac{20(21)}{2} = 210, </mrow>
                    <mrow> \sum_{k=1}^{20} [k^2] = \frac{20(21)(41)}{6} = 2870. </mrow>
                </md>
                Consequently, 
                <me> \sum_{k=1}^{20} [500+60k-2k^2] = 10000 + 60(210) - 2(2870) = 16860. </me>
                </p>
            </solution>
        </example>
        
        <p>
        The same strategy still applies if the constant multiple coefficients are written using parameters
        or even using variables other than the dummy index variable of summation. In particular,
        when the upper limit of the summation is a variable, the formula for the sequence
        might also involve that variable as well as the index variable. Because this will
        be encountered frequently, an example is provided below.
        </p>
        
        <example>
            <statement>
                <p>
                Find a formula for <m>\displaystyle \sum_{k=1}^{n} \left( \frac{3k}{n^2} - \frac{k^2}{n^3} \right)</m>
                that involves only <m>n</m>.
                </p>
            </statement>
            <solution>
                <p>
                The sequence of increments is <m>\displaystyle x_k = \frac{3k}{n^2} - \frac{k^2}{n^3}</m>.
                We recognize this as a linear combination of the more elementary sequences <m>k</m> and <m>k^2</m>
                if we rewrite the sequence
                <me> x_k = \frac{3}{n^2} \cdot k + \frac{-1}{n^3} \cdot k^2. </me>
                Because the coefficients of this linear combination only involve <m>n</m>
                and not the dummy variable of the summation,
                we can rewrite the summation as a corresponding linear combination
                and then apply the elementary summation formulas to find our desired formula.
                <md>
                    <mrow> \sum_{k=1}^{n} \left( \frac{3k}{n^2} - \frac{k^2}{n^3}\right) &amp;= \frac{3}{n^2} \sum_{k=1}^{n} [k] - \frac{1}{n^3} \sum_{k=1}^{n}[k^2] </mrow>
                    <mrow> &amp;= \frac{3}{n^2} \cdot \frac{n(n+1)}{2} - \frac{1}{n^3} \cdot \frac{n(n+1)(2n+1)}{6} </mrow>
                    <mrow> &amp;= \frac{3n(n+1)}{2n^2} - \frac{n(n+1)(2n+1)}{6n^3}. </mrow>
                </md>
                </p>
            </solution>
        </example>
    </subsection>
</section>