<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2015  D. Brian Walton          -->
<!-- See the file COPYING for copying conditions. -->
   
<section xml:id="sequences-accumulation">
  <title>Sequences from Accumulation</title>

  <introduction>
    <title>Overview</title>
    
    <p>
    One of the most important mathematical ideas in calculus is 
    that of an accumulation of change for physical quantities. 
    We start by thinking about change and accumulation of change for sequences.
    Eventually, this will lead us to the calculus ideas of the derivative and of definite integrals. 
    </p>
    <p>
    In this section, we learn explore sequences through their differences and accumulations.
    The differences for a sequence defines a new sequence which we call the increments.
    We introduce the mathematical notation for adding the terms of a sequence using summation notation.
    We also learn about conditions which determine when a sequence will be 
    increasing, decreasing, concave up and concave down based on properties of the increments.
    </p>
  </introduction>
  
  <subsection>
    <title>Sequence Differences and Accumulation</title>
    
    <p>
    When we first discussed arithmetic sequences, we learned that they had a constant increment.
    For example, the sequence <m>x=(1, 4, 7, 10, 13, \ldots)</m> has a constant increment of <m>+3</m>.
    Sometimes, more complicated sequences can also be understood which have variable increments.
    </p>
    
    <example>
      <p>
      Consider <m>x = (5, 7, 11, 17, 25, \ldots)</m>.
      The increments are not always the same, but we can find a pattern.
      </p>
      <sidebyside width="80%">
        <image>
          <latex-image>
          <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
          <![CDATA[\tikzset{%
          }
          \begin{tikzpicture}[x=2cm]
          \node (x0) at (0,0) {$x_0=5$};
          \node (x1) at (1,0) {$x_1=7$};
          \node (x2) at (2,0) {$x_2=11$};
          \node (x3) at (3,0) {$x_3=17$};
          \node (x4) at (4,0) {$x_4=25$};
          \draw [->] (x0) -- (x1) node[pos=0.5,above] {$+2$};
          \draw [->] (x1) -- (x2) node[pos=0.5,above] {$+4$};
          \draw [->] (x2) -- (x3) node[pos=0.5,above] {$+6$};
          \draw [->] (x3) -- (x4) node[pos=0.5,above] {$+8$};
          \end{tikzpicture}]]>
          </latex-image>
        </image>
      </sidebyside>
      <p>
      The increments form a new sequence, which is the sequence of even numbers.
      The next value in the sequence , if the pattern continues, will be <m>x_5=x_4+10=35</m>.
      Our recurrence relation will require a formula involving the index variable.
      Consider the pattern:
      <md>
        <mrow>x_0 &amp;= 5</mrow>
        <mrow>x_1 &amp; = x_0 + 2 = x_0 + 2(1) </mrow>
        <mrow>x_2 &amp; = x_1 + 4 = x_1 + 2(2) </mrow>
        <mrow>x_3 &amp; = x_2 + 6 = x_2 + 2(3) </mrow>
        <mrow>x_4 &amp; = x_3 + 8 = x_3 + 2(4) </mrow>
      </md>
      The pattern can be written 
      as a backward recurrence <me>x_{n} = x_{n-1} + 2n</me> 
      or as a forward recurrence <me>x_{n+1} = x_n + 2(n+1).</me>
      </p>
    </example>
    
    <p>
    The previous example illustrated how we can use the increments of a sequence to describe that sequence.
    We introduce some notation to calculate these increments.
    </p>
    
    <definition xml:id="difference-operators">
      <title>The Backward Difference</title>
      <statement>
        <p>
        Given a sequence <m>x=(x_n)_{n=n_0}^{\infty}</m> with first index <m>n_0</m>,
        we define the <term>increment sequence</term> or <term>backward difference</term>
        named <m>\nabla x=(\nabla x_n)_{n=n_0+1}^{\infty}</m> defined by
        <me>\nabla x_n = x_n - x_{n-1}.</me>
        We can also define the <term>forward difference</term> <m>\Delta x=(\Delta x_n)_{n=n_0}^{\infty}</m>
        defined by
        <me>\Delta x_n = x_{n+1} - x_{n}.</me>
        </p>
      </statement>
    </definition>
    
    <p>
    We will only use the backward difference when discussing increments
    because it is more natural when we work with summation notation.
    Analogous ideas and formulas could be stated for the forward difference but will not be needed.
    </p>
    
    <p>
    For any sequence, we can compute its increments using backward differences.
    In a reverse manner, if we are told the increments and an initial value, 
    we can reproduce the original sequence using a backward recurrence,
    <me>x_n = x_{n-1} + \nabla x_n.</me>
    We call the resulting sequence the accumulation of the increments.
    </p>
    
    <definition xml:id="defn-accumulation-sequence">
      <title>Accumulation Sequence</title>
      <statement>
        <p>
        Given a sequence of increments, <m>x=(x_n)_{n=n_0}^{\infty}</m>,
        we can define the <term>accumulation sequence</term> <m>u</m>
        using the backward recurrence,
        <me>u_n = u_{n-1} + x_n, \quad n \ge n_0,</me>
        and an initial value.
        </p>
      </statement>
    </definition>
    
    <p>
    Notice that the first index of the increments will always be one later 
    than the first index of the corresponding accumulation.
    </p>
    
    <example>
      <statement>
        <p>
        Find the first six terms of the accumulation sequence named <m>s</m> with
        increments defined by <m>x=(x_n)_{n=-1}^{\infty} = (-3,0,3,6,9,\ldots)</m>
        and whose first value is 12.
        </p>
      </statement>
      <solution>
        <p>
        Because accumulation uses a backward recurrence, 
        the first index of <m>s</m> will be <m>n=-2</m>.
        We can compute the values of the accumulation <m>s</m> by 
        successively adding the increments.
        </p>
        <sidebyside margins="auto">
          <tabular>
            <row bottom="major">
              <cell><m>n</m></cell>
              <cell><m>x_n</m></cell>
              <cell><m>s_n</m></cell>
            </row>
            <row>
              <cell>-2</cell>
              <cell></cell>
              <cell>12</cell>
            </row>
            <row>
              <cell>-1</cell>
              <cell>-3</cell>
              <cell>9</cell>
            </row>
            <row>
              <cell>0</cell>
              <cell>0</cell>
              <cell>9</cell>
            </row>
            <row>
              <cell>1</cell>
              <cell>3</cell>
              <cell>12</cell>
            </row>
            <row>
              <cell>2</cell>
              <cell>6</cell>
              <cell>18</cell>
            </row>
            <row>
              <cell>3</cell>
              <cell>9</cell>
              <cell>27</cell>
            </row>
          </tabular>
        </sidebyside>
      </solution>
    </example>
    
    <p>
    Because we can recreate a sequence using its increments and initial value,
    knowing that information is enough to identify a sequence.
    In particular, if we have two different ways of describing a sequence and
    they both have the same initial value and same increments, then they are the same sequence.
    </p>
    
    <theorem xml:id="thm-sequence-uniqueness">
      <title>Sequences Identified by Increments</title>
      <statement>
        <p>
        Given any two sequences <m>u</m> and <m>w</m>,
        if <m>u_0=w_0</m> and <m>\nabla u_n = \nabla w_n</m> for all <m>n \gt 0</m>,
        then <m>u_n = w_n</m> for all <m>n \ge 0</m>.
        </p>
      </statement>
    </theorem>
    
    <p>
    We can use this theorem to show that an accumulation sequence has an explicit formula
    by showing that the backward differences of that formula describe the increment sequence.
    </p>
    
    <example xml:id="example-odd-integer-formula">
      <statement>
        <p>
        Show that the sequence of odd integers have explicit formula <m>x_n=2n-1</m>, <m>n=1, 2, 3, \ldots</m>.
        </p>
      </statement>
      <solution>
        <p>
        We need to verify the initial value and the increments.
        The first odd integer is 1, which agrees with <m>x_1=2(1)-1 = 1</m>.
        So our explicit formula has the correct initial value.
        Next, we verify the increments.
        Odd integers have increments <m>\nabla x_n = 2</m>, 
        which we verify using the formula.
        <md>
          <mrow>x_n - x_{n-1} &amp; = \big(2n-1\big) - \big(2(n-1)-1\big)</mrow>
          <mrow> &amp;= 2n-1-(2n-3) = 2n-1-2n+3 </mrow>
          <mrow> &amp;= 2 </mrow>
        </md>
        Since <m>x_n</m> has the correct initial value and correct increments,
        <m>x_n=2n-1</m> is the explicit formula for the sequence of odd integers, <m>n \ge 1</m>.
        </p>
      </solution>
    </example>
    
    <example xml:id="example-accumulation-odd-integers">
      <statement>
        <p>
        Using the sequence of odd integers <m>x_n=2n-1</m>, <m>n \ge 1</m>,
        as the increments for an accumulation sequence <m>s</m> with <m>s_0=0</m>,
        show that <m>s_n = n^2</m>.
        That is, show that the accumulation of the odd integers is the sequence of squared integers.
        </p>
      </statement>
      <solution>
        <p>
        We start by seeing if the statement makes sense by checking the first few values.
        <md>
          <mrow> x_1 &amp;= 1 </mrow>
          <mrow> x_1 + x_2 &amp;= 1+3 = 4 </mrow>
          <mrow> x_1 + x_2 + x_3 &amp;= 1+3+5 = 9 </mrow>
        </md>
        The pattern appears to hold for the first few values.
        </p>
        <p>
        The initial value using the explicit formula is <m>s_0 = 0^2 = 0</m>,
        the same initial value as stated for the accumulation.
        In order to prove that it will always be true, we need to compare the actual increments.
        The increment of <m>s</m> is computed as the backward difference,
        <md>
          <mrow> \nabla s_n &amp;= s_{n} - s_{n-1} </mrow>
          <mrow> &amp;= n^2 - (n-1)^2 </mrow>
          <mrow> &amp;= n^2 - (n^2-2n+1) </mrow>
          <mrow> &amp;= 2n-1. </mrow>
        </md>
        Because <m>\nabla s_n = x_n</m>, we know that <m>s_n</m> is the accumulation of the odd integers
        with initial value <m>s_0 = 0</m>.
        </p>
      </solution>
    </example>
  </subsection>
  
  <subsection>
    <title>Summary</title>
    <p>
    <ul>
      <li>
        <p>
        Every sequence <m>x</m> can be interpreted as an accumulation of increments, 
        which we measure using backward differences,
        <me>\nabla x_n = x_n - x_{n-1}</me>.
        </p>
      </li>
      <li>
        <p>
        Given a sequence <m>x = (x_n)_{n=1}^{\infty}</m>,
        we can define a new sequence <m>u</m> called the <term>accumulation sequence</term> of <m>x</m>
        with a recurrence relation
        <me>u_{n} = u_{n-1} + x_n</me>
        and an initial value <m>u_0</m> 
        so that the increments of <m>u</m> is given by the sequence <m>x</m>, <m>\nabla u_n = x_n</m>.
        </p>
      </li>
      <li>
        <p>
        If two sequences share the same initial value and the same increments, 
        then the sequences are identical. (See <xref ref="thm-sequence-uniqueness"/>.)
        </p>
      </li>
      <li>
        <p>
        The <xref text="title" ref="thm-sequence-monotonicity"/> shows 
        that a sequence is increasing over the range of index values
        for which the increments are positive
        and decreasing over the range of index values
        for which the increments are negative.
        </p>
      </li>
      <li>
        <p>
        The <xref text="title" ref="thm-sequence-concavity"/> shows 
        that a sequence is concave up over the range of index values
        for which the second backward differences are positive
        and concave down over the range of index values
        for which the second backward differences are negative.
        </p>
      </li>
    </ul>
    </p>
  </subsection>
  <exercises>
    <exercisegroup>
      <introduction>
        <p>
        Find the first six terms of the indicated accumulation sequence
        for the given increment sequence.
        Clearly indicate the relevant index values.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>
          Find <m>u</m> with increments defined by <m>x=(x_k)_{k=2}^\infty = (-4,-2,0,2,4,6,\ldots)</m>
          and initial value <m>21</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          Find <m>w</m> with increments defined by <m>y=(y_i)_{i=0}^\infty = (1,-1,1,1,-1,-1,1,1,1,-1,\ldots)</m>
          and initial value <m>0</m>.
          </p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
        In the following problems, show that explicit definition and recursive definition
        define the same sequence. If not, explain why.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>
          <m>x_n = 3n-5</m> for <m>n=-2, -1, 0, \ldots</m> defines the same sequence as
          <m>x_n = x_{n-1} + 3</m> with <m>x_{-2} = -11</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>x_n = 2^{n+1}-1</m> for <m>n=0, 1, 2, \ldots</m> defines the same sequence as
          <m>x_{n} = x_{n-1} + 2^n</m> with <m>x_{0} = 1</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>x_n = n^2 - n</m> for <m>n=0, 1, 2, \ldots</m> defines the same sequence as
          <m>x_{n} = x_{n-1} + n</m> with <m>x_{0} = 0</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>x_n = \frac{1}{2}(3^n-1)</m> for <m>n=0, 1, 2, \ldots</m> defines the same sequence as
          <m>x_{n+1} = x_{n} + 3^n</m> with <m>x_{0} = 0</m>.
          Note: The recursive formula uses a forward recurrence,
          so either compare forward differences or rewrite the recursive equation as a backward recurrence.
          </p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
        Determine the monotonicity and concavity for each sequence,
        providing the ranges of index values for each behavior.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>
          <m>x_n = 3n-25</m> for <m>n=0,1,\ldots</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>x_n = 300-7n</m> for <m>n=0,1,\ldots</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>x_n = n^2 - 40n + 90</m> for <m>n=0,1,\ldots</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>x_n = 500 + 75 n - n^2</m> for <m>n=0,1,\ldots</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\nabla x_n = 4n-70</m> for <m>n=1,2,\ldots</m> with <m>x_0 = 20</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\nabla x_n = 50-3n</m> for <m>n=1,2,\ldots</m> with <m>x_0 = -10</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\nabla x_n = n^2 - 30n</m> for <m>n=1,2,\ldots</m> with <m>x_0 = 0</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\nabla x_n = -100 + 75n - n^2</m> for <m>n=1,2,\ldots</m> with <m>x_0 = 0</m>.
          </p>
        </statement>
      </exercise>
    </exercisegroup>
  </exercises>
</section>