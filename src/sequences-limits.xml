<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2015-2018  D. Brian Walton          -->
<!-- See the file COPYING for copying conditions. -->
   
<section xml:id="sequence-limits">
  <title>Limits of Sequences</title>

  <subsection>
    <title>Overview</title>
    <p>
      The limit of a sequence describes its end behavior.
      Some sequences converge to a particular value, 
      meaning that the values of the sequence keep getting closer and closer to that value.
      Other sequences grow without bound.
      Still other sequences alternate between values or behave chaotically.
      Limits allow us to establish some mathematical language that characterizes some of these behaviors.
    </p>
    <p>
      The objectives for this section are as follows.
      We will focus on what it means for a sequence to have a limit.
      Much of our intuition will focus on graphs and tables.
      As we do this, we will learn about limits of sequences defined recursively 
      in terms of fixed points of the projection function.
      We will then discuss limit arithmetic involving infinity and how this can be used to find limits of some sequences defined explicitly.
    </p>
  </subsection>
  <subsection xml:id="section-sequence-limit-discussion">
    <title>What Is A Limit?</title>
    <p>
      Consider the sequence defined recursively by <m>x_{n} = 0.8 x_{n-1} + 1</m> and initial value <m>x_0 = 1</m>.
      The next ten values (to the nearest ten-thousandth) are shown in a table and the first twenty values are illustrated in a graph.
    </p>
    <sidebyside widths="30% 60%">
      <tabular>
        <row bottom="major">
          <cell><m>n</m></cell>
          <cell><m>x_n</m></cell>
        </row>
        <row>
          <cell>0</cell>
          <cell>1</cell>
        </row>
        <row>
          <cell>1</cell>
          <cell>1.8</cell>
        </row>
        <row>
          <cell>2</cell>
          <cell>2.44</cell>
        </row>
        <row>
          <cell>3</cell>
          <cell>2.952</cell>
        </row>
        <row>
          <cell>4</cell>
          <cell>3.3616</cell>
        </row>
        <row>
          <cell>5</cell>
          <cell>3.68928</cell>
        </row>
        <row>
          <cell>6</cell>
          <cell>3.951424</cell>
        </row>
        <row>
          <cell>7</cell>
          <cell>4.161139</cell>
        </row>
        <row>
          <cell>8</cell>
          <cell>4.328911</cell>
        </row>
        <row>
          <cell>9</cell>
          <cell>4.463129</cell>
        </row>
        <row>
          <cell>10</cell>
          <cell>4.570503</cell>
        </row>
      </tabular>
      <image width="70%">
        <latex-image>
        <![CDATA[\tikzset{%
        /pgfplots/table/row sep=crcr
        }
        \pgfplotsset{ width=8cm }
        \begin{tikzpicture}
        \begin{axis}[
          xlabel={$n$},
          ylabel={$x_n$},
        ]
        \addplot[
          only marks,
          color=blue
        ] table {
        0 1\\
        1 1.8\\
        2 2.44\\
        3 2.952\\
        4 3.3616\\
        5 3.68928\\
        6 3.951424\\
        7 4.161139\\
        8 4.328911\\
        9 4.463129\\
        10 4.570503\\
        11 4.656403\\
        12 4.725122\\
        13 4.780098\\
        14 4.824078\\
        15 4.859263\\
        16 4.88741\\
        17 4.909928\\
        18 4.927942\\
        19 4.942354\\
        20 4.953883\\
        };
        \end{axis}
        \end{tikzpicture}
        ]]>
        </latex-image>
      </image>
    </sidebyside>
    <p>
      The graph illustrates that the sequence <m>x</m> is increasing and concave down.
      It appears that the values of the sequence might be leveling off at some value.
      A cobweb diagram, shown below, suggests that this sequence has values 
      that are converging to a fixed point of the projection function <m>f(x) = 0.8x+1</m>,
      where <m>f(x)=x</m>.
    </p>
    <sidebyside width="50%">
      <image>
        <latex-image>
        <![CDATA[\tikzset{%
        }
        \begin{tikzpicture}
        \begin{axis}
        [ xmin=-3, xmax=8, ymin=-3, ymax=8,
          xlabel={$x_{n-1}$}, ylabel={$x_{n}$},
        ]
        \addplot [black, no marks] coordinates { (-30,0) (10,0) }; 
        \addplot [domain=-3:8, samples=10, thick, blue] { 0.8*x+1 };
        \addplot [domain=-3:8, samples=2, dashed, red] {x};
        \pgfmathsetmacro{\u}{1}
        \addplot [violet, thick] coordinates {
          (\u,0) (\u,\u)
        };
        \pgfplotsforeachungrouped \n in {1, ..., 20}
          {
            \pgfmathsetmacro{\w}{0.8*\u+1}
            \edef\doplot{
              \noexpand\addplot [violet, thick] coordinates {
                (\u,\u) (\u,\w) (\w,\w)
              };
            }
            \doplot
            \pgfmathsetmacro{\u}{\w}
          };
        \end{axis}
        \end{tikzpicture}]]>
        </latex-image>
      </image>
    </sidebyside>
    <p>
      The fixed point corresponds to an equilibrium of the recursively defined sequence.
      We find the equilibrium value by solving the fixed point equation.
      <md>
        <mrow>f(x) = x</mrow>
        <mrow>0.8x + 1 = x</mrow>
        <mrow>1 = 0.2x</mrow>
        <mrow>x=5</mrow>
      </md>
      Now, let us compare the decimal approximations to the sequence with higher index values with the equilibrium.
    </p>
    <sidebyside>
      <tabular>
        <row bottom="major">
          <cell><m>n</m></cell>
          <cell><m>x_n</m></cell>
        </row>
        <row>
          <cell>20</cell>
          <cell>4.953883140</cell>
        </row>
        <row>
          <cell>25</cell>
          <cell>4.984888427</cell>
        </row>
        <row>
          <cell>30</cell>
          <cell>4.995048240</cell>
        </row>
        <row>
          <cell>35</cell>
          <cell>4.998377407</cell>
        </row>
        <row>
          <cell>40</cell>
          <cell>4.999468309</cell>
        </row>
        <row>
          <cell>45</cell>
          <cell>4.999825775</cell>
        </row>
        <row>
          <cell>50</cell>
          <cell>4.999942910</cell>
        </row>
        <row>
          <cell>55</cell>
          <cell>4.999981293</cell>
        </row>
        <row>
          <cell>60</cell>
          <cell>4.999993870</cell>
        </row>
      </tabular>
    </sidebyside>
    <p>
      Notice that the values for the sequence have decimal approximations
      that are converging to the equilibrium value <m>x=5</m>.
      The greater the index value, the closer the sequence value is to equilibrium.
      Consequently, we say that our sequence has a limit of 5 and write <m>x_n \to 5</m> or 
      <me>\lim_{n \to \infty} x_n = 5</me>.
    </p>
    <p>
      Next consider another example<mdash/>a recursive sequence <m>x</m>
      defined by a recurrence relation <m>x_{n} = 1.2 x_n - 1</m> and initial value <m>x_0=4</m>.
      The projection function <m>f(x) = 1.2x-1</m> has the same fixed point <m>x=5</m> because
      <me>f(5) = 1.2(5)-1 = 5</me>.
    </p>
    <sidebyside widths="30% 60%">
      <tabular>
        <row bottom="major">
          <cell><m>n</m></cell>
          <cell><m>x_n</m></cell>
        </row>
        <row><cell>0</cell><cell>4</cell></row>
        <row><cell>1</cell><cell>3.8</cell></row>
        <row><cell>2</cell><cell>3.56</cell></row>
        <row><cell>3</cell><cell>3.272</cell></row>
        <row><cell>4</cell><cell>2.9264</cell></row>
        <row><cell>5</cell><cell>2.51168</cell></row>
        <row><cell>6</cell><cell>2.014016</cell></row>
        <row><cell>7</cell><cell>1.416819</cell></row>
        <row><cell>8</cell><cell>0.700183</cell></row>
        <row><cell>9</cell><cell>-0.1597804</cell></row>
        <row><cell>10</cell><cell>-1.191736</cell></row>
      </tabular>
      <image width="70%">
        <latex-image>
        <![CDATA[\tikzset{%
        /pgfplots/table/row sep=crcr
        }
        \begin{tikzpicture}
        \begin{axis}[
          xlabel={$n$},
          ylabel={$x_n$},
        ]
        \addplot[
          only marks,
          color=blue
        ] table {
        0 4\\
        1 3.8\\
        2 3.56\\
        3 3.272\\
        4 2.9264\\
        5 2.51168\\
        6 2.014016\\
        7 1.416819\\
        8 0.700183\\
        9 -0.1597804\\
        10 -1.191736\\
        11 -2.430084\\
        12 -3.9161\\
        13 -5.699321\\
        14 -7.839185\\
        15 -10.40702\\
        16 -13.48843\\
        17 -17.18611\\
        18 -21.62333\\
        19 -26.948\\
        20 -33.3376\\
        };
        \end{axis}
        \end{tikzpicture}
        ]]>
        </latex-image>
      </image>
    </sidebyside>
    <p>
      However, this time the sequence is decreasing and concave down,
      moving away from the equilibrium value.
      Instead, the value of the sequence is becoming more and more negative.
      The cobweb diagram illustrates that this will continue forever.
      For a sequence like this, we say <m>x_n \to -\infty</m> or 
      <me>\lim_{n \to \infty} x_n = -\infty</me>.
    </p>
    <sidebyside width="50%">
      <image>
        <latex-image>
        <![CDATA[\tikzset{%
        }
        \begin{tikzpicture}
        \begin{axis}
        [ xmin=-30, xmax=15, ymin=-30, ymax=15,
          xlabel={$x_{n-1}$}, ylabel={$x_{n}$},
        ]
        \addplot [black, no marks] coordinates { (-30,0) (15,0) }; 
        \addplot [domain=-30:15, samples=10, thick, blue] { 1.2*x-1 };
        \addplot [domain=-30:15, samples=2, dashed, red] {x};
        \pgfmathsetmacro{\u}{1}
        \addplot [violet, thick] coordinates {
          (\u,0) (\u,\u)
        };
        \pgfplotsforeachungrouped \n in {1, ..., 20}
          {
            \pgfmathsetmacro{\w}{1.2*\u-1}
            \edef\doplot{
              \noexpand\addplot [violet, thick] coordinates {
                (\u,\u) (\u,\w) (\w,\w)
              };
            }
            \doplot
            \pgfmathsetmacro{\u}{\w}
          };
        \end{axis}
        \end{tikzpicture}]]>
        </latex-image>
      </image>
    </sidebyside>
    <p>
      For the same recursive definition <m>x_{n} = 1.2x_{n-1}-1</m>
      with an initial value above the equilibrium, <m>x_0=6</m>,
      the sequence is increasing and concave up, shown below.
      The values become more and more positive.
      For a sequence like this, we say <m>x_n \to \infty</m> or
      <me>\lim_{n \to \infty} x_n = \infty</me>.
    </p>
    <sidebyside widths="30% 60%">
      <tabular>
        <row bottom="major">
          <cell><m>n</m></cell>
          <cell><m>x_n</m></cell>
        </row>
        <row><cell>0</cell><cell>6</cell></row>
        <row><cell>1</cell><cell>6.2</cell></row>
        <row><cell>2</cell><cell>6.44</cell></row>
        <row><cell>3</cell><cell>6.728</cell></row>
        <row><cell>4</cell><cell>7.0736</cell></row>
        <row><cell>5</cell><cell>7.48832</cell></row>
        <row><cell>6</cell><cell>7.985984</cell></row>
        <row><cell>7</cell><cell>8.583181</cell></row>
        <row><cell>8</cell><cell>9.299817</cell></row>
        <row><cell>9</cell><cell>10.15978</cell></row>
        <row><cell>10</cell><cell>11.19174</cell></row>
      </tabular>
      <image width="70%">
        <latex-image>
        <![CDATA[\tikzset{%
        /pgfplots/table/row sep=crcr
        }
        \begin{tikzpicture}
        \begin{axis}[
          xlabel={$n$},
          ylabel={$x_n$},
        ]
        \addplot[
          only marks,
          color=blue
        ] table {
        0 6\\
        1 6.2\\
        2 6.44\\
        3 6.728\\
        4 7.0736\\
        5 7.48832\\
        6 7.985984\\
        7 8.583181\\
        8 9.299817\\
        9 10.15978\\
        10 11.19174\\
        11 12.43008\\
        12 13.9161\\
        13 15.69932\\
        14 17.83918\\
        15 20.40702\\
        16 23.48843\\
        17 27.18611\\
        18 31.62333\\
        19 36.948\\
        20 43.3376\\
        };
        \end{axis}
        \end{tikzpicture}
        ]]>
        </latex-image>
      </image>
    </sidebyside>
    <p>
      We have seen that a recursive sequence sometimes converges to a fixed point
      and sometimes it diverges away from a fixed point.
      We might wonder if a recursive sequence can have a limit that is <em>not</em> a fixed point of the projection function.
      The answer is no, so long as the projection function is continuous.
    </p>
    <theorem xml:id="thm-recursive-limit-fixed-point">
      <title>Recursive Limits as Fixed Points</title>
      <statement>
        <p>
        If a sequence is defined recursively with a continuous projection function <m>f</m>, 
        <m>x_{n}=f(x_{n-1})</m>, and <m>x_n</m> has a limit, 
        then the limit must be a fixed point of <m>f</m>.
        </p>
      </statement>
      <proof>
        <p>We have to wait for a definition of continuity before this can be proved.</p>
      </proof>
    </theorem>
    <p>
      Note some things that this theorem does not guarantee. 
      First, just because a function has a fixed point does not mean that it will be a limit.
      (The sequence might not have a limit.) 
      Second, the projection function needs to be continuous. 
      If a function is not continuous, then it is possible to have a limit that is not a fixed point. 
      Fortunately, functions defined by simple algebraic formulas will be continuous everywhere they are defined.
      For any continuous projection functions, the only limits <em>will</em> be fixed points.
      Finally, if the sequence is not defined recursively, then we will need other methods to find the limits.
    </p>
    <p>
      In practice, we first observe that a sequence defined recursively has a limit (perhaps through a graph or a table).
      If we find all of the fixed points for the projection function, 
      then we can determine which of those is the appropriate limit. 
      The limit may depend on the initial value of the sequence, 
      so we compare approximate values from the table with the approximate (decimal) values of the fixed points.
    </p>
    <p>
      We consider some additional examples.
      As you attempt the examples or exercises,
      take advantage of technology to generate tables and graphs.
      Refer back to <xref ref="sequences-computing"/> for guidance as needed.
    </p>
    <example>
      <statement>
        <p>
        Use a table and a graph of the sequence defined explicitly as 
        <me>\displaystyle x_n = \frac{3+2^n}{1+3 \cdot 2^n}</me>
        to estimate the limit of <m>x_n</m>.
        </p>
      </statement>
      <solution>
      <p>
      The explicit definition of the sequence allows us to create a table.
      Because we are looking for the decimal approximation to converge,
      we need to show quite a few decimal places.
      Once the table is generated, we can create a plot.
      </p>
      <sidebyside widths="30% 60%" margins="auto">
        <tabular>
          <col halign="center" right="major"/>
          <col halign="left"/>
          <row bottom="major">
            <cell><m>n</m></cell>
            <cell><m>x_n</m></cell>
          </row>
          <row>
            <cell><m>0</m></cell>
            <cell><m>1.0</m></cell>
          </row>
          <row>
            <cell><m>1</m></cell>
            <cell><m>0.714285714286</m></cell>
          </row>
          <row>
            <cell><m>2</m></cell>
            <cell><m>0.538461538462</m></cell>
          </row>
          <row>
            <cell><m>3</m></cell>
            <cell><m>0.44</m></cell>
          </row>
          <row>
            <cell><m>4</m></cell>
            <cell><m>0.387755102041</m></cell>
          </row>
          <row>
            <cell><m>5</m></cell>
            <cell><m>0.360824742268</m></cell>
          </row>
          <row>
            <cell><m>6</m></cell>
            <cell><m>0.347150259067</m></cell>
          </row>
          <row>
            <cell><m>7</m></cell>
            <cell><m>0.34025974026</m></cell>
          </row>
          <row>
            <cell><m>8</m></cell>
            <cell><m>0.336801040312</m></cell>
          </row>
          <row>
            <cell><m>9</m></cell>
            <cell><m>0.335068314899</m></cell>
          </row>
          <row>
            <cell><m>10</m></cell>
            <cell><m>0.334201106411</m></cell>
          </row>
          <row>
            <cell><m>11</m></cell>
            <cell><m>0.33376729048</m></cell>
          </row>
          <row>
            <cell><m>12</m></cell>
            <cell><m>0.333550329563</m></cell>
          </row>
          <row>
            <cell><m>13</m></cell>
            <cell><m>0.333441835863</m></cell>
          </row>
          <row>
            <cell><m>14</m></cell>
            <cell><m>0.333387585702</m></cell>
          </row>
          <row>
            <cell><m>15</m></cell>
            <cell><m>0.333360459793</m></cell>
          </row>
        </tabular>
        <image xml:id="fig-demo-sequence-limits">
          <latex-image>
          <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
          <![CDATA[\tikzset{%
          }
          \begin{tikzpicture}
            \begin{axis}[
              xlabel={$n$}, ylabel={$x_n$},
              ymajorgrids,
            ]
            \addplot[blue, only marks] coordinates {
              (0,1.0)
              (1,0.714285714286)
              (2,0.538461538462)
              (3,0.44)
              (4,0.387755102041)
              (5,0.360824742268)
              (6,0.347150259067)
              (7,0.34025974026)
              (8,0.336801040312)
              (9,0.335068314899)
              (10,0.334201106411)
              (11,0.33376729048)
              (12,0.333550329563)
              (13,0.333441835863)
              (14,0.333387585702)
              (15,0.333360459793)
            };
            \end{axis}
          \end{tikzpicture}]]>
          </latex-image>
        </image>
      </sidebyside>
      <p>
        The plot for the sequence shows that the sequence appears to be leveling off. 
        Looking at the table, we see that more and more of the digits are converging to a 3. 
        If this pattern is real and continues, the limiting value would be the repeating decimal <m>0.3333\ldots</m> 
        which is the rational number <m>\frac{1}{3}</m>. 
        We would say that this sequence has a limit <m>x_n \to \frac{1}{3}</m>:
        <me>\lim_{n \to \infty} x_n = \frac{1}{3}</me>.
      </p>
      </solution>
    </example>
    <example>
      <statement>
        <p>
          Use a table and a graph of the sequence defined explicitly as 
          <me>u_n = 1+\frac{1}{2}\cdot(-1+\frac{1}{2^n})^n,</me> 
          to estimate the limit of <m>u_n</m>.
        </p>
      </statement>
      <solution>
        <p>
          We generate a table of sequence values and plot the results.
        </p>
        <sidebyside widths="30% 60%" margins="auto">
          <tabular>
            <col halign="center" right="major"/>
            <col halign="left"/>
            <row bottom="major">
              <cell><m>n</m></cell>
              <cell><m>u_n</m></cell>
            </row>
            <row>
              <cell><m>0</m></cell>
              <cell><m>1.5</m></cell>
            </row>
            <row>
              <cell><m>1</m></cell>
              <cell><m>0.75</m></cell>
            </row>
            <row>
              <cell><m>2</m></cell>
              <cell><m>1.28125</m></cell>
            </row>
            <row>
              <cell><m>3</m></cell>
              <cell><m>0.6650390625</m></cell>
            </row>
            <row>
              <cell><m>4</m></cell>
              <cell><m>1.38623809814</m></cell>
            </row>
            <row>
              <cell><m>5</m></cell>
              <cell><m>0.573392406106</m></cell>
            </row>
            <row>
              <cell><m>6</m></cell>
              <cell><m>1.45491835196</m></cell>
            </row>
            <row>
              <cell><m>7</m></cell>
              <cell><m>0.526711160622</m></cell>
            </row>
            <row>
              <cell><m>8</m></cell>
              <cell><m>1.48458696224</m></cell>
            </row>
            <row>
              <cell><m>9</m></cell>
              <cell><m>0.508720709959</m></cell>
            </row>
            <row>
              <cell><m>10</m></cell>
              <cell><m>1.49513858939</m></cell>
            </row>
            <row>
              <cell><m>11</m></cell>
              <cell><m>0.502678999959</m></cell>
            </row>
            <row>
              <cell><m>12</m></cell>
              <cell><m>1.4985371216</m></cell>
            </row>
            <row>
              <cell><m>13</m></cell>
              <cell><m>0.500792876146</m></cell>
            </row>
            <row>
              <cell><m>14</m></cell>
              <cell><m>1.49957292337</m></cell>
            </row>
            <row>
              <cell><m>15</m></cell>
              <cell><m>0.500228832948</m></cell>
            </row>
          </tabular>
          <image xml:id="fig-demo-sequence-no-limits">
            <latex-image>
            <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
            <![CDATA[\tikzset{%
            }
            \begin{tikzpicture}
              \begin{axis}[
                xlabel={$n$}, ylabel={$x_n$},
                ymajorgrids,
              ]
              \addplot[blue, only marks] coordinates {
                (0,1.5)
                (1,0.75)
                (2,1.28125)
                (3,0.6650390625)
                (4,1.38623809814)
                (5,0.573392406106)
                (6,1.45491835196)
                (7,0.526711160622)
                (8,1.48458696224)
                (9,0.508720709959)
                (10, 1.49513858939)
                (11, 0.502678999959)
                (12, 1.4985371216)
                (13, 0.500792876146)
                (14, 1.49957292337)
                (15, 0.500228832948)
              };
              \end{axis}
            \end{tikzpicture}]]>
            </latex-image>
          </image>
        </sidebyside>
        <p>
          Notice that for this sequence, the graph appears to level off to two different values. 
          However, this is because the sequence is actually approaching two alternating values. 
          This is an example of approaching a repeating pattern rather than a value,
          most easily seen in the table.
          As we look further down the table,
          the odd index values correspond to a sequence value that is getting closer to 0.5 
          while the even index values correspond to a sequence value that is getting closer to 1.5. 
        </p>
        <p>
          This sequence does not have a limit because the sequence is not approaching a single value.
          We say <m>\displaystyle \lim_{n \to \infty} x_n</m> does not exist.
        </p>
      </solution>
    </example>
    <example>
      <statement>
        <p>
          Use a table and a graph of the sequence defined recursively by 
          <me>z_{n+1} = 2.7 z_n - 0.7 z_n^2</me> 
          and an initial value <m>z_0 = 1</m> to estimate the limit of <m>z_n</m>.
        </p>
      </statement>
      <solution>
        <p>
          We can use the recursive definition and a computer
          to generate approximate values and then graph the sequence.
        </p>
        <sidebyside widths="30% 60%" margins="auto">
          <tabular>
            <col halign="center" right="major"/>
            <col halign="left"/>
            <row bottom="major">
              <cell><m>n</m></cell>
              <cell><m>z_n</m></cell>
            </row>
            <row>
              <cell><m>0</m></cell>
              <cell><m>1.00000000000000</m></cell>
            </row>
            <row>
              <cell><m>1</m></cell>
              <cell><m>2.00000000000000</m></cell>
            </row>
            <row>
              <cell><m>2</m></cell>
              <cell><m>2.60000000000000</m></cell>
            </row>
            <row>
              <cell><m>3</m></cell>
              <cell><m>2.28800000000000</m></cell>
            </row>
            <row>
              <cell><m>4</m></cell>
              <cell><m>2.51313920000000</m></cell>
            </row>
            <row>
              <cell><m>5</m></cell>
              <cell><m>2.36436779299635</m></cell>
            </row>
            <row>
              <cell><m>6</m></cell>
              <cell><m>2.47062849869924</m></cell>
            </row>
            <row>
              <cell><m>7</m></cell>
              <cell><m>2.39789332147854</m></cell>
            </row>
            <row>
              <cell><m>8</m></cell>
              <cell><m>2.44938730115809</m></cell>
            </row>
            <row>
              <cell><m>9</m></cell>
              <cell><m>2.41369700737469</m></cell>
            </row>
            <row>
              <cell><m>10</m></cell>
              <cell><m>2.43882864952499</m></cell>
            </row>
            <row>
              <cell><m>11</m></cell>
              <cell><m>2.42131772649675</m></cell>
            </row>
            <row>
              <cell><m>12</m></cell>
              <cell><m>2.43361218868805</m></cell>
            </row>
            <row>
              <cell><m>13</m></cell>
              <cell><m>2.42502511000601</m></cell>
            </row>
            <row>
              <cell><m>14</m></cell>
              <cell><m>2.43104504810447</m></cell>
            </row>
            <row>
              <cell><m>15</m></cell>
              <cell><m>2.42683561174279</m></cell>
            </row>
            <row>
              <cell><m>16</m></cell>
              <cell><m>2.42978439120944</m></cell>
            </row>
            <row>
              <cell><m>17</m></cell>
              <cell><m>2.42772132482997</m></cell>
            </row>
            <row>
              <cell><m>18</m></cell>
              <cell><m>2.42916599531699</m></cell>
            </row>
            <row>
              <cell><m>19</m></cell>
              <cell><m>2.42815498439281</m></cell>
            </row>
            <row>
              <cell><m>20</m></cell>
              <cell><m>2.42886281809844</m></cell>
            </row>
          </tabular>
          <image xml:id="fig-demo-sequence-limits-2">
            <latex-image>
            <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
            <![CDATA[\tikzset{%
            }
            \begin{tikzpicture}
              \begin{axis}[
                xlabel={$n$}, ylabel={$x_n$},
                ymajorgrids,
              ]
              \addplot[blue, only marks] coordinates {
                (0, 1.00000000000000)
                (1, 2.00000000000000)
                (2, 2.60000000000000)
                (3, 2.28800000000000)
                (4, 2.51313920000000)
                (5, 2.36436779299635)
                (6, 2.47062849869924)
                (7, 2.39789332147854)
                (8, 2.44938730115809)
                (9, 2.41369700737469)
                (10, 2.43882864952499)
                (11, 2.42131772649675)
                (12, 2.43361218868805)
                (13, 2.42502511000601)
                (14, 2.43104504810447)
                (15, 2.42683561174279)
                (16, 2.42978439120944)
                (17, 2.42772132482997)
                (18, 2.42916599531699)
                (19, 2.42815498439281)
                (20, 2.42886281809844)
              };
              \end{axis}
            \end{tikzpicture}]]>
            </latex-image>
          </image>
        </sidebyside>
        <p>
          Graphically, you should see that the plot shows the sequence values appears to level off to a single value. 
          However, the graph also shows that the values are alternately above and below that limit. 
          We look in the table to determine the limiting value, 
          but it is not obvious from the table what the limiting value should be. 
          Because the values are alternately above and then below whatever the limit should be, 
          we can conclude that the limit must be between the last two values listed.
        </p>
        <p>
          The limit is approximately 2.428 but we do not know the next decimal place 
          without computing more values in the sequence. 
          With additional computation (not shown), 
          we find <m>z_{39} = 2.42857109636261</m> and <m>z_{40} = 2.42857166111753</m> 
          so that our approximation for the limit (a value between <m>z_{39}</m> and <m>z_{40}</m>)
          can be estimated as close to 2.428571,
          <me> \lim_{n \to \infty} z_n \approx 2.428571 </me>.
          To find a better approximation using data would require more computation.
        </p>
        <p>
          Because the sequence is defined recursively,
          the limit will be a fixed point of the projection function.
          If we solve the fixed point equation, we can find the exact value of the limit.
          <md>
            <mrow>2.7x - 0.7x^2 = x</mrow>
            <mrow>1.7x - 0.7x^2 = 0</mrow>
            <mrow>x(1.7 - 0.7x) = 0</mrow>
          </md>
          The factored equation indicates there are two fixed points: <m>x=0</m> and <m>x=\frac{17}{7}</m>.
          The decimal approximation for <m>x=\frac{17}{7}</m> is 2.4285714286,
          which is precisely where our sequence is converging,
          <me>\lim_{n \to \infty} z_n = \frac{17}{7}</me>.
        </p>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>The Definition of a Limit</title>
    <p>
      With these examples, we can introduce the mathematical definition for the limit of a sequence.
      The idea of a limit <m>x_n \to L</m> is that the value of the sequence <m>x_n</m> 
      approximates the value of <m>L</m> closer and closer as <m>n</m> increases.
      Recall that we measure the quality of approximation using the error of approximation, <m>|x_n - L|</m>.
      The sequence successfully approximates the limit <m>L</m> 
      if the error eventually become smaller than any desired accuracy of approximation.
    </p>
    <definition xml:id="defn-sequence-limit">
      <title>Limit of a Sequence</title>
      <statement>
        <p>
          For a real number <m>L</m>, a sequence <m>x</m> has a limit <m>L</m>
          if for any desired accuracy of approximation <m>\epsilon \gt 0</m>, 
          the error of approximation is eventually <m>|x_n - L| \lt \epsilon</m>
          and we write <me>\displaystyle \lim_{n \to \infty} x_n = L \quad \text{or} \quad x_n \to L</me>.
          This means that for every <m>\epsilon \gt 0</m>, there is a threshold index <m>N</m> 
          so that <m>|x_n-L| \lt \epsilon</m> whenever <m>n \gt N</m>.
          <notation>
            <usage>\lim_{n \to \infty} x_n = L</usage>
            <description>sequence <m>x_n</m> has limit <m>L</m></description>
          </notation>
          <notation>
            <usage>x_n \to L</usage>
            <description>sequence <m>x_n</m> has limit <m>L</m></description>
          </notation>
        </p>
      </statement>
    </definition>
    <p>
      In most cases, verifying the definition directly will be too challenging.
      We will usually learn to apply rules that guarantee that this definition will be satisfied
      rather than directly show that the approximation rule is satisfied.
      However, for sequences defined by sufficiently simple explicit formulas,
      we can determine how far down the table we would need to go to reach a desired accuracy.
      In these cases, we use strategies for solving inequalities to find the interval of integers
      where the error of approximation is sufficiently small.
    </p>
    <example>
      <statement>
        <p>
          Consider the sequence <m>\displaystyle x_n = \frac{n}{2n+1}</m>, for <m>n=0,1,2,\ldots</m>.
          Find numerical evidence that <m>\displaystyle \lim_{n \to \infty} x_n = \frac{1}{2}</m>.
          Then determine the index threshold <m>N</m> so that <m>|x_n - \frac{1}{2}| \lt 0.001</m> for index values <m>n \gt N</m>.
        </p>
      </statement>
      <solution>
      <p>
        Using the following simple Sage script, we can generate a plot and table quickly.
        This script includes some modifications so that only a portion of the table is printed.
        We also have modified the format code to include more decimal values.
      </p>
      <sage>
        <input>
        # What range of index values to plot
        lastIndex = 100
        # Which values in the calculation to show?
        # Some at the beginning
        showFirst = 10
        # Some at the end
        showLast = 10

        # Calculate the table for plotting
        data = []
        for n in range(lastIndex+1):
            xn = n/(2*n+1)
            data.append( [n,xn] )
        graph = list_plot(data, frame=True, axes_labels=["n", "x_n"])
        show(graph)

        # Display beginning of the table
        for i in range(showFirst):
            # data is a list of points, so data[i] = [n,xn]
            [n,xn] = data[i]
            print("%d\t%,8f" % (n,xn))
        # Print a break-line to show there are missing terms
        print("...")
        # Display end of the table
        for i in range(lastIndex-showLast,lastIndex+1):
            # data is a list of points, so data[i] = [n,xn]
            [n,xn] = data[i]
            print("%d\t%.8f" % (n,xn))
        </input>
        <output>
        0      0.00000000
        1      0.33333333
        2      0.40000000
        3      0.42857143
        4      0.44444444
        5      0.45454545
        6      0.46153846
        7      0.46666667
        8      0.47058824
        9      0.47368421
        ...
        90     0.49723757
        91     0.49726776
        92     0.49729730
        93     0.49732620
        94     0.49735450
        95     0.49738220
        96     0.49740933
        97     0.49743590
        98     0.49746193
        99     0.49748744
        100    0.49751244
        </output>
      </sage>
      <p>
        It appears that the sequence is leveling out to a value near 0.5.
        However, at index <m>n=100</m>, the value is at approximately 
        <m>x_{100} \approx 0.49751244</m> (8 decimal places).
        If the limit really is <m>x_n \to 0.5</m>, then the error of approximation for <m>n=100</m> is
        <me>|x_{100}-0.5| \approx 0.00248756</me>.
        We need to ensure that the error continues to go down.
        At index <m>n=1000</m> (by modifying the script and running again), we have 
        <m>x_{1000} \approx 0.49975012</m> with an error of approximation
        <me>|x_{1000}-0.5| \approx 0.00024988</me>.
      </p>
      <p>
        The explicit formula for the sequence uses the function <m>\displaystyle f(n)=\frac{n}{2n+1}</m> for integer values of <m>n</m>.
        We can think of the mapping <m>n \overset{f}\mapsto x</m> for arbitrary values of <m>n</m> and not just integers.
        The inverse <m>f^{-1}: x \mapsto n</m> can inform us of when the sequence passes different values.
        We solve for <m>n</m> as the dependent variable.
        <md>
          <mrow>x = \frac{n}{2n+1}</mrow>
          <mrow>(2n+1)x = n </mrow>
          <mrow>2n x + x = n</mrow>
          <mrow>2n x - n = -x</mrow>
          <mrow>(2x-1) n = -x</mrow>
          <mrow>n = \frac{-x}{2x-1} = \frac{x}{1-2x}</mrow>
        </md>
        This function, <m>\displaystyle f^{-1}(x)=\frac{x}{1-2x}</m>, gives the relation <m>x \mapsto n</m>.
      </p>
      <p>
        From our graph, we have seen that <m>(n,x_n)</m> is increasing and concave down.
        The sequence will always be below the limit.
        Given <em>any</em> desired error of approximation <m>\epsilon \gt 0</m>, 
        we can use our inverse function to see exactly when the sequence rises above <m>x_n \gt \frac{1}{2}-\epsilon</m>.
        For example, with <m>\epsilon = 0.001</m>, we want to find when <m>x_n \gt 0.5-0.001=0.499</m>.
        We find <me>f^{-1}(0.499) = \frac{0.499}{1-2(0.499)} =249.5</me>.
        The sequence, which requires integer index values, will therefore 
        be above <m>x_n \gt 0.499</m> for <m>n \ge 250</m>.
        In the definition of a limit, this corresponds to an index threshold <m>N=249</m> for accuracy <m>\epsilon=0.001</m>.
      </p>
      <p>
        We can verify this numerically by running the script to show a table and graph for index values surrounding <m>n=250</m>.
        The table and graph show that the sequence value is below 0.499 for <m>n \le 249</m>
        and above 0.499 for <m>n \ge 250</m>, agreeing with our calculation.
      </p>
      <sidebyside widths="30% 60%">
        <tabular>
          <row bottom="major"><cell><m>n</m></cell><cell><m>x_n</m></cell></row>
          <row><cell>235</cell><cell>0.49893843</cell></row>
          <row><cell>236</cell><cell>0.49894292</cell></row>
          <row><cell>237</cell><cell>0.49894737</cell></row>
          <row><cell>238</cell><cell>0.49895178</cell></row>
          <row><cell>239</cell><cell>0.49895616</cell></row>
          <row><cell>240</cell><cell>0.49896050</cell></row>
          <row><cell>241</cell><cell>0.49896480</cell></row>
          <row><cell>242</cell><cell>0.49896907</cell></row>
          <row><cell>243</cell><cell>0.49897331</cell></row>
          <row><cell>244</cell><cell>0.49897751</cell></row>
          <row><cell>245</cell><cell>0.49898167</cell></row>
          <row><cell>246</cell><cell>0.49898580</cell></row>
          <row><cell>247</cell><cell>0.49898990</cell></row>
          <row><cell>248</cell><cell>0.49899396</cell></row>
          <row><cell>249</cell><cell>0.49899800</cell></row>
          <row><cell>250</cell><cell>0.49900200</cell></row>
          <row><cell>251</cell><cell>0.49900596</cell></row>
          <row><cell>252</cell><cell>0.49900990</cell></row>
          <row><cell>253</cell><cell>0.49901381</cell></row>
          <row><cell>254</cell><cell>0.49901768</cell></row>
          <row><cell>255</cell><cell>0.49902153</cell></row>
        </tabular>
        <image>
          <latex-image>
          <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
          <![CDATA[\tikzset{%
          }
          \begin{tikzpicture}
            \begin{axis}[
              width=4in, height=2.5in,
              ymin=0.4988, ymax=0.4991,
              xmin=234.5, xmax=255.5,
              xlabel={$n$}, ylabel={$x_n$},
              yticklabel style = 
                {
                  /pgf/number format/.cd,
                  fixed,
                  precision=4,
                  /tikz/.cd,
                },
              ymajorgrids,
            ]
            \addplot [samples=2, dashed] {0.499};
            \addplot[blue, only marks] coordinates {
              (235, 0.49893843)
              (236, 0.49894292)
              (237, 0.49894737)
              (238, 0.49895178)
              (239, 0.49895616)
              (240, 0.49896050)
              (241, 0.49896480)
              (242, 0.49896907)
              (243, 0.49897331)
              (244, 0.49897751)
              (245, 0.49898167)
              (246, 0.49898580)
              (247, 0.49898990)
              (248, 0.49899396)
              (249, 0.49899800)
              (250, 0.49900200)
              (251, 0.49900596)
              (252, 0.49900990)
              (253, 0.49901381)
              (254, 0.49901768)
              (255, 0.49902153)
                        };
            \end{axis}
          \end{tikzpicture}]]>
          </latex-image>
        </image>
      </sidebyside>
      <p>
        The inverse function, <m>\displaystyle f^{-1}(x)=\frac{x}{1-2x}</m>, is undefined for <m>x=\frac{1}{2}</m>.
        For values <m>x \gt \frac{1}{2}</m>, we will have negative values for <m>n</m>, <m>f^{-1}(x) \lt 0</m>.
        The sequence therefore will never reach or surpass the value <m>x=\frac{1}{2}</m>.
        But we will be able to identify when the function rises above every value below <m>x=\frac{1}{2}</m>.
        This is how we <em>know</em> that 
        <me>\lim_{n \to \infty}x_n = \frac{1}{2}.</me>
      </p>
    </example>
  </subsection>
  <subsection>
    <title>Summary</title>
    
    <p>
    <ul>
      <li>
        <p>
          A sequence has a limit, <m>x_n \to L</m>, if the values of the sequence 
          get closer and closer to the value of <m>L</m>.
          The graph of the sequence <m>(n,x_n)</m> approaches a horizontal line <m>x=L</m>.
        </p>
      </li>
      <li>
        <p>
          If <m>x_n \to L</m>, then a table of values for the sequence <m>x</m>
          should have decimal approximations that converge to the decimal approximation of <m>L</m>.
        </p>
      </li>
      <li>
        <p>
          Sequences defined recursively using a continuous projection function <m>f</m>
          can only have limits that are fixed points of <m>f</m>. 
          (See <xref ref="thm-recursive-limit-fixed-point"/>)
        </p>
      </li>
      <li>
        <p>
          The formal definition of a sequence limit <m>x_n \to L</m>, written
          <me>\displaystyle \lim_{n \to \infty} x_n = L</me>,
          is that for any desired threshold of approximation error <m>\epsilon \gt 0</m>, 
          there is an index threshold <m>N</m> so that <m>|x_n - L| \lt \epsilon</m> whenever <m>n \gt N</m>.
          (See <xref ref="defn-sequence-limit"/>)
        </p>
      </li>
    </ul>
    </p>
  </subsection>
  <exercises>
    <exercisegroup>
      <introduction>
        <p>
        Use a computer-generated table to approximate the limit of the following sequences
        to at least four decimal places. If the limit does not exists, state why.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_n = \sqrt{n} \cdot (\sqrt{3n+1} - \sqrt{3n})</m>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_n = n \cdot (\sqrt{3n+1} - \sqrt{3n})</m>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_n = \left(1+\frac{1}{3n}\right)^n</m>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_n = n^2 \cdot \left(\frac{1}{4n+5}-\frac{1}{4n}\right)</m>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_{n+1} = \frac{x_n}{5} + \frac{2}{x_n}</m> with <m>x_0 = 2</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_{n+1} = \frac{x_n}{5} - \frac{2}{x_n}</m> with <m>x_0 = 2</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_{n+1} = 5x_n e^{-x_n}</m> with <m>x_0 = 0.5</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle x_{n+1} = 8x_n e^{-x_n/3}</m> with <m>x_0 = 0.5</m>.
          </p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
        For each of the following functions, find all fixed points.
        Then, using a sequence defined recursively <m>x_{n} = f(x_{n-1})</m> and the given initial value, 
        test if the sequence has a limit and give its exact value.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>
          <m>f(x) = 1.3 x + 12</m>; <m>x_0=1</m>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>f(x) = 0.8 x + 6</m>; <m>x_0=5</m>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>f(x) = 1.2x - 0.04x^2</m>; <m>x_0=3</m>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          <m>\displaystyle f(x) = \frac{4x}{1+x^2}</m>; <m>x_0=3</m>
          </p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
          For each of the following sequences, explore the definition of a limit
          by finding the index threshold associated with the approximation error threshold.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>
          The sequence <m>x_n = \frac{1}{2n+1}</m> has a limit <m>x_n \to 0</m>.
          For <m>\epsilon = 0.01</m>, find <m>N</m> 
          so that <m>|x_n-0| \lt \epsilon</m> for <m>n \gt N</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          The sequence <m>x_n = \frac{n}{2n+1}</m> has a limit <m>x_n \to \frac{1}{2}</m>.
          For <m>\epsilon = 0.01</m>, find <m>N</m> 
          so that <m>|x_n-\frac{1}{2}| \lt \epsilon</m> for <m>n \gt N</m>.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
          The sequence <m>x_n = \left(-\frac{2}{3}\right)^n</m> has a limit <m>x_n \to 0</m>.
          For <m>\epsilon = 0.01</m>, find <m>N</m> 
          so that <m>|x_n-0| \lt \epsilon</m> for <m>n \gt N</m>.
          </p>
        </statement>
      </exercise>
    </exercisegroup>
  </exercises>
 </section>