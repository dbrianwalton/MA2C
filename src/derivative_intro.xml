<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2015-2018  D. Brian Walton     -->
<!-- See the file COPYING for copying conditions. -->

<section xml:id="derivative_intro">
  <title>Instantaneous Rate of Change</title>
  <subsection>
    <title>Overview</title>
    <p>
      Accumulation functions are defined in terms of their rate of accumulation.
      That is, we started by knowing the rate of accumulation <m>f'(x)</m>
      and used that rate and an initial value to create the accumulation function
      <me>f(x) = f(a) + \int_a^{x} f'(z) \, dz</me>.
      Thus far, we only know a few elementary accumulation formulas for simple polynomials.
      What about other functions?
    </p>
    <p>
      Perhaps the biggest breakthrough in the historical development of calculus
      was the recognition of a relationship between accumulation computed through definite integrals
      and the rate of change computed through derivatives.
      A definite integral represents the exact accumulation for a given rate
      as the independent variable goes between two points.
      A Riemann sum approximates this accumulation by summing increments
      that treat the rate of accumulation as if constant over short intervals.
      The definite integral is equal to the limit of the Riemann sums.
    </p>
    <p>
      In this section, we introduce the derivative of a function.
      The derivative represents the instantaneous rate of change at a single point.
      We will introduce the average rate of change between two points.
      The average rate of change approximates the instantaneous rate of change
      when the two points are close together.
      The derivative will then equal the limit of the average rate of change.
    </p>
  </subsection>
  <subsection>
    <title>Slope and the Average Rate of Change</title>
    <p>
      Consider the point<ndash/>slope equation of a line
      <me> y-b = m(x-a)</me>,
      which is the equation of a line with slope <m>m</m> and passing through a point <m>(a,b)</m>.
      When we solve for <m>y</m>, so that <m>y</m> is a function of <m>x</m>,
      <me> y = f(x) = b + m(x-a)</me>,
      we can recognize that this is in the form of an accumulation function with constant rate,
      <me>f(x) = b + \int_a^x m \, dx</me>.
      That is, the slope acts as the rate of accumulation.
    </p>
    <p>
      The slope of a line also represents a rate of change, meaning a ratio of covarying changes.
      Given two points on the line, <m>(x_1,y_1)</m> and <m>(x_2,y_2)</m>,
      the slope is defined by the ratio
      <me> m = \frac{\Delta y}{\Delta x} = \frac{y_2-y_1}{x_2-x_1}</me>.
      If we think of the point <m>f(a)=b</m> as the initial value for <m>f(x)</m>,
      then the increment of change for <m>f</m> defined by
      <me> \Delta f = f(x) - f(a) </me>
      will always be proportional to the change in the input
      <me> \Delta x = x-a. </me>
      The slope is the proportionality constant representing this constant ratio of the changes, or rate of change.
    </p>
    <p>
      Only in the case of a linear function do we actually find that
      the rate of change <m>\Delta f / \Delta x</m> is a constant.
      When the rate of change varies, the value of the rate of change depends on the interval chosen.
      We call this the <term>average rate of change</term>.
    </p>
    <definition xml:id='defn-average-rate-of-change'>
      <statement>
        <p>
          The <term>average rate of change</term> of a function <m>f(x)</m>
          going from <m>a</m> to <m>b</m> is defined as the ratio
          <me>\left. \frac{\Delta f}{\Delta x} \right|_{a,b} = \frac{f(b)-f(a)}{b-a}</me>.
        </p>
      </statement>
    </definition>
    <p>
      The average rate of change is equal to the slope of the line that joins the two points <m>(a,f(a))</m> and <m>(b,f(b))</m>.
      That line is called the <term>secant line</term>.
      The order of the points for the average rate of change does not matter.
      <md>
        <mrow>\left. \frac{\Delta f}{\Delta x} \right|_{b,a} &amp;= \frac{f(a)-f(b)}{a-b}</mrow>
        <mrow> &amp;= \frac{-(f(b)-f(a))}{-(b-a)} </mrow>
        <mrow> &amp;= \frac{f(b)-f(a)}{b-a} </mrow>
        <mrow> &amp;= \left. \frac{\Delta f}{\Delta x} \right|_{b,a} </mrow>
      </md>
      Consequently, we often just refer to calculating the average rate of change over an interval <m>[a,b]</m>.
    </p>
    <example xml:id="ex-ave-rate-cubic">
      <statement>
        <p>
          Find the average rate of change of <m>f(x)=x^3-4x</m> over the interval <m>[1,2]</m>.
        </p>
      </statement>
      <solution>
        <p>
          The average rate of change is the slope of the line joining the points <m>(1,f(1))</m> and <m>(2,f(2))</m>.
          So we first need to calculate the function values:
          <me> f(1) = (1)^3-4(1) = -3; \qquad f(2)=(2)^3-4(2) = 0. </me>
          This allows us to compute the average rate of change:
          <me> \left. \frac{\Delta f}{\Delta x} \right|_{1,2} = \frac{f(2)-f(1)}{2-1} = \frac{0--3}{1} = 3</me>.
        </p>
      </solution>
    </example>
    <p>
      A rate of change for a physical quantity has units corresponding to the ratio it describes.
      One of the most common examples is calculating the velocity of an object.
      Velocity measures the distance traveled per unit time,
      which means velocity is the rate of change of position with respect to time.
      How would we compute a velocity?
      Measure the position of the object at two times,
      measure how much the position changed,
      and divide by the amount of time that passed.
      The average velocity is the ratio of the change in position over the change in time.
    </p>
    <example>
      <statement>
        <p>
          If the position (height, in feet) of an object above the ground is defined by the function of time (in seconds)
          <me>h(t) = 5+64t-16t^2</me>,
          then what is the average velocity over the interval <m>[1,4]</m>?
        </p>
        <image>
          <description>
          Graph of y=x^2.
          </description>
          <latex-image>
          <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
          <![CDATA[\tikzset{%
          /pgfplots/table/row sep=crcr
          }
          \begin{tikzpicture}
          \begin{axis}[
              xmin=0,xmax=4.5,
              ymin=0,ymax=70,
              xlabel={$t$},
              ylabel={$h$},
          ]
          \addplot[blue, thick, samples=100]
              ({x}, {5+64*x-16*x^2});
          \addplot[red, samples=10]
              ({x}, {53-16*(x-1)});
          \addplot[only marks, blue] table {
            1 53\\
            4 5\\
          };
          \addplot[mark=none, black] {0};
          \end{axis}
          \end{tikzpicture}]]>
          </latex-image>
        </image>
      </statement>
      <solution>
        <p>
          The average velocity is the slope of the line joining the points <m>(1,h(1))</m> and <m>(4,h(4))</m>.
          So we first need to calculate the function values which gives the two positions:
          <me> h(1) = 5+64(1)-16(1)^2 = 53; \qquad f(4)=5+64(4)-16(4)^2=5. </me>
          This allows us to compute the average velocity as an average rate of change:
          <me> \left. \frac{\Delta h}{\Delta t} \right|_{[1,4]} = \frac{h(4)-h(1)}{4-1} = \frac{5-53}{3} = \frac{-48}{3} = -16</me>.
          So the average velocity is -16 ft/s, since the height dropped by 48 feet during those 3 seconds.
        </p>
      </solution>
    </example>
    <p>
      In the previous example,the graph of the height of the object as a function of time
      shows that the ball was initially going up and then came down.
      However, the average rate of change calculated gave a negative rate.
      Over the three minutes in the interval,
      the ball started going up and then fell enough so that the overall change was negative.
      If we wanted to know the speed of the object when <m>t=1</m>,
      this interval is much too large to provide a good approximation.
    </p>
  </subsection>
  <subsection>
    <title>Instantaneous Rate of Change</title>
    <p>
      The instantaneous rate of change of a function is the rate of change at a particular point.
      When we think about a rate of change as representing a slope,
      our existing strategies require knowing two different points to compute a slope.
      We expect that the average rate of change between two points should approximate the instantaneous rate of change
      if the increment <m>\Delta x</m> is not too big.
      Further, we expect that the approximation should improve by making <m>\Delta x</m> smaller.
    </p>
    <p>
      The figure below is an interactive graph of <m>f(x) = x^3-4x</m>
      showing one point at <m>x=1</m> and a second point at <m>x=1+h</m>
      where the value of <m>h</m> is controlled by a slider.
      The average rate of change and slope of the secant line between these two points is also calculated.
      Notice that when <m>h</m> is close to zero, <m>h \approx 0</m>,
      the secant line is closer and closer to a tangent line.
    </p>
    <figure>
      <caption/>
        <jsxgraph xml:id="deriv-intro-sliding-secant-ex1">
            <input>
            <![CDATA[// Put variables in object to isolate.
            jsx1 = { a:1 };
            jsx1.f = function(x) { return x*(x*x-4); };
            jsx1.board = JXG.JSXGraph.initBoard('deriv-intro-sliding-secant-ex1', {boundingbox: [-3, 4, 3, -4], axis:true, showNavigation:false});
            jsx1.graph = jsx1.board.create('functiongraph',
                [jsx1.f], {strokeColor:'blue', strokeWidth:2});
            jsx1.h = jsx1.board.create('slider',
                [[0.2,-3.5],[2.4,-3.5],[-1.5,1,1.5]],{name:'h', snapWidth:0.01, precision:2});
            jsx1.aPt = jsx1.board.create('point',
                [ jsx1.a, jsx1.f(jsx1.a) ],
                {fixed:true, label:"$x=1$"}
                );
            jsx1.bPt = jsx1.board.create('point',
                [ function(){ return jsx1.a+jsx1.h.Value(); },
                    function(){ return jsx1.f(jsx1.a+jsx1.h.Value());} ],
                {label:"$x=1+h$"}
                );
            jsx1.secant = jsx1.board.create('line',
                [jsx1.aPt, jsx1.bPt]);
            jsx1.diffQuotText = jsx1.board.create('text',
                [-1.5, -3, "\\\\(\\\\displaystyle \\\\frac{\\\\Delta f}{\\\\Delta x} = \\\\)"],
                {anchorX:'right'});
            jsx1.slopeText = jsx1.board.create('text',
                [-1.4, -2.9, function() {
                    var slope = (jsx1.bPt.Y()-jsx1.aPt.Y())/(jsx1.bPt.X()-jsx1.aPt.X());
                    return slope.toFixed(5);
                    }
                ], {anchorX:'left'});
            ]]>
            </input>
        </jsxgraph>
    </figure>
    <p>
      Graphically, the instantaneous rate of change equals the slope of the tangent line at the point.
      A tangent line is defined in terms of a single point such that the line is the line
      that best approximates the function near that point.
      We define the instantaneous rate of change, or the derivative at a point, as a limit of the average rate of change.
    </p>
    <definition xml:id='defn-instantaneous-rate-of-change'>
      <statement>
        <p>
          The <term>instantaneous rate of change</term> of a function <m>f(x)</m> at <m>x=a</m> is
          the derivative at the point and is defined as the limit of the average rate of change
          when the width of the interval is made arbitrarily small:
          <me> \left. \frac{df}{dx} \right|_{a} = \lim_{h \to 0} \frac{f(a+h)-f(a)}{h} </me>
          or
          <me> \left. \frac{df}{dx} \right|_{a} = \lim_{x \to a} \frac{f(x)-f(a)}{x-a} </me>
        </p>
      </statement>
    </definition>
    <p>
      The limits defining the instantaneous rate of change or derivative, when they exist,
      represent the limiting value of the average rate of change for a sequence of points <m>x_n</m> that converge to <m>a</m>, <m>x_n \to a</m>.
      The first limit using <m>h</m> defines this sequence as <m>x_n = a + h_n</m> where <m>h_n \to 0</m>.
      That is, <m>h</m> represents the value of <m>\Delta x</m>.
      This suggests defining the average rate of change in terms of a reference point <m>a</m> and the displacement <m>h</m> to the second point,
      <me>\left. \frac{\Delta f}{\Delta x} \right|_{a; h} = \frac{f(a+h)-f(a)}{h}.</me>
      The derivative is the limit of this average rate of change as <m>h \to 0</m>.
      For the limit to exist, the limit value of the average rate of change can not depend on which sequence we choose.
      We explore the definition by considering an example.
    </p>
    <example>
      <statement>
        <p>
          Find the instantaneous rate of change of <m>f(x) = x^3-4x</m> at 1.
        </p>
      </statement>
      <solution>
        <p>
          In the <xref ref="ex-ave-rate-cubic" text="title">earlier example</xref>,
          we found the average rate of change of <m>f</m> on the interval <m>[1,2]</m>:
          <me> \left. \frac{\Delta f}{\Delta x}\right|_{[1,2]} = 3.</me>
          The width of this interval was <m>h = \Delta x = 2-1 = 1</m>.
          We need to consider a sequence of intervals that include <m>x=1</m>
          but have a width that is decreasing to zero.
          The following list of intervals is the start of one possible sequence.
          <me>[1,2], \: [1,1.1], \: [1,1.01], \: [1,1.001], \: \ldots </me>
        </p>
        <p>
          To make this calculation more manageable,
          it is sometimes easier to create an entry in a table that shows the value of the function
          at the second point that is needed to compute a slope.
          The table only shows the summary information.
          The average rate of change for each intervals was computed using the definition
          <me> \left. \frac{\Delta f}{\Delta x} \right|_{[1, x_n]} = \frac{f(x_n)--3}{h}</me>
          where <m>h=b_k-1</m>.
        </p>
        <table xml:id="table-instant-rate-ex-1">
          <tabular top="major" halign="center">
            <row bottom="minor">
              <cell><m>n</m></cell>
              <cell><m>[1, x_n]</m></cell>
              <cell><m>h=\Delta x</m></cell>
              <cell><m>x_n</m></cell>
              <cell><m>f(x_n)</m></cell>
              <cell><m>\displaystyle \left. \frac{\Delta f}{\Delta x} \right|_{[1, x_n]}</m></cell>
            </row>
            <row>
              <cell>1</cell>
              <cell><m>[1,2]</m></cell>
              <cell><m>1</m></cell>
              <cell><m>2</m></cell>
              <cell><m>0</m></cell>
              <cell><m>3</m></cell>
            </row>
            <row>
              <cell>2</cell>
              <cell><m>[1,1.1]</m></cell>
              <cell><m>0.1</m></cell>
              <cell><m>1.1</m></cell>
              <cell><m>-3.069</m></cell>
              <cell><m>-0.69</m></cell>
            </row>
            <row>
              <cell>3</cell>
              <cell><m>[1,1.01]</m></cell>
              <cell><m>0.01</m></cell>
              <cell><m>1.01</m></cell>
              <cell><m>-3.009699</m></cell>
              <cell><m>-0.9699</m></cell>
            </row>
            <row bottom="major">
              <cell>4</cell>
              <cell><m>[1,1.001]</m></cell>
              <cell><m>0.001</m></cell>
              <cell><m>1.001</m></cell>
              <cell><m>-3.000996999</m></cell>
              <cell><m>-0.996999</m></cell>
            </row>
          </tabular>
          <caption>Illustration of using shrinking intervals to estimate the
          instantaneous rate of change.</caption>
        </table>
        <p>
          From this table, we can see that the spacing between the points <m>h</m> is approaching zero
          as the second point in the interval is approaching the point in question.
          As this happens, the sequence of values representing the average rate of change on these intervals
          appears to be approaching the value of -1.
          From the table, we would estimate that this is the instantaneous rate of change:
          <me> \left. \frac{df}{dx} \right|_{1} \approx -1. </me>
        </p>
      </solution>
    </example>
    <p>
      In the previous example, the limit of the average rate of change was an easily recognized value because it was an integer.
      When using a table and the limit is not an integer, you need to look for a decimal value that is approximated.
      This often works better if we consider a sequence of intervals on both sides of the point of interest
      and use the average of the two sides.
    </p>
    <example>
      <statement>
        <p>
          Find the instantaneous rate of change of <m>f(x) = 3^x</m> at 1.
        </p>
      </statement>
      <solution>
        <p>We will create two sequences of decreasing width intervals, one on the left and the other on the right of 1. This will allow us to more easily recognize the decimal representation of the limiting value. In addition, we will use a variable <m>h</m> to represent the offset from 1 to the other endpoint of the interval. One sequence will involve negative values of <m>h</m> (on the left) and the other will involve positive values of <m>h</m> (on the right). Notice how in these tables, we require more decimal places for the value of <m>f(1+h)</m> in order to obtain the average rate of change to the same number of significant digits.</p>
        <table xml:id="table-instant-rate-ex-2a">
          <tabular top="major" halign="center">
            <row bottom="minor">
              <cell><m>h</m></cell>
              <cell><m>f(1+h)</m></cell>
              <cell><m>f(1)</m></cell>
              <cell><m>\Delta f</m></cell>
              <cell><m>\displaystyle \left. \frac{\Delta f}{\Delta x} \right|_{1; h}</m></cell>
            </row>
            <row>
              <cell>-0.1</cell>
              <cell>2.68788</cell>
              <cell>3</cell>
              <cell>-0.31212</cell>
              <cell>3.1212</cell>
            </row>
            <row>
              <cell>-0.01</cell>
              <cell>2.967222</cell>
              <cell>3</cell>
              <cell>-0.032778</cell>
              <cell>3.2778</cell>
            </row>
            <row bottom="major">
              <cell>-0.001</cell>
              <cell>2.9967160</cell>
              <cell>3</cell>
              <cell>-0.0032940</cell>
              <cell>3.2940</cell>
            </row>
          </tabular>
          <caption>
            Illustration of using shrinking intervals on the left to estimate the instantaneous rate of change.
          </caption>
        </table>
        <table xml:id="table-instant-rate-ex-2b">
          <tabular top="major" halign="center">
            <row bottom="minor">
              <cell><m>h</m></cell>
              <cell><m>f(1+h)</m></cell>
              <cell><m>f(1)</m></cell>
              <cell><m>\Delta f</m></cell>
              <cell><m>\displaystyle \left. \frac{\Delta f}{\Delta x} \right|_{1; h}</m></cell>
            </row>
            <row>
              <cell>0.1</cell>
              <cell>3.34837</cell>
              <cell>3</cell>
              <cell>0.34837</cell>
              <cell>3.4837</cell>
            </row>
            <row>
              <cell>0.01</cell>
              <cell>3.033140</cell>
              <cell>3</cell>
              <cell>0.033140</cell>
              <cell>3.3140</cell>
            </row>
            <row bottom="major">
              <cell>0.001</cell>
              <cell>3.0032976</cell>
              <cell>3</cell>
              <cell>0.0032976</cell>
              <cell>3.2976</cell>
            </row>
          </tabular>
          <caption>
            Illustration of using shrinking intervals on the right to estimate the instantaneous rate of change.
          </caption>
        </table>
        <p>
          Looking at the columns for the average rate of change in these two tables,
          we notice that the values are rising when <m>h \lt 0</m> as the size of the interval shrinks
          but that the values are dropping when <m>h \gt 0</m>.
          The limiting value should therefore be somewhere between 3.2940 and 3.2976.
          The average of these values gives an even better approximation,
          <me> \left. \frac{df}{dx} \right|_{1} \approx 3.2958. </me>
        </p>
      </solution>
    </example>
    <p>A dynamic graph of this calculation is illustrated below.</p>
    <figure>
      <caption/>
        <jsxgraph xml:id="deriv-intro-sliding-secant-ex2">
            <input>
            <![CDATA[// Put variables in object to isolate.
            jsx2 = { a:1 };
            jsx2.f = function(x) { return Math.exp(x*Math.log(3)); };
            jsx2.board = JXG.JSXGraph.initBoard('deriv-intro-sliding-secant-ex2', {boundingbox: [-3, 10, 3, -1], axis:true, showNavigation:false});
            jsx2.graph = jsx2.board.create('functiongraph',
                [jsx2.f], {strokeColor:'blue', strokeWidth:2});
            jsx2.h = jsx2.board.create('slider',
                [[0.2,0.5],[2,0.5],[-1.5,1,1.5]],{name:'h', snapWidth:0.01, precision:2});
            jsx2.aPt = jsx2.board.create('point',
                [ jsx2.a, jsx2.f(jsx2.a) ],
                {fixed:true, label:"$x=1$"}
                );
            jsx2.bPt = jsx2.board.create('point',
                [ function(){ return jsx2.a+jsx2.h.Value(); },
                    function(){ return jsx2.f(jsx2.a+jsx2.h.Value());} ],
                {label:"$x=1+h$"}
                );
            jsx2.secant = jsx2.board.create('line',
                [jsx2.aPt, jsx2.bPt]);
            jsx2.diffQuotText = jsx2.board.create('text',
                [-1.5, 1, "\\\\(\\\\displaystyle \\\\frac{\\\\Delta f}{\\\\Delta x} = \\\\)"],
                {anchorX:'right'});
            jsx2.slopeText = jsx2.board.create('text',
                [-1.4, 1.1, function() {
                    var slope = (jsx2.bPt.Y()-jsx2.aPt.Y())/(jsx2.bPt.X()-jsx2.aPt.X());
                    return slope.toFixed(5);
                    }
                ], {anchorX:'left'});
            ]]>
            </input>
        </jsxgraph>
    </figure>
  </subsection>
  <subsection>
    <title>Using Algebra for Rates of Change</title>
    <p>
      In the previous sections, we computed the instantaneous rate of change
      by looking for a limiting value in the average rate of change
      for a sequence of intervals that had decreasing width.
      It is important to realize that this is the fundamental definition of the instantaneous rate of change.
      In many cases involving basic algebraic functions, like polynomials,
      it is possible to determine the limiting value of this process algebraically.
      This is because we can find a formula for the average rate of change for any value of the spacing <m>h</m>
      and determine what will happen when <m>h \to 0</m>.
    </p>
    <p>
      The process for using this strategy is to consider the same calculations that we used to form the tables,
      but to determine the formula for each step instead of numerical values for the particular values of <m>h</m>.
      <ul>
        <li> Identify the function <m>f(x)</m> and the point of interest <m>a</m>.</li>
        <li> Use composition to find the formula for <m>f(a+h)</m> and expand. </li>
        <li> Compute the change in the function <m>\Delta f = f(a+h) - f(a)</m> and simplify. </li>
        <li>
          <p>
            Compute the average rate of change,
            <me>\frac{\Delta f}{\Delta x} = \frac{f(a+h)-f(a)}{h},</me>
            and use factoring in order to find a formula that does not divide by <m>h</m>.
          </p>
        </li>
        <li>
          <p>
            The limit or instantaneous rate of change is the value of this final formula when <m>h \to 0</m>.
            This works because simplifying the rate of change formula found a new expression that was continuous at the point <m>h=0</m>.
          </p>
        </li>
        <li>
          <p>
            If it is not possible to rewrite without dividing by <m>h</m>,
            then you can use the formula itself in a table to see what happens
            when <m>h \to 0</m> by testing a sequence of values for <m>h</m> that approach 0.
          </p>
        </li>
      </ul>
      Take a moment to look at how the calculations described above compare
      to our process of approximating the derivative using a table.
    </p>
    <example>
      <statement>
        <p>
          Find the instantaneous rate of change for <m>f(x)=x^2+3x</m> at <m>2</m>.
        </p>
      </statement>
      <solution>
        <p>
          We will just follow the steps outlined above.
          <ol>
            <li>
              <p>
                The function has been identified and the point given.
                We also need <m>f(2)=2^2+3(2)=10</m> in later steps.
              </p>
            </li>
            <li>
              <p>
                Find <m>f(2+h)</m> and expand:
                <md>
                  <mrow> f(2+h) &amp;= (2+h)^2+3(2+h) = (2+h)(2+h) + 3 (2+h) </mrow>
                  <mrow> &amp;= 4+4h+h^2+6+3h = 10 + 7h +h^2 </mrow>
                </md>
              </p>
            </li>
            <li>
              <p>
                Compute the change in function value, <m>\Delta f = f(2+h)-f(2)</m>:
                <me> \Delta f = f(2+h)-f(2) = (10+7h+h^2) - (10) = 7h+h^2 </me>
              </p>
            </li>
            <li>
              <p>
                Compute the formula for the average rate of change:
                <me>\left. \frac{\Delta f}{\Delta x} \right|_{2; h} = \frac{7h+h^2}{h} = \frac{h(7+h)}{h} = 7+h</me>.
                The average rate of change is only defined when <m>h \ne 0</m>.
              </p>
            </li>
            <li>
              <p>
                The limit of the average rate of change uses the simplified formula on both sides of <m>h=0</m>.
                Because the reduced formula is continuous, the limiting value can be found by substitution:
                <me> \left. \frac{df}{dx} \right|_{2} = \lim_{h \to 0} 7+h = 7+0 = 7. </me>
              </p>
            </li>
          </ol>
        </p>
      </solution>
    </example>
    <p>
      The definition of the derivative allows us to compute the rate of change for functions other than polynomials.
    </p>
    <example>
      <statement>
        <p>Find the instantaneous rate of change for <m>f(x)=\frac{1}{3x+1}</m> at <m>1</m>.</p>
      </statement>
      <solution>
        <p>
          We again just follow the steps outlined above.
          <ol>
            <li>
              The function has been identified and the point given.
              We also need <m>f(1) = \frac{1}{3(1)+1} = \frac{1}{4}</m> in later steps.
            </li>
            <li><p>
              Find <m>f(1+h)</m> and expand:
              <md>
                <mrow> f(1+h) &amp;= \frac{1}{3(1+h)+1} = \frac{1}{3+3h+1} </mrow>
                <mrow> &amp;= \frac{1}{4+3h} </mrow>
              </md>
            </p></li>
            <li><p>
              Compute the change in function value, <m>\Delta f = f(1+h)-f(1)</m>:
              <me> \Delta f = f(1+h)-f(1) = \frac{1}{4+3h} - \frac{1}{4}.</me>
              We will later need to simplify this, so let us find a common denominator,
              which requires multiplying each fraction's numerator and denominator by the missing factor:
              <me>\Delta f = \frac{4}{4(4+3h)} - \frac{4+3h}{4(4+3h)} = \frac{4-(4+3h)}{4(4+3h)} = \frac{-3h}{4(4+3h)}.</me>
            </p></li>
            <li><p>
              Compute the formula for the average rate of change:
              <md>
                <mrow>\left. \frac{\Delta f}{\Delta x} \right|_{1; h} &amp;= \frac{\left( \frac{-3h}{4(4+3h)} \right)}{h} </mrow>
                <mrow> &amp;= \frac{1}{h} \cdot\frac{-3h}{4(4+3h)} </mrow>
                <mrow> &amp;= \frac{-3}{4(4+3h)}, </mrow>
              </md>
              defined when <m>h \ne 0</m>.
            </p></li>
            <li><p>
              The instantaneous rate of change is the limit of the average rate of change.
              Because the reduced formula is continuous at <m>h=0</m>, the limit can be computed using substitution
              <md>
                <mrow>\left. \frac{df}{dx} \right|_{1} &amp;= \lim_{h \to 0} \frac{-3}{4(4+3h)}</mrow>
                <mrow> &amp;= \frac{-3}{4(4+3(0))} = \frac{-3}{16}.</mrow>
              </md>
            </p></li>
          </ol>
        </p>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>Interpretation of the Rate of Change</title>
    <p>
      The rate of change often has a physical interpretation.
      For example, if we know the position (e.g., height) as a function of time,
      then the rate of change corresponds to the velocity of the object.
      In chemistry, if we know the concentration of a reactant in solution as a function of time,
      then the rate of change of concentration describes the reaction rate.
      We can also have rates of change with respect to variables other than time.
      For example, in biology, the number of new fish born in a year (called recruitment) might be a function of the current population size (called the stock).
      The rate of change of the recruitment with respect to the stock measures
      how much the recruitment would change per unit increase in the stock.
      In economics, if we know how an equation relating the revenue that corresponds to the number of items being sold,
      then the rate of change of revenue with respect to the number of items is called the marginal revenue
      and corresponds to the amount of revenue change per extra item sold.
    </p>
    <p>
      The units of a rate of change are determined by the units in the ratio.
      Since velocity is the rate of change of position with respect to time,
      the units of velocity are the units of length divided by the units of time,
      such as kilometers per hour or meters per second.
      Marginal revenue is the rate of change of revenue with respect to items sold,
      so the units would be a monetary unit per item, such as dollars per item.
    </p>
    <example>
      <statement>
        <p>
          In a chemical reaction, the concentration of a reactant is measured as a function of time.
          If <m>C</m> represents the concentration measured grams per liter
          and <m>t</m> represents the time elapsed since the reaction began measured in seconds,
          then this function is the mapping <m>t \mapsto C</m>.
        </p>
        <p>What are the units of <m>\frac{dC}{dt}</m>?</p>
      </statement>
      <solution>
        <p>
          The quickest solution to answer this question says to take the units of the dependent variable <m>C</m>
          and divide by the units of the independent variable <m>t</m>.
          That would give grams per liter per second, or <quantity><unit base="gram"/><per base="liter"/><per base="second"/></quantity>.
          To clarify why we divide the units in that way, recall that the rate of change
          is the ratio of the change in <m>C</m> (output) over the change in <m>t</m> (input).
          Because <m>C</m> has units of <quantity><unit base="gram"/><per base="liter"/></quantity>,
          those will also be the units of <m>\Delta C</m>.
          Dividing this by the change in time <m>\Delta t</m>, which has units of seconds <quantity><unit base="second"/></quantity>,
          we obtain the units of the rate of change.
        </p>
      </solution>
    </example>
    <p>
      We can use the definition of the rate of change to calculate an instantaneous rate of change
      for a given model of a physical quantity.
    </p>
    <example>
      <statement>
        <p>
          A population grows in time according to a model
          <me>P(t) = 400 \cdot 1.1^t</me>,
          where <m>P</m> is the population count and <m>t</m> is the time in years from the start of the model.
          How fast is the population growing when <m>t=2</m>?
        </p>
      </statement>
      <solution>
        <p>
          Because we do not yet know the rules of differentiation to find the algebraic rule for the derivative,
          we will use the definition of the derivative in terms of a limit.
          The derivative is defined as
          <me>\left.\frac{dP}{dt}\right|_{2} = \lim_{h \to 0} \frac{P(2+h) - P(2)}{h}</me>.
          Substituting the formula for <m>P(t)</m>, we can write this as
          <me>\left.\frac{dP}{dt}\right|_{2} = \lim_{h \to 0} \frac{400 \cdot 1.1^{(2+h)} - 400 \cdot 1.1^2}{h}</me>.
          We can now set up a table of values of this average rate of change for values of <m>h</m> with <m>h \to 0</m>.
          Our table will show a final value with 6 digits of accuracy so that we can visualize the limit converging.
        </p>
        <sidebyside widths="40% 40%">
          <table xml:id="table-population-rate-ex-1a">
            <tabular top="major" halign="center">
              <row bottom="minor">
                <cell><m>h</m></cell>
                <cell><m>\displaystyle \left. \frac{\Delta P}{\Delta t} \right|_{2; h} = \frac{400 \cdot 1.1^{(2+h)} - 400 \cdot 1.1^2}{h}</m></cell>
              </row>
              <row>
                <cell>-0.1</cell>
                <cell><m>\displaystyle \frac{400 \cdot 1.1^{1.9} - 400 \cdot 1.1^2}{-0.1} \approx 45.9110</m></cell>
              </row>
              <row>
                <cell>-0.01</cell>
                <cell><m>\displaystyle \frac{400 \cdot 1.1^{1.99} - 400 \cdot 1.1^2}{-0.01} \approx 46.1082</m></cell>
              </row>
              <row bottom="major">
                <cell>-0.001</cell>
                <cell><m>\displaystyle \frac{400 \cdot 1.1^{1.999} - 400 \cdot 1.1^2}{-0.001} \approx 46.1279</m></cell>
              </row>
            </tabular>
            <caption>
              Table of <m>\frac{\Delta P}{\Delta t}</m> for <m>h \lt 0</m>.
            </caption>
          </table>
          <table xml:id="table-population-rate-ex-1b">
            <tabular top="major" halign="center">
              <row bottom="minor">
                <cell><m>h</m></cell>
                <cell><m>\displaystyle \left. \frac{\Delta P}{\Delta t} \right|_{2; h} = \frac{400 \cdot 1.1^{(2+h)} - 400 \cdot 1.1^2}{h}</m></cell>
              </row>
              <row>
                <cell>0.1</cell>
                <cell><m>\displaystyle \frac{400 \cdot 1.1^{2.1} - 400 \cdot 1.1^2}{0.1} \approx 46.3507</m></cell>
              </row>
              <row>
                <cell>0.01</cell>
                <cell><m>\displaystyle \frac{400 \cdot 1.1^{2.01} - 400 \cdot 1.1^2}{0.01} \approx 46.1521</m></cell>
              </row>
              <row bottom="major">
                <cell>0.001</cell>
                <cell><m>\displaystyle \frac{400 \cdot 1.1^{2.001} - 400 \cdot 1.1^2}{0.001} \approx 46.1323</m></cell>
              </row>
            </tabular>
            <caption>
              Table of <m>\frac{\Delta P}{\Delta t}</m> for <m>h\gt 0</m>.
            </caption>
          </table>
        </sidebyside>
        <p>
          Comparing the tables using values on the left (<m>h \lt 0</m>) and values on the right (<m>h \gt 0</m>),
          our calculations inform us that <m>\frac{dP}{dt}\Big|_{2}</m> is between 46.1279 and 46.1323 individuals per year.
          The best estimate would be the average of the rates of change for <m>h=\pm 0.001</m>,
          or <m>\frac{dP}{dt}\Big|_{2} \approx 46.1301</m> individuals per year.
        </p>
      </solution>
    </example>
    <example>
      <statement>
        <p>
          A company determines that the number of a particular item it can sell in a month
          depends on the sale price for that item according to the demand function
          <me>x = \frac{12000}{p+3}</me>
          where <m>x</m> measures the number of items sold per month
          and <m>p</m> measures the sale price of an item in dollars.
        </p>
        <p>
          Find the monthly revenue for a sale price of <m>p=5</m>
          and determine rate of change of monthly revenue with respect to the sale price when <m>p=5</m>.
          Compare this rate of change with the actual change in revenue for particular price changes.
        </p>
      </statement>
      <solution>
        <p>
          The total revenue <m>R</m> is equal to the number of items sold times the price of each item.
          That is, <me>R = x \cdot p</me>.
          Subsituting the demand function in place of <m>x</m>, we find
          <me>p \mapsto R = \frac{12000p}{p+3}</me>.
          We can find the monthly revenue using <m>p=5</m> to obtain
          <me>p=5 \: \mapsto \: R=\frac{12000(5)}{5+3} = 7500</me>.
          The monthly revenue will be <dollar/>7500 when the item price is <m>p=5</m>.
        </p>
        <p>
          To find the rate of change of <m>R</m> with respect to <m>p</m>,
          we write down the definition of the derivative.
          <md>
            <mrow>\left. \frac{dR}{dp} \right|_{5} &amp;= \lim_{h \to 0} \frac{R(5+h) - R(5)}{h}</mrow>
            <mrow> &amp;= \lim_{h \to 0} \frac{ \frac{12000(5+h)}{5+h+3} - 7500}{h} </mrow>
          </md>
          We can simplify this formula using algebra.
          <md>
            <mrow>\left. \frac{dR}{dp} \right|_{5} &amp;= \lim_{h \to 0} \frac{ \frac{60000+12000h}{8+h} - 7500}{h} </mrow>
            <mrow> &amp;= \lim_{h \to 0} \frac{ \frac{60000+12000h}{8+h} - \frac{7500(8+h)}{8+h}}{h} </mrow>
            <mrow> &amp;= \lim_{h \to 0} \frac{ \frac{60000+12000h}{8+h} - \frac{60000+7500h)}{8+h}}{h} </mrow>
            <mrow> &amp;= \lim_{h \to 0} \frac{ \left(\frac{4500h}{8+h}\right)}{h} </mrow>
          </md>
          We should never use a fraction within a fraction.
          Dividing by <m>h</m> is equivalent to multiplying by <m>1/h</m>.
          This allows us to rewrite our formula for the average rate of change in a way that can be simplified before finding the limit.
          <md>
            <mrow>\left. \frac{dR}{dp} \right|_{5} &amp;= \lim_{h \to 0} \frac{4500h}{8+h} \cdot \frac{1}{h} </mrow>
            <mrow> &amp;= \lim_{h \to 0} \frac{4500}{8+h}</mrow>
            <mrow> &amp;= \frac{4500}{8+0}</mrow>
            <mrow> &amp;= 562.50</mrow>
          </md>
        </p>
        <p>
          This rate of change tells us that starting at a unit price of <m>p=5</m>,
          the monthly revenue is increasing at a rate of <dollar/>562.50 for every <dollar/>1.00 increase in price.
          Because the derivative is an instantaneous rate of change, it will not match the average rate of change.
          For example, if we set the unit price at <m>p=6</m>, we get a monthly revenue of <m>R=8000</m>.
          The average rate of change for the monthly revenue with respect to price would be
          <me>\left.\frac{\Delta R}{\Delta p}\right|_{5,6} = \frac{R(6)-R(5)}{6-5} = \frac{8000-7500}{1} = 500</me>,
          which is lower than the instantaneous rate of change.
          However, if we consider a smaller change in unit price, say <m>h=0.1</m>, to get <m>p=5.10</m>,
          we now find
          <me>\left.\frac{\Delta R}{\Delta p}\right|_{5,5.10} = \frac{R(5.10)-R(5)}{0.1} \approx \frac{7555.55-7500}{1} = 555.5</me>,
          which is much closer to the instantaneous rate of change.
          Even smaller changes in the price will result in an average rate of change
          that is a closer approximation to the instantaneous rate of change.
        </p>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>Summary</title>
    <p>
      <ul>
        <li>
          A rate of change is the ratio of the change in a dependent variable (output)
          over the change in the independent variable (input).
        </li>
        <li>
          The <term>average rate of change</term> of <m>x \mapsto y</m> between <m>x=a</m> and <m>x=b</m> is
          <me>\left.\frac{\Delta y}{\Delta x}\right|_{a,b} = \frac{y(b)-y(a)}{b-a}</me>
          and represents the slope of the secant line or chord connecting points <m>(a,y(a))</m> and <m>(b,y(b))</m>.
        </li>
        <li>
          The <term>instantaneous rate of change</term> of <m>x \mapsto y</m> at a point <m>x=a</m>
          is called the <term>derivative</term> at <m>x=a</m>, defined by a limit of the average rate of change
          where the second point approaches the first point:
          <me>\left. \frac{dy}{dx}\right|_{a} = \lim_{h \to 0} \frac{y(a+h)-y(a)}{h}</me>.
          The instantaneous rate of change represents the slope of the tangent line to the curve at the point <m>(a,y(a))</m>.
        </li>
        <li>
          The units of measurement of a physical rate of change are the units of the dependent variable
          divided by the units of the independent variable.
        </li>
      </ul>
    </p>
  </subsection>
  <exercises>
    <exercisegroup>
      <introduction>
        <p>
          For the given function, compute the average rate of change over the given interval.
          Write the equation of the corresponding secant line.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p><m>f(x) = x^2 - 2x</m> on <m>[1,3]</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>\displaystyle x \mapsto y = \frac{3}{x}</m> on <m>[1,2]</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>y(x) = 2^x</m> on <m>[2,4]</m>.</p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
          Use a table to approximate the derivative of the given function at the specified point.
          Include enough data to ensure that your approximation has five digits of accuracy.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>Find <m>\frac{dy}{dx}\Big|_1</m> for <m>y(x)=x^2+x</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>Find <m>\frac{dQ}{dt}\Big|_1</m> for <m>Q(t)=3^t</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>Find <m>\frac{df}{dx}\Big|_2</m> for <m>f(x)=\sqrt{x}</m>.</p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
          Use the definition of the derivative and compute the resulting limit exactly
          to find the exact instantaneous rate of change for the specified function.
          Write the equation of the corresponding tangent line.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>Find <m>\frac{dy}{dx}\Big|_1</m> for <m>y(x)=x^2+x</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>Find <m>\frac{df}{dx}\Big|_2</m> for <m>y(x)=x^2-3x</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>Find <m>\frac{df}{dx}\Big|_{-1}</m> for <m>y(x)=2x^2+3x</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>Find <m>\frac{dP}{dt}\Big|_{2}</m> for <m>P(t)=t^3 - 2t</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>Find <m>\frac{dz}{dr}\Big|_3</m> for <m>\displaystyle z(r)=\frac{3}{r}</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>Find <m>\frac{dR}{dz}\Big|_2</m> for <m>\displaystyle R(z)=\frac{3}{2z+1}</m>.</p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>Applications</p>
      </introduction>
      <exercise>
        <statement>
          <p>
            The height <m>h</m> of an object dropped from a height of 100 feet
            as a function of time <m>t</m> in seconds since the object was dropped
            satisfies a model
            <me>h(t)=100-16t^2</me>.
            <ol>
              <li>Find the average velocity over the interval <m>[1,2]</m>.</li>
              <li>Find the instantaneous velocity at <m>t=1</m>.</li>
            </ol>
            Be sure to use appropriate units.
            What is the interpretation of the sign of these values?
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
            A vehicle accelerates from a stop at time <m>t=0</m> (in seconds) to highway speed at <m>t=6</m>.
            The velocity <m>v</m> of the vehicle (in miles per hour) is a function of <m>t</m> given by
            <me>v(t) = -\frac{5}{9}t^3 + 5t^2, \quad 0 \le t \le 6</me>.
            The rate of change of velocity is called acceleration.
            <ol>
              <li>Find the velocity at <m>t=0</m> and <m>t=6</m>.</li>
              <li>Determine the average acceleration over the interval <m>[0,6]</m>.</li>
              <li>Find the velocity at <m>t=1</m> and <m>t=2</m>.</li>
              <li>Determine the average acceleration over the interval <m>[1,2]</m>.</li>
              <li>Determine the instantaneous acceleration at <m>t=1</m>.</li>
            </ol>
            Be sure to use appropriate units.
            Was the vehicle accelerating at a constant rate?
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
            Researchers studying tree growth in Germany found a relationship
            between the age of the tree (years) and its total weight (kg)
            for sycamore maples in a particular forest.
            If <m>a</m> represents the age of a tree and <m>W</m> is its total weight,
            the relationship <m>a \mapsto W</m> was modeled using regression with a quadratic polynomial as
            <me>W = 31.6601-7.6351a+0.4334a^2</me>.
            (<url href="https://www.tandfonline.com/doi/full/10.1080/02827581.2014.910267">Albert et al, 2014</url>)
            <ol>
              <li>Find the mass of a fifteen year old tree and of a twenty year old tree.</li>
              <li>
                Determine the average rate of change of the mass of a tree with respect to age
                over the interval <m>[15,20]</m>.
              </li>
              <li>
                Determine the instantaneous rate of change of the mass of a tree
                with respect to age at the age <m>a=15</m>.
              </li>
            </ol>
            Be sure to use appropriate units.
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
            Kinesin is a motor protein that facilitates transport along the axon of a neuron.
            Researchers recorded the velocity of single kinesin molecules pulling microscopic glass beads
            subject to a constant resistive force of approximately <quantity><mag>1</mag><unit base="Newton" prefix="pico"/></quantity> with varying ATP concentrations.
            The velocity of transport along a microtubule <m>V</m> (<quantity><unit base="meter" prefix="nano"/><per base="second"/></quantity>)
            depended on the concentration of ATP <m>C</m> (<quantity><unit base="molarity" prefix="micro"/></quantity>)
            and was modeled with a Michaelis-Menten equation
            <me>V = \frac{85C}{C+814}</me>.
            (<url href="https://www.nature.com/articles/ncb1000_718">
              Schnitzer et al., 2000
            </url>)
            <ol>
              <li>
                Find the velocity of transport when ATP has concentrations of
                <quantity><mag>100</mag><unit base="molarity" prefix="micro"/></quantity>
                and
                <quantity><mag>200</mag><unit base="molarity" prefix="micro"/></quantity>
              </li>
              <li>
                Determine the average rate of change of the transport velocity
                with respect to concentration over the interval <m>[100,200]</m>.
              </li>
              <li>
                Determine the instantaneous rate of change of the transport velocity
                with respect to concentration at a concentration of
                <quantity><mag>100</mag><unit base="molarity" prefix="micro"/></quantity>.
              </li>
            </ol>
            Be sure to use appropriate units.
          </p>
        </statement>
      </exercise>
    </exercisegroup>
  </exercises>
</section>
