<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2017  D. Brian Walton          -->
<!-- See the file COPYING for copying conditions. -->
   
<section xml:id="functions-piecewise">
    <title>Functions Defined on Sets</title>

    <introduction>
        <title>Overview</title>
        
        <p></p>
    </introduction>
    
    <subsection>
        <title>Function Domains</title>
        
        <p><xref ref="domain-and-range">Recall</xref> that the domain of a function <m>x \mapsto y</m> is the set of values of the independent variable <m>x</m> for which the function has a state <m>(x,y)</m>. Most sets that we encounter are made up of intervals, which describe sets of all real numbers between two extremes. For a brief review of concepts related to sets and interval, see <xref ref="appendix-sets-intervals">Appendix</xref>.</p>
        
        <p>When a function is defined by a formula, the domain is usually not stated. The <term>natural domain</term> is then understood to be the set of inputs for which the function is defined. We find this set by identifying which operations might not be defined for all values and then solve either equations or inequalities that will identify where the function is defined. Our elementary operations and functions have the following constraints. <ul>
            <li>Division is undefined if the denominator equals zero.</li>
            <li>Even roots (e.g., square roots) are undefined if the inner expression is negative.</li>
            <li>Logarithms are undefined if the inner expression is non-positive (zero or negative).</li>
        </ul></p>
        
        <example>
            <statement>
                <p>Determine the domain of <m>\displaystyle f(x) = \frac{2x+3}{x^2-4}</m>.</p>
            </statement>
            <solution>
                <p>Because <m>f(x)</m> is defined as a quotient, the domain will be the set of all values except where <m>x^2-4=0</m>. We solve this equation by factoring, since a product can only equal zero if one of the factors equals zero. <md>
                    <mrow>x^2-4 = 0</mrow>
                    <mrow>(x+2)(x-2) = 0 </mrow>
                    <mrow>x+2 = 0 \quad \text{or} \quad x-2=0</mrow>
                    <mrow>x=-2 \quad \text{or} \quad x=2</mrow>
                </md> This means <m>f(x)</m> is defined for all inputs except <m>x=-2</m> or <m>x=2</m>.</p>
                <p>To describe the domain using intervals, we think of the real number line and remove <m>x=\pm 2</m>. A graphical representation of the set using a number line is shown below. Intervals are read from the line left-to-right. It starts at <m>-\infty</m> and continues until <m>-2</m>, then goes from <m>-2</m> to <m>2</m>, and finally goes from <m>2</m> until <m>+\infty</m>. We write <me>D = (-\infty,-2) \cup (-2, 2) \cup (2,+\infty)</me>.</p>
                <sidebyside>
                    <image width="50%">
                        <latex-image-code>
                        <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
                        <![CDATA[\tikzset{%
                        }
                        \begin{tikzpicture}[x=1cm,y=1cm]
                        \draw[<->] (-4,0) -- (4,0);

                        \draw (-2, -0.1) -- (-2,0.1) node[pos=0, below] {$-2$};
                        \draw (2, -0.1) -- (2,0.1) node[pos=0, below] {$2$};
                        \draw [<-, blue, thick] (-4,0.2) -- (-2.1,0.2);
                        \draw [blue, thick] (-2,0.2) circle (0.1);
                        \draw [blue, thick] (-1.9,0.2) -- (1.9,0.2);
                        \draw [blue, thick] (2,0.2) circle (0.1);
                        \draw [->, blue, thick] (2.1,0.2) -- (4,0.2) node [right] {$D$};
                        \end{tikzpicture}]]>
                        </latex-image-code>
                    </image>
                </sidebyside>
            </solution>
        </example>
        
        <p>Sometimes finding the domain of a function involves solving an inequality (such as for a square root or a logarithm). To solve the inequality, we identify points where the expression of interest <em>might</em> change sign. This can only occur where the expression equals zero or where the expression has a discontinuity (e.g., undefined), usually found by solving equations. We then check the sign of the expression in each of the resulting intervals.</p>
        
        <example>
            <statement>
                <p>Find the domain of the function <m>\displaystyle g(x)=\log_{4}(x^2-x-6)</m>.</p>
            </statement>
            <solution>
                <p>The logarithm in <m>g(x)</m> will only have a real value when the input expression is positive, <m>x^2-x-6 \gt 0</m>. Our task becomes determining the signs of the expression <m>x^2-x-6</m>. First, we find possible sign-changing points. The expression is always defined (no discontinuities) so we just solve for zeros <m>x^2-x-6=0</m>. <md>
                    <mrow>x^2-x-6=0 </mrow>
                    <mrow>(x-3)(x+2)=0</mrow>
                    <mrow>x-3=0 \quad \text{or} \quad x+2=0</mrow>
                    <mrow>x=3 \quad \text{or} \quad x=-2</mrow>
                </md> If we mark these points on a number line, we can easily identify the intervals to test for signs. I like to use the same number line to record the resulting signs, so I label <m>x</m>-values below the line and the resulting sign or value of the expression above the line.</p>
                <sidebyside>
                    <image width="50%">
                        <latex-image-code>
                        <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
                        <![CDATA[\tikzset{%
                        }
                        \begin{tikzpicture}[x=0.7cm,y=0.7cm]
                        \draw[<->] (-5,0) -- (5,0)
                            node[pos=1, above right] {$x^2-x-6$}
                            node[pos=1, below right] {$x$};

                        \draw (-2, -0.1) -- (-2,0.1) 
                            node[pos=0, below] {$-2$}
                            node[pos=1, above] {$0$};
                        \draw (3, -0.1) -- (3,0.1)
                            node[pos=0, below] {$3$}
                            node[pos=1, above] {$0$};
                        \end{tikzpicture}]]>
                        </latex-image-code>
                    </image>
                </sidebyside>
                <p>The number line shows we need to test the intervals <m>(-\infty,-2)</m>, <m>(-2,3)</m>, and <m>(3,\infty)</m>. Choosing one value from each interval, we can evaluate the expression at that point and identify the sign. <md>
                    <mrow>x=-3 \quad &amp;\Rightarrow \quad x^2-x-6 = (-3)^2-(-3)-6 = 6</mrow>
                    <mrow>x=0 \quad &amp;\Rightarrow \quad x^2-x-6 = 0^2-0-6 = -6</mrow>
                    <mrow>x=4 \quad &amp; \Rightarrow \quad x^2-x-6 = 4^2-4-6 = 6</mrow>
                </md> We can now update the number line we started by recording either <m>+</m> or <m>-</m> above each interval that we tested.</p>
                <sidebyside>
                    <image width="50%">
                        <latex-image-code>
                        <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
                        <![CDATA[\tikzset{%
                        }
                        \begin{tikzpicture}[x=0.7cm,y=0.7cm]
                        \draw[<->] (-5,0) -- (5,0)
                            node[pos=1, above right] {$x^2-x-6$}
                            node[pos=1, below right] {$x$};

                        \draw (-2, -0.1) -- (-2,0.1) 
                            node[pos=0, below] {$-2$}
                            node[pos=1, above] {$0$};
                        \draw (3, -0.1) -- (3,0.1)
                            node[pos=0, below] {$3$}
                            node[pos=1, above] {$0$};
                        \node [above] at (-3,0.1) {$+$};
                        \node [above] at (0,0.1) {$-$};
                        \node [above] at (4,0.1) {$+$};
                        \end{tikzpicture}]]>
                        </latex-image-code>
                    </image>
                </sidebyside>
                <p>We were finding the domain of <m>g(x)=\log_4(x^2-x-6)</m>, which requires <m>x^2-x-6 \gt 0</m>. Based on our summary, we need to find all values which result in the expression having a positive sign. So our solution is the set <m>D</m> formed from the union of intervals <m>(-\infty,-2)</m> and <m>(3,\infty)</m>, <me>D = (-\infty,-2) \cup (3,\infty)</me>.</p>
            </solution>
        </example>
        
        <example>
            <statement>
                <p>Find the domain of the function <m>\displaystyle h(x) = \sqrt{\frac{4x}{x^2-9}}</m>.</p>
            </statement>
            <solution>
                <p>A square root (any even root) requires that the input expression is non-negative. Our domain is to solve the inequality <me>D = \{ x : \frac{4x}{x^2-9} \ge 0 \}</me>.</p>
                <p>To use sign analyis, we need to know the zeros and discontinuities and then test each resulting interval. Discontinuities occur when we try to divide by zero. <md>
                    <mrow>x^2-9 = 0</mrow>
                    <mrow>(x+3)(x-3) = 0</mrow>
                    <mrow>x+3=0 \quad \text{or} \quad x-3=0</mrow>
                    <mrow>x=-3 \quad \text{or} \quad x=3</mrow>
                </md> Zeros for a quotient require that the numerator equals zero. <md>
                    <mrow>4x=0</mrow>
                    <mrow>x=0</mrow>
                </md> Our sign analysis number line will have three points. <sidebyside>
                    <image width="50%">
                        <latex-image-code>
                        <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
                        <![CDATA[\tikzset{%
                        }
                        \begin{tikzpicture}[x=0.7cm,y=0.7cm]
                        \draw[<->] (-5,0) -- (5,0)
                            node[pos=1, above right] {$\displaystyle \frac{4x}{(x+3)(x-3)}$}
                            node[pos=1, below right] {$x$};

                        \draw (-3, -0.1) -- (-3,0.1) 
                            node[pos=0, below] {$-3$}
                            node[pos=1, above] {und};
                        \draw (0, -0.1) -- (0,0.1)
                            node[pos=0, below] {$0$}
                            node[pos=1, above] {$0$};
                        \draw (3, -0.1) -- (3,0.1)
                            node[pos=0, below] {$3$}
                            node[pos=1, above] {und};
                        \end{tikzpicture}]]>
                        </latex-image-code>
                    </image>
                </sidebyside> Checking one point in each resulting interval gives us the sign. Because we only need to know the sign, it is simpler to think of factors of positive or negative values. <md>
                    <mrow>x = -4 \quad &amp;\Rightarrow \quad \frac{4x}{(x+3)(x-3)} = \frac{4(-4)}{(-4+3)(-4-3)} = \frac{(-)}{(-)(-)}</mrow>
                    <mrow>x = -1 \quad &amp;\Rightarrow \quad \frac{4x}{(x+3)(x-3)} = \frac{4(-1)}{(-1+3)(-1-3)} = \frac{(-)}{(+)(-)}</mrow>
                    <mrow>x = 1 \quad &amp;\Rightarrow \quad \frac{4x}{(x+3)(x-3)} = \frac{4(1)}{(1+3)(1-3)} = \frac{(+)}{(+)(-)}</mrow>
                    <mrow>x = 4 \quad &amp;\Rightarrow \quad \frac{4x}{(x+3)(x-3)} = \frac{4(4)}{(4+3)(4-3)} = \frac{(+)}{(+)(+)}</mrow>
                </md> The signs can be summarized on the number line. <sidebyside>
                    <image width="50%">
                        <latex-image-code>
                        <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
                        <![CDATA[\tikzset{%
                        }
                        \begin{tikzpicture}[x=0.7cm,y=0.7cm]
                        \draw[<->] (-5,0) -- (5,0)
                            node[pos=1, above right] {$\displaystyle \frac{4x}{(x+3)(x-3)}$}
                            node[pos=1, below right] {$x$};

                        \draw (-3, -0.1) -- (-3,0.1) 
                            node[pos=0, below] {$-3$}
                            node[pos=1, above] {und};
                        \draw (0, -0.1) -- (0,0.1)
                            node[pos=0, below] {$0$}
                            node[pos=1, above] {$0$};
                        \draw (3, -0.1) -- (3,0.1)
                            node[pos=0, below] {$3$}
                            node[pos=1, above] {und};
                        \node [above] at (-4,0.1) {$-$};
                        \node [above] at (-1,0.1) {$+$};
                        \node [above] at (1,0.1) {$-$};
                        \node [above] at (4,0.1) {$+$};
                        \end{tikzpicture}]]>
                        </latex-image-code>
                    </image>
                </sidebyside></p>
                <p>We interpret our analysis to find the domain of <m>h(x)</m>. The domain must include intervals where the inner expression is positive, <m>(-3,0)</m> and <m>(3,\infty)</m>, along with points where the expression equals zero, <m>x=0</m>. We do not include the points where the expression was undefined, <m>x=\pm3</m>. The domain is the set <me>D = (-3,0] \cup (3,\infty)</me>.</p>
            </solution>
        </example>
        
        <p>Sometimes, we want a function restricted to a particular <term>explicit domain</term>. This will be especially important when we work with piecewise functions. Mapping notation for sets can be used to show an explicit domain <m>D</m> for a function <m>f</m>.</p>
        
        <definition xml:id="defn-mapping-notation-domain-target">
            <statement>
                <p>A real-valued function <m>x \overset{f}{\mapsto} f(x)</m> defined on an explicit domain <m>D</m> is written <me>f : D \to \mathbb{R}; x \mapsto f(x).</me> (Notice the different arrows used for the domain.) The set <m>\mathbb{R}</m> is the standard <term>co-domain</term>, meaning all <m>f(x)</m>-values belong to <m>\mathbb{R}</m>.</p>
            </statement>
        </definition>
        
        <example>
            <statement>
                <p>Interpret <m>f:[0,1] \to \mathbb{R}; x \mapsto 2x+5</m>.</p>
            </statement>
            <solution>
                <p>Mapping notation gives us the domain and the rule. The mapping notation <m>[0,1] \to \mathbb{R}</m> tells us the domain is the set <m>[0,1]</m>. The second piece of the mapping notation <m>x \mapsto 2x+5</m> gives us the rule, <m>f(x)=2x+5</m>. Normally, <m>f(x)=2x+5</m> would be defined for any value of <m>x \in (-\infty,\infty)</m>. The mapping notation tells us we have restricted the relation to only include <m>0 \le x \le 1</m>, so that <m>f(-0.1)</m> and <m>f(1.05)</m> are both undefined.</p>
            </solution>
        </example>
        
        <p>Restricting a domain is necessary to define inverse functions when a function is not one-to-one. For example, we have early noted that <m>y=x^2</m> is not one-to-one because when solving for <m>x</m>, we get two solutions <m>x=\pm\sqrt{y}</m>. Nevertheless, we think of <m>f(x)=x^2</m> and <m>g(x)=\sqrt{x}</m> as inverses of one another. This is only true if we restrict the domain of <m>f</m>. Instead of using mapping notation, we will usually use a restriction on the domain.</p>
        
        <example>
            <statement>
                <p>The function <m>f:[0,\infty) \to \mathbb{R}; x \mapsto x^2</m> can be written using a standard equation with a constraint as <me>f(x) = x^2, \quad x \ge 0</me>. The inequality that serves as the constraint specifies the domain since <m>\{x : x \ge 0\} = [0,\infty)</m>.</p>
            </statement>
        </example>
    </subsection>
    
    <subsection>
        <title>Piecewise Functions and Continuity</title>
        
        <p>A function does not need to follow the same rule for all values in its domain. Piecewise functions are functions that define different rules for different subsets of the domain. The standard notation for piecewise function is to create a list of rules using an equation with constraints on the domain for each given rule.</p>
        
        <example>
            <statement>
                <p>Describe the piecewise function <me>f(x) = \begin{cases}
                    3, &amp; x \lt 0, \\
                    x^2, &amp; 0 \lt x \le 2, \\
                    4-x, &amp; x \gt 2.
                \end{cases}</me> Include a graph.</p>
            </statement>
            <solution>
                <p>The function <m>f:x \mapsto y</m> is listed with three different rules. For inputs <m>x \in (-\infty,0)</m> (i.e., <m>x \lt 0</m>), we use the rule <m>y=3</m>; for inputs <m>x \in (0,2]</m>, we use the rule <m>y=x^2</m>; and for <m>x \in (2,\infty)</m>, we use the rule <m>y=4-x</m>. Notice that for <m>x=0</m>, there is no rule provided. The domain of <m>f</m> is the union of the component domains, so <me>D=(-\infty,0) \cup (0,\infty)</me>.</p>
                <p>Notice how we would evaluate the function at different points. Looking at the input, we determine which rule applies and then use only that rule. <md>
                    <mrow>f(-2) &amp;= 3 </mrow>
                    <mrow>f(1) &amp;= 1^2 = 1</mrow>
                    <mrow>f(2) &amp;= 2^2 = 4</mrow>
                    <mrow>f(2.01) &amp; = 4-2.01 = 1.99</mrow>
                </md></p>
                <p>The graph of the relation <m>y=f(x)</m> is created by pasting the graphs <m>y=3</m>, <m>y=x^2</m>, and <m>y=4-x</m> into a single graph, but including only that portion of the graphs that is relevant for the constrained domains of those rules. For points at the edge of a domain interval, we use filled circles only when the point is explicitly included. <sidebyside>
                    <image width="50%">
                        <latex-image-code>
                        <!-- CDATA prevents certain LaTeX code from being interpreted as xml -->
                        <![CDATA[\tikzset{%
                        }
                        \begin{tikzpicture}
                        \begin{axis}
                        [
                            xmin=-4, xmax=4,
                        ]
                        \addplot [domain=-5:0, blue, thick] {3};
                        \addplot [domain=0:2, blue, thick, samples=25] {x^2};
                        \addplot [only marks, blue] coordinates { (2,4) };
                        \addplot [domain=2:5, blue, thick] {4-x};
                        \end{axis}
                        \end{tikzpicture}]]>
                        </latex-image-code>
                    </image>
                </sidebyside></p>
            </solution>
        </example>
        
        <p>In the previous example, the graph of the function had breaks. Those breaks occurred at the edges of the constrained domains of the rule. We call such a break a <term>discontinuity</term>.</p>

    </subsection>
    <conclusion>
        <title>Summary</title>
        
        <ul>
            <li>Sets are often defined as the union of intervals. An open interval <m>(a,b)</m> describes a set that is a solution to <m>a \lt x \lt b</m>. A closed intervals <m>[a,b]</m> includes the endpoints, <m>a \le x \le b</m>.</li>
            <li>
                <p>The natural domain of a function is found by determining the set of inputs for which the function output is defined.</p>
                <ul>
                    <li>A quotient <m>\frac{u}{w}</m> is defined for non-zero denominator <m>w \ne 0</m>.</li>
                    <li>An even root (e.g., square root) <m>\sqrt{u}</m> is defined for a non-negative input <m>u \ge 0</m>.</li>
                    <li>A logarithm <m>\log_b{u}</m> is defined for a positive input <m>u \gt 0</m>.</li>
                </ul>
            </li>
            <li>Inequalities related to zero can be solved by sign analysis: create intervals separated by zeros and discontinuities, test intervals for sign, and interpret the results.</li>
            <li>An explicit domain for a function can be specified using mapping notation, <me> f:D \rightarrow \mathbb{R}; x \mapsto f(x), </me> or using a constraint.</li>
            <li>A piecewise function uses different rules for different sets of the domain. The boundaries of these sets are the break-points of the function.</li>
            <li>Continuity of functions is introduced as a concept to guarantee that piecewise functions are connected. At each break-point, we need to verify that the formula to the left and the formula to the right both match the value at the break-point.</li>
            <li>Functions constructed from elementary functions are continuous on their domains. (Understanding why this is true is one of our course goals.)</li>
        </ul>
    </conclusion>
    
    <exercises>
        <exercise>
            <statement>
                <p>Sample.</p>
            </statement>
        </exercise>

    </exercises>
</section>