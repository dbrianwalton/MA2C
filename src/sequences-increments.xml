<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2015-2018  D. Brian Walton          -->
<!-- See the file COPYING for copying conditions. -->

<section xml:id="sequence-increments">
  <title>Increments of Sequences</title>

  <subsection>
    <title>Overview</title>
    <p>
      In the introductory section of this chapter, we learned that the increments of a sequence,
      calculated using the backward difference,
      can be used to analyze the monotonicity and concavity of a sequence.
      Those examples all focused on sequences with given values.
    </p>
    <p>
      In this section, we continue our study of increments by looking at sequences defined explicitly and recursively.
      For a sequence defined with an explicit formula,
      we will compute the increments using that formula and index substitution.
      For a sequence defined with a projection function,
      we will compute the increments as a function of the previous sequence value.
      Once a formula or function for the increments has been computed,
      we will solve inequalities to characterize the monotonicity and concavity of the sequence.
    </p>
  </subsection>
  <subsection>
    <title>Increments of Explicit Sequences</title>
    <p>
      When we know the explicit formula for a sequence <m>x_n</m>,
      we can find a corresponding formula for the increment of that sequence <m>\nabla x_n</m>.
      Recall that an explicit formula gives us a function mapping the value of the index to the value of the sequence,
      <me>n \mapsto x_n</me>.
      We can think of <m>n</m> and <m>x_n</m> as state variables.
      We can also think of <m>x_{n-1}</m> as a state variable, one that represents the <em>previous</em> value of the sequence.
      The expanded state of the system becomes <m>(n, x_n, x_{n-1})</m>.
      We want to include yet another state variable, the increment, <m>\nabla x_n</m>, which is defined by the backward difference
      <me>\nabla x_n = x_{n} - x_{n-1}</me>.
    </p>
    <p>
      We can find explicit formulas for these additional variables by making a substitution on the index.
      Suppose the map <m>n \mapsto x_n</m> were a function, <m>S:n \mapsto x_n</m>.
      The symbol <m>S(n)</m> would represent the explicit formula for <m>x_n</m>.
      Then <m>S(n-1)</m> would represent the formula for <m>x_{n-1}</m>,
      calculated by substituting the expression <m>n-1</m> everywhere the original variable <m>n</m> appeared in the formula.
      The process of substituting an expression in the place of the independent variable of a function is called <term>composition</term>.
    </p>
    <example>
      <statement>
        <p>
          Consider the sequence defined explicitly,
          <me>x = (3n+5)_{n=0}^{\infty}</me>.
          Find explicit formulas for <m>x_{n-1}</m> and <m>\nabla x_{n}</m>.
        </p>
      </statement>
      <solution>
        <p>
          The explicit formula for the sequence, <m>x_n = 3n+5</m>, defines a function,
          <me>S(n) = 3n+5</me>.
          The independent variable in the function is a placeholder for the input expression,
          <me>S(\square) = 3 \square + 5</me>.
          We can find the formula for the previous term using a substitution <m>\square = n-1</m>,
          <me>x_{n-1} = S(n-1) = 3(n-1) + 5.</me>
          Simplifying the expression to a sum, this gives
          <me>x_{n-1} = 3n+2</me>.
          Formally, because <m>x</m> has its first index <m>n=0</m>, there is no value <m>x_{-1}</m>.
          The formula for <m>x_{n-1}</m> is only valid for <m>n=1, 2, \ldots</m>.
        </p>
        <p>
          The increment <m>\nabla x_n</m> is defined by the backward difference <m>\nabla x_n = x_n - x_{n-1}</m>.
          To calculate the backward difference,
          we substitute the explicit formulas in place of the state variables <m>x_n</m> and <m>x_{n-1}</m> and simplify:
          <md>
            <mrow> \nabla x_n &amp; = x_n - x_{n-1} </mrow>
            <mrow> &amp;= \big(3n+5\big) - \big(3n+2\big) </mrow>
            <mrow> &amp;= 3n+5 - 3n - 2 </mrow>
            <mrow> &amp;= 3.</mrow>
          </md>
          Again, this only applies for <m>n=1,2,\ldots</m>.
          Because the increments were constant, we realize that <m>x</m> was an arithmetic sequence with <m>\beta = 3</m>.
        </p>
        <p>
          To illustrate the connection between the formulas with which we are now working and the actual values of the sequence,
          consider the actual values of the sequence, <me>x = (5, 8, 11, 14, 17, \ldots)</me>.
          Now, consider the table created using the explicit formulas above.
        </p>
        <tabular>
          <row bottom="major">
            <cell><m>n</m></cell>
            <cell><m>x_n</m></cell>
            <cell><m>x_{n-1}</m></cell>
          </row>
          <row>
            <cell>0</cell>
            <cell><m>3(0)+5 = 5</m></cell>
            <cell>undefined</cell>
          </row>
          <row>
            <cell>1</cell>
            <cell><m>3(1)+5 = 8</m></cell>
            <cell><m>3(1)+2=  5</m></cell>
          </row>
          <row>
            <cell>2</cell>
            <cell><m>3(2)+5 = 11</m></cell>
            <cell><m>3(2)+2=  8</m></cell>
          </row>
          <row>
            <cell>3</cell>
            <cell><m>3(3)+5 = 14</m></cell>
            <cell><m>3(3)+2=  11</m></cell>
          </row>
        </tabular>
        <p>
          You should notice how the formula for <m>x_{n-1}</m> uses the <em>current</em> value of <m>n</m> to find the value of the <em>previous</em> value of the sequence.
        </p>
      </solution>
    </example>
    <example>
      <statement>
        <p>
          Consider the sequence defined explicitly,
          <me>u = (n^2+2n)_{n=0}^{\infty}</me>.
          Find explicit formulas for <m>u_{n-1}</m> and <m>\nabla u_{n}</m>.
        </p>
      </statement>
      <solution>
        <p>
          The explicit formula for the sequence, <m>u_n = n^2+2n</m>, defines a function,
          <me>S(n) = n^2+2n</me>.
          The independent variable in the function is a placeholder for the input expression,
          <me>S(\square) = \square^2 + 2 \square</me>.
          We can find the formula for the previous term using a substitution <m>\square = n-1</m>,
          <me>u_{n-1} = S(n-1) = (n-1)^2+2(n-1).</me>
          Expanding the square and then simplifying the expression to a sum, this gives
          <md>
            <mrow>u_{n-1} &amp;= (n-1)(n-1)+2(n-1)</mrow>
            <mrow> &amp;= n^2-2n+1+2n-2</mrow>
            <mrow> &amp;= n^2-1</mrow>
          </md>
        </p>
        <p>
          The increment <m>\nabla u_n</m> is defined by the backward difference <m>\nabla u_n = u_n - u_{n-1}</m>.
          To calculate the backward difference,
          we substitute the explicit formulas in place of the state variables <m>u_n</m> and <m>u_{n-1}</m> and simplify:
          <md>
            <mrow> \nabla u_n &amp; = u_n - u_{n-1} </mrow>
            <mrow> &amp;= \big(n^2+2n\big) - \big(n^2-1\big) </mrow>
            <mrow> &amp;= n^2+2n-n^2+1 </mrow>
            <mrow> &amp;= 2n+1. </mrow>
          </md>
        </p>
        <p>
          We can illustrate that the formulas using a table.
          Notice that the formula <m>u_{n-1}</m> calculate the previous value using the current index,
          and the formula for <m>\nabla u_n</m> calculates the increment of the sequence using the index.
        </p>
        <tabular>
          <row bottom="major">
            <cell><m>n</m></cell>
            <cell><m>u_n</m></cell>
            <cell><m>u_{n-1}</m></cell>
            <cell><m>\nabla u_n</m></cell>
          </row>
          <row>
            <cell>0</cell>
            <cell><m>(0)^2+2(0) = 0</m></cell>
            <cell>undefined</cell>
            <cell>undefined</cell>
          </row>
          <row>
            <cell>1</cell>
            <cell><m>(1)^2+2(1) = 3</m></cell>
            <cell><m>(1)^2-1= 0</m></cell>
            <cell><m>2(1)+1= 3</m></cell>
          </row>
          <row>
            <cell>2</cell>
            <cell><m>(2)^2+2(2) = 8</m></cell>
            <cell><m>(2)^2-1= 3</m></cell>
            <cell><m>2(2)+1= 5</m></cell>
          </row>
          <row>
            <cell>3</cell>
            <cell><m>(3)^2+2(3) = 15</m></cell>
            <cell><m>(3)^2-1= 8</m></cell>
            <cell><m>2(3)+1= 7</m></cell>
          </row>
        </tabular>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>Increments of Recursive Sequences</title>
    <p>
      When a sequence is defined recursively,
      we know that there is a projection function <m>f : x_{n-1} \mapsto x_n</m>.
      That is, the sequence value <m>x_n</m> can be found using the previous value <m>x_{n-1}</m> through the projection function,
      <me>x_n = f(x_{n-1}).</me>
      Instead of depending on the index, the increment is computed in terms of the previous value,
      <me>\nabla x_n = x_n - x_{n-1} = f(x_{n-1}) - x_{n-1}</me>.
      This suggests that we have another function, <m>g : x_{n-1} \mapsto \nabla x_n</m>,
      defined by
      <me>g(x) = f(x) - x</me>,
      which projects the increment instead of the new sequence value.
      We might call this function the <term>increment projection function</term>.
    </p>
    <example>
      <statement>
        <p>
          A sequence is defined recursively by the recurrence relation
          <me>x_n = 1.25 x_{n-1} - 10</me>.
          Find the formula for the increment in terms of <m>x_{n-1}</m>.
        </p>
      </statement>
      <solution>
        <p>
          The recurrence relation is already in the form of a recursive equation
          with projection function <m>f(x)=1.25x-10</m>.
          The increment <m>\nabla x_n = x_{n} - x_{n-1}</m> is computed
          by subtracting the <m>x_{n-1}</m> from the formula for <m>x_n</m>:
          <me>\nabla x_n = x_n - x_{n-1} = \big(1.25 x_{n-1} - 10\big) - x_{n-1}</me>.
          Simplifying this formula gives
          <me>\nabla x_n = 0.25 x_{n-1} - 10,</me>
          corresponding to an increment projection function <m>g(x) = f(x)-x= 0.25x-10</m>.
        </p>
        <p>
          We can illustrate the role of these formulas by creating a table of a sequence.
          Suppose the initial value is <m>x_0 = 20</m>.
          We can compute both <m>x_n</m> and <m>\nabla x_n</m> in terms of the previously computed value <m>x_{n-1}</m>.
        </p>
        <tabular>
          <row bottom="major">
            <cell><m>n</m></cell>
            <cell><m>x_n</m></cell>
            <cell><m>\nabla x_n</m></cell>
          </row>
          <row>
            <cell>0</cell>
            <cell>20</cell>
            <cell>undefined</cell>
          </row>
          <row>
            <cell>1</cell>
            <cell><m>1.25(20)-10 = 15</m></cell>
            <cell><m>0.25(20)-10 = -5</m></cell>
          </row>
          <row>
            <cell>2</cell>
            <cell><m>1.25(15)-10 = 8.75</m></cell>
            <cell><m>0.25(15)-10 = -6.25</m></cell>
          </row>
          <row>
            <cell>3</cell>
            <cell><m>1.25(8.75)-10 = 0.9375</m></cell>
            <cell><m>0.25(8.75)-10 = -7.8125</m></cell>
          </row>
        </tabular>
        <p>
          Suppose we had only used the recursive formula to find the sequence.
          We would have found <me>x = (x_n)_{n=0}^\infty = (20,15,8.75,0.9375\ldots)</me>.
          Then if we found the increments directly, we would have subtracted consecutive terms and found
          <me>\nabla x = (\nabla x_n)_{n=1}^\infty = (-5, -6.25, -7.8125,\ldots)</me>,
          in agreement with the calculations using the increment projection formula.
        </p>
      </solution>
    </example>
    <example>
      <statement>
        <p>
          A sequence is defined recursively by a projection function
          <me>f(x) = 1.25x - 0.05x^2</me>.
          Find the formula for the increment as a function of the previous sequence value.
        </p>
      </statement>
      <solution>
        <p>
          Knowing the sequence's projection function,
          the increment projection function is given by
          <md>
            <mrow>g(x)&amp;=f(x)-x</mrow>
            <mrow>&amp; = 1.25x - 0.05x^2 - x</mrow>
            <mrow>&amp; = 0.25x - 0.05x^2.</mrow>
          </md>
          This means that the increment is computed as <m>g : x_{n-1} \mapsto \nabla x_n</m>,
          or <me>\nabla x_n = 0.25 x_{n-1} - 0.05 x_{n-1}^2</me>.
        </p>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>Analysis of Monotonicity and Concavity</title>
    <p>
      When we have formulas to compute the increments,
      we can solve inequalities to determine under what conditions the increments are positive or negative.
      We can use the solutions of these inequalities to analyze where a sequence is increasing or decreasing.
      If we also compute the second backward difference, or the increments of the increments,
      then solving an additional inequality allows us to analyze the concavity of the sequence.
    </p>
    <p>
      There are many ways to solve an inequality.
      One approach is to isolate the independent variable use balanced operations.
      Inequalities have a complication in that balanced multiplication (or division) by a negative number reverses the inequality.
      Another approach that works for continuous functions is to solve an equation in order to create intervals to test.
      Using the principle of continuity of formulas, which we will justify later in this text,
      we can check one point in as a representative for each interval.
      Because the first approach only works in some cases,
      we will emphasize practicing using the second approach which works more generally.
      We will learn later in the text how to deal with inequalities involving discontinuous functions.
    </p>
    <example>
      <statement>
        <p>
          Determine the intervals of monotonicity and concavity for the sequence
          <me>x = (40n-n^2)_{n=0}^{\infty}</me>.
          Identify any local extremes.
        </p>
      </statement>
      <solution>
        <p>
          The explicit formula <m>x_n = 40n-n^2</m> allows us to compute formulas for the previous term and the increment.
          Notice the use of parentheses to emphasize the role of grouped terms, especially when there will be a subtraction.
          <md>
            <mrow>x_{n-1} &amp;= 40(n-1) - (n-1)^2</mrow>
            <mrow> &amp; = 40(n-1) - (n-1)(n-1)</mrow>
            <mrow> &amp; = \big(40n - 40\big) - \big(n^2-2n+1\big)</mrow>
            <mrow> &amp; = 40n - 40 - n^2 + 2n - 1 </mrow>
            <mrow> &amp; = 42n - n^2 - 41 </mrow>
          </md>
          <md>
            <mrow>\nabla x_n &amp;= x_n - x_{n-1} </mrow>
            <mrow> &amp;= \big(40n - n^2\big) - \big(42n - n^2 - 41\big) </mrow>
            <mrow> &amp;= 40n - n^2 - 42n + n^2 + 41 </mrow>
            <mrow> &amp;= -2n + 41 </mrow>
          </md>
          We can verify that our work looks correct by starting a table and
          checking whether the explicit formulas match what the terms should be.
        </p>
        <tabular>
          <row bottom="major">
            <cell><m>n</m></cell>
            <cell><m>x_n</m></cell>
            <cell><m>x_{n-1}</m></cell>
            <cell><m>\nabla x_n</m></cell>
          </row>
          <row>
            <cell>0</cell>
            <cell><m>40(0)-0^2 = 0</m></cell>
            <cell>undefined</cell>
            <cell>undefined</cell>
          </row>
          <row>
            <cell>1</cell>
            <cell><m>40(1)-1^2 = 39</m></cell>
            <cell><m>42(1)-1^2 - 41 = 0</m></cell>
            <cell><m>-2(1)+41 = 39</m></cell>
          </row>
          <row>
            <cell>2</cell>
            <cell><m>40(2)-2^2 = 76</m></cell>
            <cell><m>42(2)-2^2 - 41 = 39</m></cell>
            <cell><m>-2(2)+41 = 37</m></cell>
          </row>
        </tabular>
        <p>
          Checking thes few values in the table gives us confidence that we did the algebra correctly.
          The formula for the previous sequence value is matching what we expect,
          as is the formula for the increment.
        </p>
        <p>
          Now that we have a formula for the increments,
          we want to find the intervals where the increments are positive or negative.
          This corresponds to solving inequalities <m>\nabla x_n \gt 0</m> and <m>\nabla x_n \lt 0</m>.
          The increment is defined for index values <m>n=1,2,\ldots</m>.
        </p>
        <p>
          The approach of solving an inequality by isolating the independent variable would go as follows.
          Start with the inequality in terms of the independent variable <m>n</m>, because we have an explicit definition for the sequence.
          To solve <m>\nabla x_n \gt 0</m>, we use balanced operations to create equivalent inequalities.
          <md>
            <mrow> \nabla x_n \gt 0</mrow>
            <mrow> -2n+41 \gt 0 </mrow>
            <mrow> -2n \gt -41 </mrow>
            <mrow> \frac{-2n}{-2} \lt \frac{-41}{-2} </mrow>
            <mrow> n \lt 20{\textstyle \frac{1}{2}}</mrow>
          </md>
          When we divided both sides by <m>-2</m> (multiplied by <m>-\frac{1}{2}</m>),
          the equivalent relation showed a reversed inequality.
          The other inequality <m>\nabla x_n \lt 0</m> follows the same steps,
          resulting in the equivalent inequality
          <me> \nabla x_n \lt 0 \quad \Leftrightarrow \quad n \gt 20{\textstyle \frac{1}{2}}</me>.
        </p>
        <p>
          The alternate approach involves solving the equation <m>\nabla x_n = -2n+41 = 0</m>.
          Solving the equation involves the same steps to give an equivalent equation
          <me> \nabla x_n = 0 \quad \Leftrightarrow \quad n = 20\frac{1}{2} </me>.
          We now consider the intervals of values for <m>n</m> on either side of this value.
          The intervals are <m>\{1,\ldots,20\}</m> and <m>\{21,\ldots,\infty\}</m>.
          The principle for solving the inequality is to choose one value from each interval and
          use it to find the sign of <m>\nabla x_n</m>.
          For example, we can use <m>n=10</m> and <m>n=25</m>.
          <md>
            <mrow> \nabla x_{10} = -2(10)+41 = 21 </mrow>
            <mrow> \nabla x_{25} = -2(25)+41 = -9 </mrow>
          </md>
        </p>
        <p>
          Both methods of solving the inequalities give the same intervals,
          which allow us to analyze the monotonicity of the sequence as shown in the table below.
        </p>
        <tabular>
          <row bottom="major">
            <cell>Sign of <m>\nabla x_n</m></cell>
            <cell>Monotonicity of <m>x_n</m></cell>
          </row>
          <row>
            <cell>Positive on <m>\{1,\ldots,20\}</m></cell>
            <cell>Increasing on <m>\{0,\ldots,20\}</m></cell>
          </row>
          <row>
            <cell>Negative on <m>\{21,\ldots,\infty\}</m></cell>
            <cell>Decreasing on <m>\{20,\ldots,\infty\}</m></cell>
          </row>
        </tabular>
        <p>
          Because <m>x</m> is increasing on <m>\{0,\ldots,20\}</m>
          and then decreasing on <m>\{20,\ldots,\infty\}</m>,
          <m>x</m> must have a maximum value at <m>n=20</m>.
          The value of the sequence at that index is
          <me>x_{20} = 40(20) - 20^2 = 800-400 = 400.</me>
        </p>
        <p>
          To find concavity, we need to compute the second backward difference.
          This is computed like other backward differences.
          <md>
            <mrow>\nabla^2 x_n &amp;= \nabla x_n - \nabla x_{n-1}</mrow>
            <mrow>&amp;= \big(-2n+41\big) - \big(-2(n-1)+41\big)</mrow>
            <mrow>&amp;= \big(-2n+41\big) -\big(-2n+43\big)</mrow>
            <mrow>&amp;= -2n+41 + 2n - 43</mrow>
            <mrow>&amp;= -2</mrow>
          </md>
          The second backward difference is always negative, for <m>n=2,3,\ldots</m>.
          Consequently, <m>x</m> is concave down on <m>\{0,\ldots,\infty\}</m>.
        </p>
      </solution>
    </example>
    <p>
      One of the things you might notice is that completing analysis of a sequence is an involved process.
      You might be used to thinking that mathematics questions should have answers that take a limited amount of work.
      Complex questions might therefore seem overwhelming.
      Have confidence in your ability and develop a pattern of perseverance.
      Develop a pattern of big picture steps, breaking the overall problem into a series of manageable tasks.
    </p>
    <example>
      <statement>
        <p>
          Determine the intervals of monotonicity and concavity for the sequence
          <me>z = (n^3-70n^2+1000n)_{n=-\infty}^{\infty}</me>.
          Identify any local extremes.
        </p>
      </statement>
      <solution>
        <p>
          We review the big picture steps.
          <ol>
            <li>
              <p>Compute the backward difference <m>\nabla z_n</m>.</p>
            </li>
            <li>
              <p>Solve the equation <m>\nabla z_n = 0</m> to create test intervals.</p>
            </li>
            <li>
              <p>Test the sign of <m>\nabla z_n</m> in the intervals.</p>
            </li>
            <li>
              <p>Interpret the monotonicity and extreme values of the sequence based on the sign analysis.</p>
            </li>
            <li>
              <p>Compute the second backward difference <m>\nabla^2 z_n</m>.</p>
            </li>
            <li>
              <p>Solve the equation <m>\nabla^2 z_n = 0</m> to create test intervals.</p>
            </li>
            <li>
              <p>Test the sign of <m>\nabla^2 z_n</m> in the intervals.</p>
            </li>
            <li>
              <p>Interpret the concavity of the sequence based on the sign analysis.</p>
            </li>
          </ol>
        </p>
        <p>
          The explicit formula <m>z_n = n^3-70n^2+1000n</m> is used to compute the formulas for the previous term and the increment.
          <md>
            <mrow>z_{n-1} &amp;= (n-1)^3 - 70(n-1)^2 + 1000(n-1)</mrow>
            <mrow> &amp; = (n-1)(n-1)(n-1) - 70 (n-1)(n-1) + 1000(n-1)</mrow>
            <mrow> &amp; = (n-1)(n^2-2n+1) - 70(n^2-2n+1) + 1000n - 1000</mrow>
            <mrow> &amp; = n^3-3n^2+3n-1 - 70n^2+140n-70 + 1000n - 1000 </mrow>
            <mrow> &amp; = n^3 -73n^2+1143n-1071 </mrow>
          </md>
          <md>
            <mrow>\nabla z_n &amp;= z_n - z_{n-1} </mrow>
            <mrow> &amp;= \big(n^3 - 70n^2 + 1000n \big) - \big(n^3 -73n^2+1143n-1071\big) </mrow>
            <mrow> &amp;= n^3 - 70n^2+1000 n - n^3 +73n^2 - 1143 n + 1071 </mrow>
            <mrow> &amp;= 3n^2 -143 n + 1071 </mrow>
          </md>
        </p>
        <p>
          Solving the equation <m>\nabla z_n = 0</m> to identify our test intervals
          requires solving the quadratic equation
          <me> \nabla z_n = 3n^2 - 143 n +1071 = 0</me>.
          We use the quadratic formula:
          <md>
            <mrow> n &amp;= \frac{-(-143) \pm \sqrt{ (-143)^2 - 4 (3)(1071)}}{2(3)} </mrow>
            <mrow> &amp;= \frac{143 \pm \sqrt{7597}}{6}.</mrow>
          </md>
          To find the intervals, we need decimal approximations.
          <md>
            <mrow> n_1 = \frac{143 - \sqrt{7597}}{6} \approx 9.3065 </mrow>
            <mrow> n_2 = \frac{143 + \sqrt{7597}}{6} \approx 38.3601 </mrow>
          </md>
          The sequence is defined for an index interval <m>\{-\infty,\ldots,\infty\}</m>.
          These two break-points separate the interval into three test intervals:
          <me> \{-\infty,9\}, \quad \{10,\ldots,38\}, \quad \{39,\ldots,\infty\}.</me>
        </p>
        <p>
          We perform sign analysis by choosing a test value for the index <m>n</m> from each interval
          and identifying the sign of <m>\nabla z_n</m>.
          <md>
            <mrow> n=0:&amp; \quad \nabla z_0 = 3(0)^2 - 143(0) + 1071 = 1071 </mrow>
            <mrow> n=10:&amp; \quad \nabla z_{10} = 3(10)^2 - 143(10) + 1071 = -59 </mrow>
            <mrow> n=40:&amp; \quad \nabla z_{40} = 3(40)^2 - 143(40) + 1071 = 151 </mrow>
          </md>
          We can interpret these results:
          <ol>
            <li>
              <p>
                Because <m>\nabla z_n \gt 0</m> for all <m>n</m> in <m>\{-\infty,\ldots,9\}</m>,
                we know <m>z_n</m> is <em>increasing</em> on the interval <m>\{-\infty,\ldots,9\}</m>.
              </p>
              <p>
                Because <m>\nabla z_n \lt 0</m> for all <m>n</m> in <m>\{10,\ldots,38\}</m>,
                we know <m>z_n</m> is <em>decreasing</em> on the interval <m>\{9,\ldots,38\}</m>.
              </p>
              <p>
                Because <m>\nabla z_n \gt 0</m> for all <m>n</m> in <m>\{39,\ldots,\infty\}</m>,
                we know <m>z_n</m> is <em>increasing</em> on the interval <m>\{38,\ldots,\infty\}</m>.
              </p>
            </li>
          </ol>
          The turning points correspond to local extreme values.
          The value <m>z_9</m> is greater than values to its left and right and is a <em>local maximum</em>.
          The value <m>z_{38}</m> is less than values to its left and right and is a <em>local minimum</em>.
          Because <m>z</m> is decreasing on <m>\{-\infty,\ldots,9\}</m> and increasing on <m>\{38,\ldots,\infty\}</m>,
          we do not yet know if the sequence surpasses these values to determine global extreme values.
        </p>
        <p>
          To analyze concavity, we repeat the process for the second backward difference.
          <md>
            <mrow> \nabla z_{n-1} &amp;= 3(n-1)^2 - 143 (n-1) +1071 </mrow>
            <mrow> &amp;= 3(n^2-2n+1) - 143 (n-1) +1071 </mrow>
            <mrow> &amp;= 3n^2-6n+3 - 143n + 143 +1071 </mrow>
            <mrow> &amp;= 3n^2-149n+1217 </mrow>
          </md>
          <md>
            <mrow> \nabla^2 z_{n} &amp;= \nabla z_n - \nabla z_{n-1}</mrow>
            <mrow> &amp;= \big(3n^2-143n+1071\big) - \big(3n^2-149n+1217\big) </mrow>
            <mrow> &amp;= 3n^2-143n+1071 - 3n^2 + 149n - 1217 </mrow>
            <mrow> &amp;= 6n - 146 </mrow>
          </md>
          Solving the equation <m>\nabla^2 z_n = 0</m> gives
          <md>
            <mrow> 6n-146 &amp;= 0 </mrow>
            <mrow> 6n &amp;= 146 </mrow>
            <mrow>n &amp; = \frac{146}{6} = \frac{73}{3} </mrow>
            <mrow>n &amp; = 24{\textstyle \frac{1}{3}}</mrow>
          </md>
          The intervals to test  are separated by this value, <m>\{-\infty,\ldots,24\}</m> and <m>\{25,\ldots,\infty\}</m>.
          Test one point in each interval:
          <md>
            <mrow>\nabla^2 z_{0} &amp;= 6(0)-146 = -146,</mrow>
            <mrow>\nabla^2 z_{25} &amp;= 6(25)-146 = 4.</mrow>
          </md>
          Now we can interpret our results.
          <ul>
            <li>
              <p>
                Because <m>\nabla^2 z_n \lt 0</m> for all <m>n</m> in <m>\{-\infty,\ldots,24\}</m>,
                we know <m>z_n</m> is <em>concave down</em> on the interval <m>\{-\infty,\ldots,24\}</m>.
              </p>
              <p>
                Because <m>\nabla^2 z_n \gt 0</m> for all <m>n</m> in <m>\{25,\ldots,\infty\}</m>,
                we know <m>z_n</m> is <em>concave up</em> on the interval <m>\{23,\ldots,\infty\}</m>.
              </p>
            </li>
          </ul>
        </p>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>Behavior of Recursive Sequences</title>
    <p>
      When a sequence is defined recursively through a projection function,
      we found that we could create an increment projection function <m>g(x)=f(x)-x</m>.
      Because this does not directly give us any information about the index,
      we can not describe the interval of integers on which the sequence is increasing or decreasing.
      Instead we can describe which sequence values will lead to an increase or decrease in the next step.
    </p>
    <theorem xml:id="theorem-recursive-sequence-monotonicity">
      <statement>
        <p>
        Suppose a sequence <m>u</m> is defined recursively with <m>f : u_{n-1} \mapsto u_{n}</m>.
        <ul>
          <li>
            <p>
            If <m>f(x) \gt x</m>, or equivalently <m>f(x)-x \gt 0</m>, then <m>u_n = x</m> implies <m>u</m> <em>increases</em> on <m>\{n,n+1\}</m>.
            </p>
          </li>
          <li>
            <p>
            If <m>f(x) \lt x</m>, or equivalently <m>f(x)-x \lt 0</m>, then <m>u_n = x</m> implies <m>u</m> <em>decreases</em> on <m>\{n,n+1\}</m>.
            </p>
          </li>
          <li>
            <p>
            If <m>f(x) = x</m>, or equivalently <m>f(x)-x = 0</m>, then <m>u_n = x</m> implies <m>u</m> is <em>constant</em>.
            In this case, we call <m>x</m> a <term>fixed point</term> of <m>f</m> and an <term>equilibrium</term> for <m>u</m>.
            </p>
          </li>
        </ul>
        </p>
      </statement>
    </theorem>
    <p>
      Concavity requires comparing two increments, so we would need two projections into the future.
      Given <m>u_n</m>, we know <m>u_{n+1} = f(u_n)</m> and <m>u_{n+2} = f(u_{n+1})</m>.
      Using composition of the function with itself, we discover
      <me>u_{n+2} = f\big(f(u_n)\big)</me>.
      We can now compute the increments:
      <md>
        <mrow> \nabla_{n+1} &amp;= u_{n+1} - u_n </mrow>
        <mrow>  &amp;= f(u_n) - u_n </mrow>
        <mrow> \nabla_{n+2} &amp;= u_{n+2} - u_{n+1} </mrow>
        <mrow>  &amp;= f\big(f(u_n)\big) - f(u_n) </mrow>
      </md>
      If <m>u_n = x</m>, then the second backward difference is computed as
      <md>
        <mrow> \nabla^2 u_{n+2} &amp;= \nabla u_{n+2} - \nabla u_{n+1} </mrow>
        <mrow> &amp; = \Big( f\big(f(x)\big) - f(x) \Big) - \Big( f(x) - x \Big)</mrow>
        <mrow> &amp; = f\big(f(x)\big) - 2 f(x) + x .</mrow>
      </md>
      Sign analysis on this formula allows us to answer questions about concavity involving consecutive increments.
    </p>
    <theorem xml:id="theorem-recursive-sequence-concavity">
      <statement>
        <p>
        Suppose a sequence <m>u</m> is defined recursively with <m>f : u_{n} \mapsto u_{n+1}</m>.
        Define the second-order increment projection function <m>h(x) = f\big(f(x)\big) - 2 f(x) + x</m>.
        <ul>
          <li>
            <p>
            If <m>h(x) \gt 0</m>, then <m>u_n = x</m> implies <m>u</m> is <em>concave up</em> on <m>\{n,n+1,n+2\}</m>.
            </p>
          </li>
          <li>
            <p>
            If <m>h(x) \lt 0</m>, then <m>u_n = x</m> implies <m>u</m> is <em>concave down</em> on <m>\{n,n+1,n+2\}</m>.
            </p>
          </li>
          <li>
            <p>
            If <m>h(x) = 0</m>, then <m>u_n = x</m> implies <m>u</m> is <em>linear</em> (constant increments) on <m>\{n, n+1, n+2\}</m>.
            </p>
          </li>
        </ul>
        </p>
      </statement>
    </theorem>
    <example>
      <statement>
        <p>
          For a recursive sequence <m>u</m> defined by projection function <m>f(x) = 1.25x - 10</m>,
          describe the conditions for which the sequence is increasing, decreasing, concave up, or concave down.
        </p>
      </statement>
      <solution>
        <p>
          The increment projection is defined by <m>g(x) = f(x) - x = 0.25x - 10</m>.
          We analyze the inequalities <m>g(x) \gt 0</m> and <m>g(x) \lt 0</m>
          by solving the equation <m>g(x) = 0</m> and then doing sign analysis on resulting test intervals.
          <md>
            <mrow> 0.25x - 10 = 0 </mrow>
            <mrow> 0.25x = 10 </mrow>
            <mrow> x = 40</mrow>
          </md>
          We now know that <m>x=40</m> is an equilibrium for the sequence.
          Our test intervals are <m>x \lt 40</m> and <m>x \gt 40</m>.
          <md>
            <mrow>g(30) = 0.25(30)-10 = -2.5</mrow>
            <mrow>g(50) = 0.25(50)-10 = 2.5</mrow>
          </md>
          Consequently, the sequence will decrease for an initial value <m>u_n \lt 40</m>
          and increase for an initial value <m>u_n \gt 40</m>.
        </p>
        <p>
          Analysis of concavity is more involved, requiring the calculation of the composition <m>f\big(f(x)\big)</m>.
          We emphasize the importance of thinking of this as substitution, with <m>f(\square) = 1.25 \square - 10</m>.
          For an initial value <m>u_n = x</m>, the projection of the sequence value <m>u_{n+1}</m> is given by
          <me>u_{n+1} = f(x) = 1.25 x - 10</me>
          Projecting a second step into the future for <m>u_{n+2}</m> is given by
          <md>
            <mrow>u_{n+2} &amp;= f\big(f(x)\big) = f(1.25x-10)</mrow>
            <mrow> &amp;= 1.25(1.25x - 10) - 10 = 1.5625x - 12.5 - 10</mrow>
            <mrow> &amp; = 1.5625x - 22.5</mrow>
          </md>
          This gives the increment <m>\nabla u_{n+2} = u_{n+2} - u_{n+1}</m> as
          <md>
            <mrow> \nabla u_{n+2} &amp;= \big(1.5625x - 22.5\big) - \big(1.25x - 10\big) </mrow>
            <mrow> &amp;= 0.3125 x - 12.5.</mrow>
          </md>
          The second backward difference is therefore
          <md>
            <mrow> \nabla^2 u_{n+2} &amp;= \nabla u_{n+2} - \nabla u_{n+1} </mrow>
            <mrow> &amp;= \big(0.3125 x - 12.5\big) - \big( 0.25x -10 \big) </mrow>
            <mrow> &amp;= 0.0625x - 2.5 .</mrow>
          </md>
          Solving the equation <m>\nabla^2 u_{n+2} = 0</m> (Try it!) gives <m>x=40</m>,
          giving us the same test intervals as our sign analysis for monotonicity.
          <md>
            <mrow> x=0  \: (x \lt 40): \quad \nabla^2 u_{n+2} = 0.0625(0) - 2.5 = -2.5</mrow>
            <mrow> x=50 \: (x \gt 40): \quad \nabla^2 u_{n+2} = 0.0625(50) - 2.5 = 0.625</mrow>
          </md>
          Consequently, the sequence will be concave down for an initial value <m>u_n \lt 40</m>
          and concave up for an initial value <m>u_n \gt 40</m>.
        </p>
        <p>
          To visualize these results, consider the sequence with three different initial values.
          <md>
            <mrow> u_0 = 30: \quad &amp;u = (30, 27.5, 24.375, 20.46875, \ldots)</mrow>
            <mrow> u_0 = 40: \quad &amp;u = (40, 40, 40, 40, \ldots)</mrow>
            <mrow> u_0 = 50: \quad &amp;u = (50, 52.5, 55.625, 59.53125, \ldots)</mrow>
          </md>
          Graphs of these sequence are shown below.
          The first sequence is decreasing and concave down.
          The second sequence is constant (an equilibrium value).
          The third sequence is increasing and concave up.
        </p>
        <figure>
          <caption>The sequence <m>u</m> defined by <m>u_{n+1} = 1.25 u_n - 10</m> and selected initial values.</caption>
          <sidebyside widths="32% 32% 32%">
            <figure>
              <caption><m>u_0 = 30</m></caption>
              <image>
                <latex-image>
                <![CDATA[\tikzset{%
                /pgfplots/table/row sep=crcr
                }
                \pgfplotsset{ width=5cm }
                \begin{tikzpicture}
                \begin{axis}[
                  xlabel={$n$},
                  ylabel={$u_n$},
                  ymin=-10, ymax=90,
                ]
                \addplot[
                  only marks,
                  color=blue,
                  domain=0:6,
                  samples=21,
                ] ({x},{40-10*1.25^x});
                \end{axis}
                \end{tikzpicture}
                ]]>
                </latex-image>
              </image>
            </figure>
            <figure>
              <caption><m>u_0 = 40</m></caption>
              <image>
                <latex-image>
                <![CDATA[\tikzset{%
                /pgfplots/table/row sep=crcr
                }
                \pgfplotsset{ width=5cm }
                \begin{tikzpicture}
                \begin{axis}[
                  xlabel={$n$},
                  ylabel={$u_n$},
                  ymin=-10, ymax=90,
                ]
                \addplot[
                  only marks,
                  color=blue,
                  domain=0:6,
                  samples=21,
                ] ({x},{40});
                \end{axis}
                \end{tikzpicture}
                ]]>
                </latex-image>
              </image>
            </figure>
            <figure>
              <caption><m>u_0 = 50</m></caption>
              <image>
                <latex-image>
                <![CDATA[\tikzset{%
                /pgfplots/table/row sep=crcr
                }
                \pgfplotsset{ width=5cm }
                \begin{tikzpicture}
                \begin{axis}[
                  xlabel={$n$},
                  ylabel={$u_n$},
                  ymin=-10, ymax=90,
                ]
                \addplot[
                  only marks,
                  color=blue,
                  domain=0:6,
                  samples=21,
                ] ({x},{40+10*1.25^x});
                \end{axis}
                \end{tikzpicture}
                ]]>
                </latex-image>
              </image>
            </figure>
          </sidebyside>
        </figure>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>Summary</title>
    <p>
    <ul>
      <li>
        <p>
          Explicit formulas for the values of a sequence <m>x</m>, <m>n \mapsto x_n</m>, allow us
          to compute an explicit formula for the increments <m>n \mapsto \nabla x_n</m> using the backward difference
          <me>\nabla x_n = x_{n} - x_{n-1}</me>
          using <em>substitution</em>, or <em>composition</em>, with the expression <m>n-1</m> in place of the index variable <m>n</m>.
          An explicit formula for the second backward difference <m>n \mapsto \nabla^2 x_n</m> can be computed using substitution and the formula of the increments,
          <me>\nabla^2 x_n = \nabla x_n - \nabla x_{n-1}</me>.
        </p>
      </li>
      <li>
        <p>
          Using an explicit formula <m>n \mapsto \nabla x_n</m>, we can use inequalities to perform sign analysis of the increments <m>\nabla x_n</m>.
          Sign analysis provides intervals for the index <m>n</m> where <m>\nabla x_n \gt 0</m>, <m>\nabla x_n = 0</m>, and <m>\nabla x_n \lt 0</m>.
          We use these intervals to determine intervals for the index <m>n</m> where <m>x_n</m> is increasing, constant, or decreasing, respectively.
        </p>
      </li>
      <li>
        <p>
          Using an explicit formula <m>n \mapsto \nabla^2 x_n</m>, we can use inequalities to perform sign analysis of the increments <m>\nabla^2 x_n</m>.
          Sign analysis provides intervals for the index <m>n</m> where <m>\nabla^2 x_n \gt 0</m>, <m>\nabla^2 x_n = 0</m>, and <m>\nabla^2 x_n \lt 0</m>.
          We use these intervals to determine intervals for the index <m>n</m> where <m>x_n</m> is concave up, linear, or concave down, respectively.
        </p>
      </li>
      <li>
        <p>
          A general strategy for solving inequalities with continuous functions is to solve the corresponding equation.
          Solutions to the equation create the end-points of test intervals.
          We then choose one test point from each interval to determine the inequality
          and every other value in the interval will satisfy the same relation as the test point.
        </p>
        <p>
          In simple cases, an inequality can be solved more quickly by isolating the variable using balanced operations.
          Multiplication or division by a negative value reverses any inequalities.
          Multiplication by an expression is problematic if that expression might be negative<mdash />the inequality then reverses only for some values of the variable.
          In such cases, the general strategy is preferred.
        </p>
      </li>
      <li>
        <p>
          Using a recursive formula defined by a projection function <m>f: x_{n} \mapsto x_{n+1}</m>,
          we can create an increment projection function <m>g : x_{n} \mapsto \nabla x_{n+1}</m>,
          defined by
          <me>g(x) = f(x) - x</me>.
          Sign analysis on <m>g(x)</m> determines intervals for <em>initial values</em>
          at which a sequence would increase or decrease to the <em>next</em> value.
          Any values where <m>g(x) = 0</m> are called <term>fixed points</term> of the projection function <m>f</m>
          and correspond to <term>equilibrium values</term> of the recursive sequence.
        </p>
        <p>
          It is also possible to create a second-order increment projection function
          <m>h : x_{n} \mapsto \nabla^2 x_{n+2}</m> defined by
          <me>h(x) = f\big(f(x)\big) - 2 f(x) + x</me>.
          Sign analysis of <m>h(x)</m> determines initial values where the first two <em>increments</em>
          are increasing, constant, or decreasing.
        </p>
      </li>
    </ul>
    </p>
  </subsection>
  <exercises>
    <exercisegroup>
      <introduction>
        <p>
        Practice using composition (i.e., substitution) to find explicit formulas.
        Simplify to a form that is a sum of terms.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p>If <m>a_n = 3n - 5</m>, find <m>a_{n-1}</m> and <m>a_{n+1}</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>If <m>b_k = k^2-20k</m>, find <m>b_{k-1}</m> and <m>b_{k+1}</m>.</p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>If <m>c_n = 2n^2 - 15n + 3</m>, find <m>c_{n-1}</m> and <m>c_{n+1}</m>.</p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
          For the each sequence, compute the explicit formula for the backward difference,
          perform sign analysis, and interpret the monotonicity of the sequence.
          Identify any local extreme values.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p><m>x = (25-4k)_{k=0}^{\infty}</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>z = (j^2-40j+10)_{k=0}^{\infty}</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>u = (40n - 3n^2)_{n=-5}^{\infty}</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>w = (k^3 - 500k)_{k=-\infty}^{\infty}</m></p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
          For the each sequence, compute the explicit formula for the second backward difference,
          perform sign analysis, and interpret the concavity of the sequence.
          (These are the same sequences as in the previous exercise group.)
        </p>
      </introduction>
      <exercise>
        <statement>
          <p><m>x = (25-4k)_{k=0}^{\infty}</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>z = (j^2-40j+10)_{k=0}^{\infty}</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>u = (40n - 3n^2)_{n=-5}^{\infty}</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>w = (k^3 - 500k)_{k=-\infty}^{\infty}</m></p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>
          For each recursively defined sequence,
          identify initial values that will result in an increase or a decrease or are equilibrium values.
        </p>
      </introduction>
      <exercise>
        <statement>
          <p><m>u_{n+1} = 50 - 3 u_n</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>v_{k+1} = 1.1 v_k - 30</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>w_{n+1} = 1.2 w_n - 0.04 w_{n}^2</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>z_{n+1} = 4z_n e^{-0.2 z_n}</m></p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p><m>P_{n+1} = \frac{50 P_n}{P_n + 20}</m>, restricted to <m>P \ge 0</m>.</p>
        </statement>
      </exercise>
    </exercisegroup>
    <exercisegroup>
      <introduction>
        <p>Applications.</p>
      </introduction>
      <exercise>
        <statement>
          <p>
            You are about to receive some money (inheritance, lottery, etc.) and plan to invest it in an account that earns 5% annually, compounded quarterly.
            Your plan is to withdraw $9000 each quarter ($3000 per month).
            You want to analyze what will happen to your investment.
            <ul>
              <li>
                <p>
                  Create a recursive definition for a sequence that represents the quarterly balance of your investment.
                </p>
              </li>
              <li>
                <p>
                  Analyze the monotonicity and concavity of your sequence.
                  <ul>
                    <li>What size of an investment would result in an equilibrium?</li>
                    <li>What will happen to the investment if you receive less than the equilibrium amount?</li>
                    <li>What will happen to the investment if you receive more than the equilibrium amount?</li>
                  </ul>
                </p>
              </li>
            </ul>
          </p>
        </statement>
      </exercise>
      <exercise>
        <statement>
          <p>
            A population of at risk birds has a constant per capita yearly death rate of 1 death per four individuals, <m>d=0.25</m>.
            The per capita yearly birth rate is observed to be a decreasing function of the population size <m>P</m>,
            modeled by a linear function <m>b = 0.5 - 0.0002P</m>.
            <ul>
              <li>
                <p>
                  Create a recursive definition for a sequence that represents the annual population size.
                </p>
              </li>
              <li>
                <p>
                  Analyze the monotonicity of your sequence.
                  <ul>
                    <li>What is the equilibrium population size?</li>
                    <li>What will happen to the population if it begins below equilibrium?</li>
                    <li>What will happen to the population if it begins above equilibrium?</li>
                  </ul>
                </p>
              </li>
              <li>
                <p>
                  Create a cobweb diagram for the sequence.
                  How does the cobweb diagram relate to your analysis of monotonicity?
                  How does the cobweb diagram relate to concavity
                </p>
              </li>
            </ul>
          </p>
          <p>
            Suppose that the tail feathers of these birds are valuable
            so that poachers come and kill an additional 100 birds per year.
            <ul>
              <li>
                <p>
                  Create a recursive definition for a new sequence that models the natural births and deaths as well as the illegal harvesting by poachers.
                </p>
              </li>
              <li>
                <p>
                  Analyze the monotonicity of the modified sequence.
                  What does the model predict for the consequence of poaching?
                </p>
              </li>
            </ul>
          </p>
        </statement>
      </exercise>
    </exercisegroup>
  </exercises>
 </section>
