<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2015-2018  D. Brian Walton          -->
<!-- See the file COPYING for copying conditions. -->

<section xml:id="antiderivatives">
  <title>Antiderivatives</title>
  <introduction>
    <p>
      We have previously studied the differentiation operator.
      Given a function relationship between two variables <m>x \overset{f}{\mapsto} Q</m>,
      the derivative <m>f'</m> is the function relating <m>x</m> to the rate of change <m>\frac{dQ}{dx}</m>.
      Differentiation is the operation that goes maps <m>f \overset{\frac{d}{dx}}\mapsto f'</m>.
      Because <m>f'</m> is itself a function,
      we can apply differentiation again <m>f' \overset{\frac{d}{dx}}\mapsto f''</m>.
      This process can repeat indefinitely.
    </p>
    <p>
      Consider <m>f(x) = x^4+2x^2-3x</m>.
      There is a sequence of functions corresponding to the derivatives:
      <md>
        <mrow> f(x) &amp;= x^4+2x^2-3x, </mrow>
        <mrow> f'(x) &amp;= 4x^3+4x-3, </mrow>
        <mrow> f''(x) &amp;= 12x^2+4, </mrow>
        <mrow> f^{(3)}(x) &amp;= 24x, </mrow>
        <mrow> f^{(4)}(x) &amp;= 24, </mrow>
        <mrow> f^{(5)}(x) &amp;= 0, </mrow>
        <mrow> f^{(6)}(x) &amp;= 0. </mrow>
      </md>
      This pattern continues with <m>f^{(n)}(x) = 0</m> for <m>n=5,6,7,\ldots</m>.
    </p>
    <p>
      As the example above illustrates, given a function we can find its derivative.
      One of the major themes of mathematics is the idea of inverse operations.
      Is there an inverse operation to differentiation?
      That is, given <m>f(x)</m>, instead of computing <m>f'(x)</m>,
      can we find a function <m>F(x)</m> so that <m>F(x) \overset{\frac{d}{dx}}\mapsto f(x)</m>?
      This inverse operation, using <m>f(x)</m> to find <m>F(x)</m>, is called <term>antidifferentiation</term>.
    </p>
    <p>
      In this section, we define antiderivatives.
      We discuss why a function has infinitely many different antiderivatives.
      Based on the First Part of the Fundamental Theorem of Calculus,
      we recognize that accumulation functions are special examples of antiderivatives
      for continuous rates of accumulation.
      Motivated by this observation, we introduce the indefinite integral
      as the notation for antidifferentiation.
      Examples will illustrate how we use our known differentiation rules
      to develop corresponding antidifferentiation rules.
    </p>
  </introduction>
  <subsection>
    <title>Terminology</title>
    <definition xml:id='defn-antiderivative'>
      <title>Antiderivatives</title>
      <statement>
        <p>
          Given a function <m>f(x)</m>,
          we say that <m>F(x)</m> is an <term>antiderivative</term> of <m>f(x)</m>
          if <m>f(x)</m> is the derivative of <m>F(x)</m>.
          That is, <m>F'(x)=f(x)</m>.
        </p>
      </statement>
    </definition>
    <p>
      Differentiation is not one-to-one.
      The derivative of any constant is zero,
      so adding a constant to a function creates a new function
      that has the same derivative as the original.
    </p>
    <example>
      <statement>
        <p>
          Compare the following derivatives:
          <md>
            <mrow>\frac{d}{dx}[x^2+3x] &amp;= 2x+3,</mrow>
            <mrow>\frac{d}{dx}[x^2+3x-1] &amp;= 2x+3,</mrow>
            <mrow>\frac{d}{dx}[x^2+3x+4] &amp;= 2x+3.</mrow>
          </md>
          Each of the functions have the same derivative.
          We say that <m>x^2+3x</m>, <m>x^2+3x-1</m>, and <m>x^2+3x+4</m>
          are all antiderivatives of <m>2x+3</m>.
          More generally, we know <m>x^2+3x+C</m> will be an antiderivative
          for <em>any</em> constant value <m>C</m>.
        </p>
      </statement>
    </example>
    <p>
      If we know that a function <m>F(x)</m> is an antiderivative of <m>f(x)</m>,
      then we know that all functions of the form <m>F(x)+C</m>,
      where <m>C</m> is a constant, are also antiderivatives.
      This shows that infinitely many different functions have the same derivative.
      We call all such functions <term>antiderivatives</term>.
    </p>
    <p>
      We will later prove the following theorem.
      It states that the <em>only</em> way that two antiderivatives
      can be different is that they differ by a constant.
      The proof of the theorem will require a Mean Value Theorem for derivatives.
    </p>
    <theorem xml:id='thm-antiderivative-up-to-constant'>
      <statement>
        <p>
          Suppose that <m>F(x)</m> and <m>G(x)</m> are both antiderivatives of <m>f(x)</m>
          on an interval <m>I</m>.
          That is, for all <m>x \in I</m> we have <me>F'(x)=G'(x)=f(x).</me>
          Then there is a constant <m>C</m> so that for all <m>x \in I</m>,
          <m>G(x) = F(x)+C</m>.
        </p>
      </statement>
    </theorem>
    <p>
      Consequently, knowing just one antiderivative allows us
      to determine all possible antiderivatives by adding some constant.
      Suppose <m>F(x)</m> is an antiderivative of <m>f(x)</m>.
      Then any other antiderivative must be <m>F(x)+C</m> for some constant <m>C</m>.
      If we leave the constant as an unspecified parameter,
      we call this the <term>general antiderivative</term>.
      Graphically, different antiderivatives correspond to a vertical translation of the graph.
      That is, all antiderivatives have the same graph shifted up or down relative to one another.
    </p>
    <p>
      In the case that <m>f(x)</m> is continuous on some interval <m>I</m>,
      we can define an accumulation function starting at any convenient point <m>a \in I</m>,
      <me>A(x) = \int_a^x f(z) \, dz.</me>
      By the <xref ref='theorem-ftc-part-one' text='title'>First Part of the Fundamental Theorem of Calculus</xref>,
      we know that <m>A'(x) = f(x)</m>.
      That is, <m>A(x)</m> is itself an antiderivative of <m>f(x)</m>.
      Consequently, there is a close connection between antiderivatives and integrals.
      This motivates the standard notation for finding antiderivatives,
      called an indefinite integral.
    </p>
    <definition xml:id='defn-indefinite-integral'>
      <title>Indefinite Integrals</title>
      <statement>
        <p>
          Given a function <m>f(x)</m>,
          the <term>indefinite integral</term> of <m>f(x)</m> with respect to <m>x</m>,
          written <m>\displaystyle \int f(x) \, dx</m>,
          is the general antiderivative of <m>f(x)</m>.
          That is, if <m>F(x)</m> is any antiderivative such that <m>F'(x)=f(x)</m>,
          then <me> \int f(x)\, dx = F(x) + C.</me><notation><usage>\int f(x)\, dx</usage><description>indefinite integral or family of antiderivatives</description></notation>
        </p>
      </statement>
    </definition>
    <p>
      Using our earlier example, we can write the indefinite integral of <m>2x+3</m> as
      <me>\int 2x+3 \, dx = x^2 + 3x + C.</me>
      Notice that in contrast to accumulation functions defined by definite integrals
      involving a different variable of integration,
      the notation for an indefinite integral uses the same variable of integration
      as the independent variable of the antiderivative.
    </p>
  </subsection>
  <subsection>
    <title>Examples</title>
    <p>
      For the most part, finding antiderivatives corresponds to recognizing
      how a function might have been computed as a derivative.
      Every statement about differentiation has an equivalent statement about integrals.
      Once we believe we know the antiderivative,
      we verify that it is correct by checking its derivative.
    </p>
    <example>
      <statement>
        <p>
          Find <m>\displaystyle \frac{d}{dx}\Big[ (3x+5)^4 \Big]</m>
          and then write down the equivalent statement as an integral.
        </p>
      </statement>
      <solution>
        <p>
          The last operation in the expression <m>(3x+5)^4</m> is the power
          acting on the expression <m>u=3x+5</m>.
          The derivative requires a chain rule:
          <md>
            <mrow>\frac{d}{dx}\Big[(3x+5)^4\Big] &amp;= 4u^3 \frac{du}{dx} </mrow>
            <mrow>&amp;= 4(3x+5)^3(3)</mrow>
            <mrow>&amp;=12 (3x+5)^3.</mrow>
          </md>
          Once we know the derivative, we can write the equivalent integral
          <me> \int 12 (3x+5)^3 \, dx = (3x+5)^4 + C.</me>
          This says that <m>(3x+5)^4</m> is an antiderivative of <m>12(3x+5)^3</m>,
          along with that same formula plus any constant.
      </solution>
    </example>
    <p>
      We must learn to recognize which differentiation rules might have been used
      to result in the formula of a given function.
      When <m>f(x)</m> is written as a sum,
      we typically first try to find antiderivatives of each term.
      This follows from the sum rule of differentiation.
    </p>
    <example>
      <statement>
        <p>Find <m>\displaystyle \int 4x^3 - 2e^{2x} \, dx</m>.</p>
      </statement>
      <solution>
        <p>
          We are looking for a function <m>F(x)</m> for which <m>F'(x)=4x^3 - 2e^{2x}</m>.
          From experience computing derivatives, we know
          <md>
            <mrow> \frac{d}{dx}[x^4] = 4x^3, </mrow>
            <mrow> \frac{d}{dx}[e^{2x}] = 2e^{2x}. </mrow>
          </md>
          We expect <m>F(x) = x^4-e^{2x}</m>.
          We verify by differentiation:
          <me> F'(x) = \frac{d}{dx}[x^4-e^{2x}] = 4x^3 - 2e^{2x}.</me>
          This verifies that <m>F(x)</m> is an antiderivative of <m>4x^3-2e^{2x}</m>.
          The general antiderivative is written as the indefinite integral,
          <me> \int 4x^3-2e^{2x}\,dx = x^4 - e^{2x} + C.</me>
        </p>
      </solution>
    </example>
    <p>
      We have also learned that most derivative rules do not result in a product as the answer.
      An exception would be if the chain rule is involved.
      If we see formulas multiplied together,
      we should consider whether we would benefit from expanding the product as a sum.
    </p>
    <example>
      <statement>
        <p>Find <m>\displaystyle \int x^2(x^2-3) \, dx</m>.</p>
      </statement>
      <solution>
        <p>
          The function <m>f(x) = x^2(x^2-3)</m> is a product
          that can be expanded to a sum using the distributive property.
          <me>f(x) = x^4 - 3x^2.</me>
          Our experience with the power rule suggests an antiderivative
          <me>F(x) = \frac{1}{5}x^5 - x^3.</me>
          We verify using regular differentiation rules:
          <md>
            <mrow> F'(x) &amp;= \frac{d}{dx}[\frac{1}{5}x^5 - x^3]</mrow>
            <mrow> &amp;= \frac{1}{5}(5x^4) - 3x^2 </mrow>
            <mrow> &amp;= x^4 - 3x^2 = f(x). </mrow>
          </md>
          Having verified our antiderivative is correct,
          we can write down the general antiderivative
          <me> \int x^2 (x^2-3) \, dx = \frac{1}{5}x^5 - x^3 + C. </me>
        </p>
      </solution>
    </example>
  </subsection>
</section>
