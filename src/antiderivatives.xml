<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                -->
<!--                                              -->
<!--      A Modeling Approach to Calculus         -->
<!--                                              -->
<!-- Copyright (C) 2015-2018  D. Brian Walton          -->
<!-- See the file COPYING for copying conditions. -->

<section xml:id="antiderivatives">
  <title>Antiderivatives</title>
  <introduction>
    <p>
      We have previously studied the differentiation operator.
      Given a function relationship between two variables <m>x \overset{f}{\mapsto} Q</m>,
      the derivative <m>f'</m> is the function relating <m>x</m> to the rate of change <m>\frac{dQ}{dx}</m>.
      Differentiation is the operation that goes maps <m>f \overset{\frac{d}{dx}}\mapsto f'</m>.
      Because <m>f'</m> is itself a function,
      we can apply differentiation again <m>f' \overset{\frac{d}{dx}}\mapsto f''</m>.
      This process can repeat indefinitely.
    </p>
    <p>
      Consider as an example <m>f(x) = x^4+2x^2-3x</m>.
      There is a sequence of functions corresponding to the derivatives:
      <md>
        <mrow> f(x) &amp;= x^4+2x^2-3x, </mrow>
        <mrow> f'(x) &amp;= 4x^3+4x-3, </mrow>
        <mrow> f''(x) &amp;= 12x^2+4, </mrow>
        <mrow> f^{(3)}(x) &amp;= 24x, </mrow>
        <mrow> f^{(4)}(x) &amp;= 24, </mrow>
        <mrow> f^{(5)}(x) &amp;= 0, </mrow>
        <mrow> f^{(6)}(x) &amp;= 0. </mrow>
      </md>
      This pattern continues with <m>f^{(n)}(x) = 0</m> for <m>n=5,6,7,\ldots</m>.
    </p>
    <p>
      As the example above illustrates, given a function we can find its derivative.
      One of the major themes of mathematics is the idea of inverse operations.
      Is there an inverse operation to differentiation?
      That is, given <m>f(x)</m>, instead of computing <m>f'(x)</m>,
      can we find a function <m>F(x)</m> so that <m>F(x) \overset{\frac{d}{dx}}\mapsto f(x)</m>?
      This inverse operation, using <m>f(x)</m> to find <m>F(x)</m>, is called <term>antidifferentiation</term>.
    </p>
    <p>
      In this section, we define antiderivatives.
      We discuss why a function has infinitely many different antiderivatives.
      Based on the First Part of the Fundamental Theorem of Calculus,
      we recognize that accumulation functions are special examples of antiderivatives
      for continuous rates of accumulation.
      Motivated by this observation, we introduce the indefinite integral
      as the notation for antidifferentiation.
      Examples will illustrate how we use our known differentiation rules
      to develop corresponding antidifferentiation rules.
    </p>
  </introduction>
  <subsection>
    <title>Terminology</title>
    <definition xml:id='defn-antiderivative'>
      <title>Antiderivatives</title>
      <statement>
        <p>
          Given a function <m>f(x)</m>,
          we say that <m>F(x)</m> is an <term>antiderivative</term> of <m>f(x)</m>
          if <m>f(x)</m> is the derivative of <m>F(x)</m>.
          That is, <m>F'(x)=f(x)</m>.
        </p>
      </statement>
    </definition>
    <p>
      The derivative of any constant is zero,
      so adding a constant to a function creates a new function
      that has the same derivative as the original.
      This means that differentiation is not one-to-one.
    </p>
    <example>
      <statement>
        <p>
          Compare the following derivatives:
          <md>
            <mrow>\frac{d}{dx}[x^2+3x] &amp;= 2x+3,</mrow>
            <mrow>\frac{d}{dx}[x^2+3x-1] &amp;= 2x+3,</mrow>
            <mrow>\frac{d}{dx}[x^2+3x+4] &amp;= 2x+3.</mrow>
          </md>
          Each of the functions have the same derivative.
          We say that <m>x^2+3x</m>, <m>x^2+3x-1</m>, and <m>x^2+3x+4</m>
          are all antiderivatives of <m>2x+3</m>.
          More generally, we know <m>x^2+3x+C</m> will be an antiderivative
          for <em>any</em> constant value <m>C</m>.
        </p>
      </statement>
    </example>
    <p>
      If we know that a function <m>F(x)</m> is an antiderivative of <m>f(x)</m>,
      then we know that all functions of the form <m>F(x)+C</m>,
      where <m>C</m> is a constant, are also antiderivatives.
      This shows that infinitely many different functions have the same derivative.
      We call all such functions <term>antiderivatives</term>.
    </p>
    <p>
      We will later prove the following theorem.
      It states that the <em>only</em> way that two antiderivatives
      can be different is that they differ by a constant.
      The proof of the theorem will use a Mean Value Theorem for derivatives.
    </p>
    <theorem xml:id='thm-antiderivative-up-to-constant'>
      <statement>
        <p>
          Suppose that <m>F(x)</m> and <m>G(x)</m> are both antiderivatives of <m>f(x)</m>
          on an interval <m>I</m>.
          That is, for all <m>x \in I</m> we have <me>F'(x)=G'(x)=f(x).</me>
          Then there is a constant <m>C</m> so that for all <m>x \in I</m>,
          <m>G(x) = F(x)+C</m>.
        </p>
      </statement>
    </theorem>
    <p>
      Consequently, knowing just one antiderivative allows us
      to determine all possible antiderivatives by adding some constant.
      Suppose <m>F(x)</m> is an antiderivative of <m>f(x)</m>.
      Then any other antiderivative must be <m>F(x)+C</m> for some constant <m>C</m>.
      If we leave the constant as an unspecified parameter,
      we call this the <term>general antiderivative</term>.
      Graphically, different antiderivatives correspond to a vertical translation of the graph.
      That is, all antiderivatives have the same graph shifted up or down relative to one another.
    </p>
    <p>
      In the case that <m>f(x)</m> is continuous on some interval <m>I</m>,
      we can define an accumulation function starting at any convenient point <m>a \in I</m>,
      <me>A(x) = \int_a^x f(z) \, dz.</me>
      By the <xref ref='theorem-ftc-part-one' text='title'>Part One of the Fundamental Theorem of Calculus</xref>,
      we know that <m>A'(x) = f(x)</m>.
      That is, <m>A(x)</m> is itself an antiderivative of <m>f(x)</m>
      and any other antiderivative could be written <m>F(x) = \int_a^x f(z) \, dz + C</m>.
    </p>
    <p>
      Owing to this close connection between antiderivatives and integrals,
      the standard notation for finding antiderivatives is with the integral symbol using an indefinite integral.
      An indefinite integral will not have any limits of integration,
      uses the same variable of integration as the independent variable,
      and refers to antiderivatives rather than definite integrals.
    </p>
    <definition xml:id='defn-indefinite-integral'>
      <title>Indefinite Integrals</title>
      <statement>
        <p>
          Given a function <m>f(x)</m>,
          the <term>indefinite integral</term> of <m>f(x)</m> with respect to <m>x</m>,
          written <m>\displaystyle \int f(x) \, dx</m>,
          is the general antiderivative of <m>f(x)</m>.
          That is, if <m>F(x)</m> is any antiderivative such that <m>F'(x)=f(x)</m>,
          then <me> \int f(x)\, dx = F(x) + C.</me><notation><usage>\int f(x)\, dx</usage><description>indefinite integral or family of antiderivatives</description></notation>
        </p>
      </statement>
    </definition>
    <p>
      Using our earlier example, we can write the indefinite integral of <m>2x+3</m> as
      <me>\int 2x+3 \, dx = x^2 + 3x + C.</me>
      The indefinite integral represents the infinite family of all antiderivatives of <m>2x+3</m>.
    </p>
  </subsection>
  <subsection>
    <title>Examples</title>
    <p>
      For the most part, finding antiderivatives corresponds to recognizing
      how a function might have been computed as a derivative.
      Every statement about differentiation has an equivalent statement about integrals.
      To check whether a proposed function is an antiderivative,
      we calculate its derivative and compare that with the function inside the integral.
    </p>
    <example>
      <statement>
        <p>
          Find <m>\displaystyle \frac{d}{dx}\Big[ (3x+5)^4 \Big]</m>
          and then write down the equivalent statement as an integral.
        </p>
      </statement>
      <solution>
        <p>
          The last operation in the expression <m>(3x+5)^4</m> is the power
          acting on the expression <m>u=3x+5</m>.
          The derivative requires a chain rule:
          <md>
            <mrow>\frac{d}{dx}\Big[(3x+5)^4\Big] &amp;= 4u^3 \frac{du}{dx} </mrow>
            <mrow>&amp;= 4(3x+5)^3(3)</mrow>
            <mrow>&amp;=12 (3x+5)^3.</mrow>
          </md>
          Once we know the derivative, we can write the equivalent integral
          <me> \int 12 (3x+5)^3 \, dx = (3x+5)^4 + C.</me>
          This says that <m>(3x+5)^4</m> is an antiderivative of <m>12(3x+5)^3</m>,
          along with that same formula plus any constant.
        </p>
      </solution>
    </example>
    <p>
      We must learn to recognize which differentiation rules would result
      in a particular formula for a given function.
      Because differentiation is a linear operator, antidifferentiation is as well.
    </p>
    <theorem xml:id="thm-antiderivative-linearity">
      <statement>
        <p>
          If <m>F(x)</m> is an antiderivative of <m>f(x)</m> and <m>G(x)</m> is an antiderivative of <m>g(x)</m>,
          then for any constants <m>c_1</m> and <m>c_2</m>,
          <m>c_1 F(x) + c_2 G(x)</m> is an antiderivative of <m>c_1 f(x) + c_2 g(x)</m>.
          We write
          <me>\int [c_1 f(x) + c_2 g(x)] dx = c_1 \int f(x) \, dx + c_2 \int g(x) \, dx.</me>
        </p>
      </statement>
    </theorem>
    <p>
      If the integrand <m>f(x)</m> is expressed as a sum of terms,
      we typically first try to find antiderivatives of each term.
    </p>
    <example>
      <statement>
        <p>Find <m>\displaystyle \int 4x^3 - 2e^{2x} \, dx</m>.</p>
      </statement>
      <solution>
        <p>
          We are looking for a function <m>F(x)</m> for which <m>F'(x)=4x^3 - 2e^{2x}</m>.
          From experience computing derivatives, we know
          <md>
            <mrow> \frac{d}{dx}[x^4] = 4x^3, </mrow>
            <mrow> \frac{d}{dx}[e^{2x}] = 2e^{2x}. </mrow>
          </md>
          This suggests we should use the difference <m>F(x) = x^4-e^{2x}</m>.
          We verify by differentiation:
          <me> F'(x) = \frac{d}{dx}[x^4-e^{2x}] = 4x^3 - 2e^{2x}.</me>
          This verifies that <m>F(x)</m> is an antiderivative of <m>4x^3-2e^{2x}</m>.
          The general antiderivative is written as the indefinite integral,
          <me> \int 4x^3-2e^{2x}\,dx = x^4 - e^{2x} + C.</me>
        </p>
      </solution>
    </example>
    <p>
      Most derivative rules do not result in a product of expressions.
      The <xref ref="deriv-product" text="title">product rule for derivatives</xref> results in the sum of two products.
      The <xref ref="deriv-quotient" text="title">quotient rule</xref> results in in difference of quotients.
      Only the chain rule creates a derivative by multiplying two expresions together.
      Consequently, if we see an integrand with expressions multiplied together,
      we should consider whether we would benefit from expanding the product as a sum.
    </p>
    <example>
      <statement>
        <p>Find <m>\displaystyle \int x^2(x^2-3) \, dx</m>.</p>
      </statement>
      <solution>
        <p>
          The function <m>f(x) = x^2(x^2-3)</m> is a product
          that can be expanded to a sum using the distributive property.
          <me>f(x) = x^4 - 3x^2.</me>
          Our experience with the <xref ref="deriv-power-rule" text="title">power rule</xref>
          suggests that we should be able to integrate this expression.
          We know <me> \frac{d}{dx}[x^5] = 5x^4.</me>
          To eliminate the unwanted constant multiple of 5, we can multiply both sides by <m>\frac{1}{5}</m> to get
          <me>\frac{d}{dx}\Big[ \frac{1}{5}x^5 \Big] = x^4.</me>
          This suggests an antiderivative
          <me>F(x) = \frac{1}{5}x^5 - x^3.</me>
          We verify using regular differentiation rules:
          <md>
            <mrow> F'(x) &amp;= \frac{d}{dx}[\frac{1}{5}x^5 - x^3]</mrow>
            <mrow> &amp;= \frac{1}{5}(5x^4) - 3x^2 </mrow>
            <mrow> &amp;= x^4 - 3x^2 = f(x). </mrow>
          </md>
          We have found
          <me> \int x^2 (x^2-3) \, dx = \frac{1}{5}x^5 - x^3 + C. </me>
        </p>
      </solution>
    </example>
    <p>
      Just as it is useful to collect and learn the basic building blocks for differentiation,
      we can collect and learn basic building blocks for integration.
      Each derivative rule has its equivalent statement about antiderivatives.
      If we incorporate the chain rule, we extend each of the elementary rules to generalized rules.
    </p>
    <assemblage xml:id="assemblage-elementary-integrals">
      <statement>
        <p>
          <ol>
            <li>
              <p>
                Power Rule: For any power <m>n \ne -1</m>,
                <me>\int x^n \, dx = \frac{1}{n+1} x^{n+1} + C.</me>
              </p>
            </li>
            <li>
              <p>
                Generalized Power Rule: For any power <m>n \ne -1</m> and expression <m>u</m>,
                <me>\int u^n \cdot \frac{du}{dx} \, dx = \frac{1}{n+1} u^{n+1} + C.</me>
              </p>
            </li>
            <li>
              <p>
                Logarithm Rule:
                <me>\int \frac{1}{x} \, dx = \ln(|x|) + C.</me>
              </p>
            </li>
            <li>
              <p>
                Generalized Logarithm Rule: For any expression <m>u</m>,
                <me>\int \frac{u'}{u} \, dx = \ln(|u|) + C.</me>
              </p>
            </li>
            <li>
              <p>
                Elementary Exponential Rule: For any real value <m>k \ne 0</m>,
                <me>\int e^{kx} \, dx = \frac{1}{k} e^{kx} + C.</me>
              </p>
            </li>
            <li>
              <p>
                Generalized Exponential Rule: For any expression <m>u</m>,
                <me>\int e^{u} \cdot \frac{du}{dx} \, dx = e^{u} + C.</me>
              </p>
            </li>
          </ol>
        </p>
      </statement>
    </assemblage>
    <example>
      <statement>
        <p><m>\displaystyle \int x^2 e^{x^3} \, dx</m></p>
      </statement>
      <solution>
        <p>
          Because the integrand has a product of expressions,
          we should begin by looking to see if the problem involves the chain rule.
          The exponential term <m>e^{x^3}</m> involves the expression <m>u=x^3</m>
          which has a derivative <m>u'=3x^2</m>.
          Notice that the other factor in the problem, <m>x^2</m>, differs from <m>u'</m> only by a constant multiple.
          That is, we can recognize our problem as a generalized exponential
          <md>
            <mrow> \int x^2 e^{x^3} \, dx &amp;= \int \frac{1}{3}(3x^2) e^{x^3} \, dx </mrow>
            <mrow> &amp;\underset{u=x^3}= \int \frac{1}{3} e^{u} \cdot \frac{du}{dx} \, dx</mrow>
            <mrow> &amp;\underset{u=x^3}= \frac{1}{3} e^{u} + C</mrow>
            <mrow> &amp;= \frac{1}{3} e^{x^3} + C.</mrow>
          </md>
        </p>
      </solution>
    </example>
  </subsection>
  <subsection>
    <title>Summary</title>
  </subsection>
  <exercises>
  </exercises>
</section>
